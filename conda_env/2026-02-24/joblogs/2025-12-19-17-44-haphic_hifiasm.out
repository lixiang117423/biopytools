[2025-12-19 17:44:08] ğŸ§¬ HapHiCå¤„ç†å™¨å·²åˆå§‹åŒ– | HapHiC processor initialized
[2025-12-19 17:44:08] âš™ï¸ é…ç½®å‚æ•° | Configuration Parameters:
[2025-12-19 17:44:08]   assembly_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/24.hifi_genome/hifiasm/OV53_1.primary.fasta
[2025-12-19 17:44:08]   hic_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/01.data/hic/OV53_1-hic_R1.fastq.gz
[2025-12-19 17:44:08]   hic_file_type: fastq
[2025-12-19 17:44:08]   nchrs: 12
[2025-12-19 17:44:08]   output_dir: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½
[2025-12-19 17:44:08]   prefix: OV53_1.primary
[2025-12-19 17:44:08]   threads: 64
[2025-12-19 17:44:08]   processes: 64
[2025-12-19 17:44:08]   quick_view: False
[2025-12-19 17:44:08]   restriction_sites: ['GATC']
[2025-12-19 17:44:08]   correct_nrounds: 2
[2025-12-19 17:44:08]   remove_allelic_links: None
[2025-12-19 17:44:08]   phasing_weight: 1.0
[2025-12-19 17:44:08]   gfa_files: None
[2025-12-19 17:44:08]   haphic_bin: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic
[2025-12-19 17:44:08]   bwa_bin: bwa
[2025-12-19 17:44:08]   samtools_bin: samtools
[2025-12-19 17:44:08] ğŸš€ å¼€å§‹HapHiCæµç¨‹ | Starting HapHiC pipeline
[2025-12-19 17:44:08] ğŸ” ç³»ç»Ÿé¢„æ£€æŸ¥ | System pre-flight checks
[2025-12-19 17:44:08] ğŸ” éªŒè¯è¾“å…¥æ–‡ä»¶ | Validating input files
[2025-12-19 17:44:11] ğŸ“Š åŸºå› ç»„åºåˆ—æ•°é‡ | Assembly sequence count: 1455
[2025-12-19 17:44:11] ğŸ“Š FASTQæ–‡ä»¶å¤§å° | FASTQ file sizes: R1 60.14 GB, R2 60.14 GB
[2025-12-19 17:44:11] âœ… è¾“å…¥æ–‡ä»¶éªŒè¯é€šè¿‡ | Input files validated
[2025-12-19 17:44:11] ğŸ–¥ï¸ æ£€æŸ¥ç³»ç»Ÿèµ„æº | Checking system resources
[2025-12-19 17:44:11] ğŸ’¾ å¯ç”¨å†…å­˜ | Available memory: 7.1 GB
[2025-12-19 17:44:11] ğŸ’¾ å¯ç”¨ç£ç›˜ç©ºé—´ | Available disk space: 2554925.1 GB
[2025-12-19 17:44:11] ğŸ–¥ï¸ CPUæ ¸å¿ƒæ•° | CPU cores: 88
[2025-12-19 17:44:11] âœ… é¢„æ£€æŸ¥é€šè¿‡ | Pre-flight checks passed
[2025-12-19 17:44:11] ğŸ” æ£€æŸ¥å·²å­˜åœ¨çš„æ¯”å¯¹ç»“æœ | Checking for existing alignment results
[2025-12-19 17:44:11] ğŸ“‚ è¾“å‡ºç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½
[2025-12-19 17:44:11] ğŸ“‚ æ¯”å¯¹ç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½/00.mapping
[2025-12-19 17:44:11] ğŸ“„ æ½œåœ¨BAMæ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½/00.mapping/HiC.bam
[2025-12-19 17:44:11] ğŸ“„ æ½œåœ¨è¿‡æ»¤BAMæ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½/00.mapping/HiC.filtered.bam
[2025-12-19 17:44:11] âœ… æ¯”å¯¹ç›®å½•å­˜åœ¨ | Alignment directory exists
[2025-12-19 17:44:11] ğŸ“‹ æ¯”å¯¹ç›®å½•å†…å®¹: ['assembly.fa.amb', 'assembly.fa.bwt', 'assembly.fa.ann', 'assembly.fa', 'assembly.fa.pac', 'read1_1.fastq.gz', 'HiC.bam.bak', 'HiC.bam', 'assembly.fa.sa', 'read2_1.fastq.gz']
[2025-12-19 17:44:11] âœ… å‘ç°å·²å­˜åœ¨çš„BAMæ–‡ä»¶ï¼Œè·³è¿‡BWAæ¯”å¯¹æ­¥éª¤ | Found existing BAM file, skipping BWA alignment: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½/00.mapping/HiC.bam (93,572,708,225 bytes)
[2025-12-19 17:44:11] âœ… ä½¿ç”¨æŒ‰read nameæ’åºçš„BAMæ–‡ä»¶ä»¥æ»¡è¶³HapHiCè¦æ±‚ | Using read name-sorted BAM file to meet HapHiC requirements
[2025-12-19 17:44:11] ğŸš€ å¼€å§‹HapHiC Pipelineæµç¨‹ | Starting HapHiC Pipeline
[2025-12-19 17:44:11] ğŸ“ è®¾ç½®ç›®å½•ç»“æ„ | Setting up directory structure
[2025-12-19 17:44:11] âœ… ç›®å½•ç»“æ„è®¾ç½®å®Œæˆ | Directory structure setup complete
[2025-12-19 17:44:11] ğŸ”„ è¿è¡ŒHapHiC Pipeline | Running HapHiC Pipeline
[2025-12-19 17:44:11] ğŸ“‚ å·¥ä½œç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½
[2025-12-19 17:44:11] ğŸš€ HapHiC Pipeline
[2025-12-19 18:12:10] âŒ å‘½ä»¤æ‰§è¡Œå¤±è´¥ | Command failed (è¿”å›ç : 1)
[2025-12-19 18:12:10] å‘½ä»¤è¾“å‡º | Command Output:
2025-12-19 17:44:35 <HapHiC_pipeline.py> [main] Pipeline started, HapHiC version: 1.0.7 (update: 2025.05.07)
2025-12-19 17:44:35 <HapHiC_pipeline.py> [main] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2025-12-19 17:44:35 <HapHiC_pipeline.py> [main] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/24.hifi_genome/hifiasm/OV53_1.primary.fasta /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½/00.mapping/HiC.bam 12 --aln_format bam --outdir /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½ --RE GATC --steps 1,2,3,4 --threads 64 --processes 64 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000 --Nx 80 --RE_site_cutoff 25 --density_lower 0.2X --density_upper 1.9X --read_depth_upper 1.5X --topN 10 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --expansion 2 --max_iter 200 --pruning 0.0001 --min_group_len 0 --max_ctg_len 10000 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --min_density_ratio 4 --ambiguous_cutoff 0.6 --reassign_nrounds 5 --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --Ns 100 --max_width 60 --prefix OV53_1.primary
2025-12-19 17:44:35 <HapHiC_pipeline.py> [main] The directory /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½ already exists
2025-12-19 17:44:35 <HapHiC_pipeline.py> [haphic_cluster] Step1: Execute preprocessing and Markov clustering for contigs...
2025-12-19 17:44:35 <HapHiC_cluster.py> [run] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2025-12-19 17:44:35 <HapHiC_cluster.py> [run] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2025-12-19 17:44:35 <HapHiC_cluster.py> [run] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/24.hifi_genome/hifiasm/OV53_1.primary.fasta /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½/00.mapping/HiC.bam 12 --aln_format bam --outdir /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½ --RE GATC --steps 1,2,3,4 --threads 64 --processes 64 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000 --Nx 80 --RE_site_cutoff 25 --density_lower 0.2X --density_upper 1.9X --read_depth_upper 1.5X --topN 10 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --expansion 2 --max_iter 200 --pruning 0.0001 --min_group_len 0 --max_ctg_len 10000 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --min_density_ratio 4 --ambiguous_cutoff 0.6 --reassign_nrounds 5 --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --Ns 100 --max_width 60 --prefix OV53_1.primary
2025-12-19 17:44:35 <HapHiC_cluster.py> [parse_fasta] Parsing input FASTA file...
2025-12-19 17:45:06 <HapHiC_cluster.py> [determine_int_type] The longest and second longest contigs are 28218667 bp and 15710781 bp, respectively. The data types for contig positions and CLM distances are calculated to be int32 and int32, respectively.
2025-12-19 17:45:06 <HapHiC_cluster.py> [parse_bam_for_correction] Parsing input BAM file for contig correction...
2025-12-19 17:45:06 <HapHiC_cluster.py> [check_sorting_order] The sorting order of the BAM file is unsorted
Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py", line 536, in <module>
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py", line 517, in main
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py", line 358, in haphic_cluster
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_cluster.py", line 2801, in run
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_cluster.py", line 1396, in parse_bam_for_correction
MemoryError
Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic", line 117, in <module>
    subprocess.run(commands, check=True)
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/lib/python3.12/subprocess.py", line 571, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py', '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/24.hifi_genome/hifiasm/OV53_1.primary.fasta', '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½/00.mapping/HiC.bam', '12', '--aln_format', 'bam', '--outdir', '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½', '--RE', 'GATC', '--steps', '1,2,3,4', '--threads', '64', '--processes', '64', '--correct_nrounds', '2', '--correct_resolution', '500', '--median_cov_ratio', '0.2', '--region_len_ratio', '0.1', '--min_region_cutoff', '5000', '--Nx', '80', '--RE_site_cutoff', '25', '--density_lower', '0.2X', '--density_upper', '1.9X', '--read_depth_upper', '1.5X', '--topN', '10', '--min_inflation', '1.0', '--max_inflation', '3.0', '--inflation_step', '0.2', '--expansion', '2', '--max_iter', '200', '--pruning', '0.0001', '--min_group_len', '0', '--max_ctg_len', '10000', '--min_RE_sites', '25', '--min_links', '25', '--min_link_density', '0.0001', '--min_density_ratio', '4', '--ambiguous_cutoff', '0.6', '--reassign_nrounds', '5', '--mutprob', '0.2', '--ngen', '5000', '--npop', '100', '--seed', '42', '--Ns', '100', '--max_width', '60', '--prefix', 'OV53_1.primary']' returned non-zero exit status 1.
[2025-12-19 18:12:10] ğŸ“Š å¤„ç†ç»Ÿè®¡ | Processing Statistics:
[2025-12-19 18:12:10]   â±ï¸ æ€»è€—æ—¶ | Total time: 1681.22ç§’
[2025-12-19 18:12:10]   ğŸ“„ log_file: OV53_1.primary_haphic.log (27,028 bytes)
