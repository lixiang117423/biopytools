2026-01-08 13:10:02.642 - INFO - HapHiC处理器已初始化|HapHiC processor initialized
2026-01-08 13:10:02.655 - INFO - 配置参数|Configuration Parameters:
2026-01-08 13:10:02.655 - INFO -   assembly_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/OV53_1.hap1.primary.fa
2026-01-08 13:10:02.655 - INFO -   hic_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/01.data/hic/OV53_1-hic_R1.fastq.gz
2026-01-08 13:10:02.655 - INFO -   hic_file_type: fastq
2026-01-08 13:10:02.655 - INFO -   nchrs: 12
2026-01-08 13:10:02.655 - INFO -   output_dir: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1
2026-01-08 13:10:02.655 - INFO -   prefix: OV53_1.hap1.primary
2026-01-08 13:10:02.655 - INFO -   threads: 64
2026-01-08 13:10:02.655 - INFO -   processes: 8
2026-01-08 13:10:02.655 - INFO -   quick_view: False
2026-01-08 13:10:02.655 - INFO -   restriction_sites: ['GATC']
2026-01-08 13:10:02.655 - INFO -   correct_nrounds: 2
2026-01-08 13:10:02.655 - INFO -   remove_allelic_links: None
2026-01-08 13:10:02.655 - INFO -   phasing_weight: 1.0
2026-01-08 13:10:02.655 - INFO -   gfa_files: None
2026-01-08 13:10:02.656 - INFO -   haphic_bin: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic
2026-01-08 13:10:02.656 - INFO -   bwa_bin: bwa
2026-01-08 13:10:02.656 - INFO -   samtools_bin: samtools
2026-01-08 13:10:02.656 - INFO - 开始HapHiC流程|Starting HapHiC pipeline
2026-01-08 13:10:02.656 - INFO - 系统预检查|System pre-flight checks
2026-01-08 13:10:02.656 - INFO - 验证输入文件|Validating input files
2026-01-08 13:10:03.706 - INFO - 基因组序列数量|Assembly sequence count: 1282
2026-01-08 13:10:03.706 - INFO - FASTQ文件大小|FASTQ file sizes: R1 60.14 GB, R2 58.01 GB
2026-01-08 13:10:03.706 - INFO - 输入文件验证通过|Input files validated
2026-01-08 13:10:03.706 - INFO - 检查系统资源|Checking system resources
2026-01-08 13:10:04.126 - INFO - 可用内存|Available memory: 455.4 GB
2026-01-08 13:10:04.126 - INFO - 可用磁盘空间|Available disk space: 1510043.6 GB
2026-01-08 13:10:04.127 - INFO - CPU核心数|CPU cores: 88
2026-01-08 13:10:06.363 - INFO - 预检查通过|Pre-flight checks passed
2026-01-08 13:10:06.363 - INFO - 检查已存在的比对结果|Checking for existing alignment results
2026-01-08 13:10:06.363 - INFO - 输出目录: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1
2026-01-08 13:10:06.363 - INFO - 比对目录: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/00.mapping
2026-01-08 13:10:06.363 - INFO - 潜在BAM文件: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/00.mapping/HiC.bam
2026-01-08 13:10:06.363 - INFO - 潜在过滤BAM文件: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/00.mapping/HiC.filtered.bam
2026-01-08 13:10:06.364 - INFO - 比对目录存在|Alignment directory exists
2026-01-08 13:10:06.364 - INFO - 比对目录内容: ['assembly.fa.amb', 'assembly.fa.bwt', 'assembly.fa.ann', 'assembly.fa', 'HiC.filtered.bam', 'assembly.fa.pac', 'read1_1.fastq.gz', 'HiC.bam', 'assembly.fa.sa', 'read2_1.fastq.gz']
2026-01-08 13:10:06.395 - INFO - 发现已存在的过滤BAM文件，跳过BWA比对步骤|Found existing filtered BAM file, skipping BWA alignment: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/00.mapping/HiC.filtered.bam (69,225,553,169 bytes)
2026-01-08 13:10:06.395 - INFO - 使用按read name排序的过滤BAM文件以满足HapHiC要求|Using read name-sorted filtered BAM file to meet HapHiC requirements
2026-01-08 13:10:06.395 - INFO -  开始HapHiC Pipeline流程|Starting HapHiC Pipeline
2026-01-08 13:10:06.398 - INFO -  设置目录结构|Setting up directory structure
2026-01-08 13:10:06.413 - INFO -  目录结构设置完成|Directory structure setup complete
2026-01-08 13:10:06.413 - INFO -  检查HapHiC Pipeline完成状态|Checking HapHiC Pipeline completion status
2026-01-08 13:10:06.525 - INFO -  Cluster步骤已完成|Cluster step completed
2026-01-08 13:10:06.525 - INFO -  Reassign步骤已完成|Reassign step completed
2026-01-08 13:10:06.525 - INFO -  Sort步骤已完成|Sort step completed
2026-01-08 13:10:06.525 - INFO -  Build步骤已完成|Build step completed
2026-01-08 13:10:06.525 - INFO -  HapHiC Pipeline已完成，跳过执行|HapHiC Pipeline already completed, skipping execution
2026-01-08 13:10:06.526 - INFO -  可视化生成已禁用|Visualization generation disabled
2026-01-08 13:10:06.526 - INFO -  生成Juicebox文件|Generating Juicebox files
2026-01-08 13:10:06.526 - INFO -  步骤1: 生成.mnd文件|Step 1: Generating .mnd file
2026-01-08 13:10:06.544 - INFO -  mnd文件已存在，跳过生成|mnd file already exists: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/06.juicebox/out.links.mnd (7,294,014,755 bytes)
2026-01-08 13:10:06.544 - INFO -  步骤2: 排序.mnd文件|Step 2: Sorting .mnd file
2026-01-08 13:10:06.557 - INFO -  排序后的mnd文件已存在，跳过排序|sorted mnd file already exists: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/06.juicebox/out.sorted.links.mnd (7,294,014,755 bytes)
2026-01-08 13:10:06.557 - INFO -  步骤3: 生成.assembly文件|Step 3: Generating .assembly file
2026-01-08 13:10:06.557 - INFO - 生成.assembly文件
2026-01-08 13:10:06.703 - INFO - 命令执行成功|Command executed successfully (耗时: 0.15秒)
2026-01-08 13:10:06.703 - INFO -  步骤4: 生成.hic文件|Step 4: Generating .hic file
2026-01-08 13:24:53.721 - WARNING -  asm-visualizer返回码非0，但.hic文件已生成|asm-visualizer returned non-zero code, but .hic file exists
2026-01-08 13:24:53.737 - WARNING -  返回码|Return code: 1
2026-01-08 13:24:53.738 - ERROR - Juicebox文件生成失败|Juicebox file generation failed: [Errno 2] No such file or directory: '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/06.juicebox/OV53_1.hap1.primary.hic' -> '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/06.juicebox/OV53_1.hap1.primary.hic'
2026-01-08 13:24:53.738 - WARNING -  Juicebox文件生成失败，但继续执行其他步骤|Juicebox file generation failed, but continuing with other steps
2026-01-08 13:24:53.738 - INFO -  HapHiC Pipeline完成|HapHiC Pipeline completed in 887.34秒
2026-01-08 13:24:53.738 - INFO - 检测到纠错后的contig，需要重新比对Hi-C数据|Detected corrected contigs, need to realign Hi-C data
2026-01-08 13:24:53.739 - INFO - 创建纠错流程目录|Creating corrected workflow directory: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/07.corrected_contig_haphic
2026-01-08 13:24:53.739 - INFO - 开始重新比对Hi-C数据到纠错后的组装|Starting Hi-C realignment to corrected assembly
2026-01-08 13:24:53.739 - INFO -  开始BWA比对|Starting BWA alignment (official method)
2026-01-08 13:24:53.739 - INFO -  使用纠错后重新比对目录|Using corrected realignment directory
2026-01-08 13:24:53.740 - INFO -  使用提供的FASTQ文件对|Using provided FASTQ pair: OV53_1-hic_R1.fastq.gz
2026-01-08 13:24:53.740 - INFO -  找到 1 对FASTQ文件|Found 1 FASTQ pairs
2026-01-08 13:24:53.740 - INFO -  创建基因组软链接|Created assembly symlink: assembly.fa
2026-01-08 13:24:53.740 - INFO -  创建FASTQ软链接|Created FASTQ symlinks: read1_1.fastq.gz, read2_1.fastq.gz
2026-01-08 13:24:53.759 - INFO -  创建BWA索引|Creating BWA index: assembly.fa
2026-01-08 13:43:12.356 - INFO -  BWA索引创建完成|BWA index created
2026-01-08 13:43:12.356 - INFO -  步骤1: BWA比对 + 去重 + 初步过滤 (使用 64 线程)|Step 1: BWA alignment + deduplication + initial filtering (using 64 threads)
2026-01-08 13:43:12.356 - INFO -  创建纠错后的BAM文件|Creating corrected BAM file
2026-01-08 13:43:12.356 - INFO -  执行BWA比对管道|Executing BWA alignment pipeline
