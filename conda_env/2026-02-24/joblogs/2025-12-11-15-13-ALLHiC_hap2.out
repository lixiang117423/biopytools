ğŸ“ Log file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap2/logs/allhic_20251211_151351.log

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”§ Setting up environment
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 15:14:00] Checking required tools...
[2025-12-11 15:14:01] âœ… Environment ready
[2025-12-11 15:14:01] Working directory: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap2
[2025-12-11 15:14:01] Threads: 88
[2025-12-11 15:14:01] Memory: 800G
[2025-12-11 15:14:01] Chromosomes: 12
[2025-12-11 15:14:01] Enzyme: GATC
[2025-12-11 15:14:01] â±ï¸  Step completed in 10s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸš€ Starting ALLHiC Pipeline v4.1
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”— [Step 0] Preparing input data
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 15:14:01] âœ… Input files linked
[2025-12-11 15:14:01] â±ï¸  Step completed in 0s
[2025-12-11 15:14:01] â­ï¸  Skipping mapping step
[2025-12-11 15:14:01] â­ï¸  Skipping allele detection
[2025-12-11 15:14:01] â­ï¸  Skipping pruning
[2025-12-11 15:14:01] â­ï¸  Skipping partition
[2025-12-11 15:14:01] â­ï¸  Skipping extract
[2025-12-11 15:14:01] â­ï¸  Skipping rescue
[2025-12-11 15:14:01] â­ï¸  Skipping optimization
[2025-12-11 15:14:01] â­ï¸  Skipping build
[2025-12-11 15:14:01] â­ï¸  Skipping plot

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ¨ [Step 8] Generating JBAT files (Fixed Version)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 15:14:01] âš ï¸  BAM file is not name-sorted (current: querynameSS)
[2025-12-11 15:14:01] âœ… Using existing name-sorted BAM: jbat_results/sample.clean.namesorted.bam
[2025-12-11 15:14:01] Generating MND file from BAM (with quality filtering)...
[2025-12-11 15:14:01]    This may take several minutes for large BAM files...
[2025-12-11 15:33:15] ğŸ“Š Processing statistics:
[2025-12-11 15:33:15]    âœ… Valid pairs: 237497021
[2025-12-11 15:33:15]    âš ï¸  Unpaired reads: 279719163
[2025-12-11 15:33:15]    ğŸš« Low quality filtered: 0
[2025-12-11 15:33:15] Sorting MND data by chromosome and position...
[2025-12-11 15:45:28] Merging sorted chunks...
[2025-12-11 16:25:30] âœ… MND file generated: 11G (237497022 pairs)
[2025-12-11 16:25:30] ğŸ” Validating MND format...
[2025-12-11 16:25:30]    First line: 0 .h2tg000002l 129922 0 0 h2tg000170l 9511512 1
[2025-12-11 16:25:30]    Column count: 8 (expected: 8 for short format)
[2025-12-11 16:25:30] âš ï¸  Warning: Chromosome '.h2tg000002l' not found in jbat_results/draft.chrom.sizes
[2025-12-11 16:25:30]    Available chromosomes:
[2025-12-11 16:25:30]       h2tg000001l	790330
[2025-12-11 16:25:30]       h2tg000002l	11444709
[2025-12-11 16:25:30]       h2tg000003l	2391442
[2025-12-11 16:25:30]       h2tg000004l	4658915
[2025-12-11 16:25:30]       h2tg000005l	386932
[2025-12-11 16:25:30] Generating HIC file using Juicer Tools...
[2025-12-11 16:25:30] â–¶ï¸  java -Xmx800G -Djava.awt.headless=true -jar '/share/org/YZWL/yzwl_lixg/software/juicer/CPU/common/juicer_tools.jar' pre 'jbat_results/draft.mnd.sorted.txt' 'jbat_results/draft.hic' 'jbat_results/draft.chrom.sizes'
WARNING: sun.reflect.Reflection.getCallerClass is not supported. This will impact performance.
WARN [2025-12-11T16:25:31,288]  [Globals.java:138] [main]  Development mode is enabled
Using 1 CPU thread(s)
Not including fragment map
Start preprocess
Writing header
Writing body
java.lang.NumberFormatException: For input string: "615856."
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:67)
	at java.base/java.lang.Integer.parseInt(Integer.java:668)
	at java.base/java.lang.Integer.parseInt(Integer.java:786)
	at juicebox.tools.utils.original.AsciiPairIterator.advance(AsciiPairIterator.java:232)
	at juicebox.tools.utils.original.AsciiPairIterator.next(AsciiPairIterator.java:287)
	at juicebox.tools.utils.original.Preprocessor.computeWholeGenomeMatrix(Preprocessor.java:571)
	at juicebox.tools.utils.original.Preprocessor.writeBody(Preprocessor.java:658)
	at juicebox.tools.utils.original.Preprocessor.preprocess(Preprocessor.java:425)
	at juicebox.tools.clt.old.PreProcessing.run(PreProcessing.java:139)
	at juicebox.tools.HiCTools.main(HiCTools.java:94)
[2025-12-11 16:25:31] âœ… HIC file generated successfully: 0
[2025-12-11 16:25:31] 
[2025-12-11 16:25:31] â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 16:25:31] ğŸ“Š JBAT Files Summary:
[2025-12-11 16:25:31] â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 16:25:31]   ğŸ“„ Assembly: 128K
[2025-12-11 16:25:31]   ğŸ“ Chrom sizes: 972 scaffolds
[2025-12-11 16:25:35]   ğŸ”— MND: 11G (237497022 pairs)
[2025-12-11 16:25:35]   ğŸ¨ HIC: 0
[2025-12-11 16:25:35] â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 16:25:35] 
[2025-12-11 16:25:35] Next steps:
[2025-12-11 16:25:35]   1. Open JBAT: https://github.com/aidenlab/Juicebox
[2025-12-11 16:25:35]   2. Load assembly: jbat_results/out_JBAT.assembly
[2025-12-11 16:25:35]   3. Load HiC map: jbat_results/draft.hic
[2025-12-11 16:25:35] 
[2025-12-11 16:25:35] Cleaning up temporary files...
[2025-12-11 16:25:35] â±ï¸  Step completed in 1h 11m 34s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ‰ Pipeline Completed in 1h 11m 44s
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 16:25:35] ğŸ“ Full log: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap2/logs/allhic_20251211_151351.log
[2025-12-11 16:25:35] 
[2025-12-11 16:25:35] Checking required files:
[2025-12-11 16:25:35]   âœ… sample.clean.clm ()
[2025-12-11 16:25:35]   âœ… draft.asm.fasta ()
[2025-12-11 16:25:35]   âœ… prunning.clusters.txt ()
[2025-12-11 16:25:35] 
[2025-12-11 16:25:35] Checking group files:
[2025-12-11 16:25:35]    | group10.txt (,  contigs)
[2025-12-11 16:25:35]    | group11.txt (,  contigs)
[2025-12-11 16:25:35]    | group12.txt (,  contigs)
[2025-12-11 16:25:35]    | group1.txt (,  contigs)
[2025-12-11 16:25:35]    | group2.txt (,  contigs)
[2025-12-11 16:25:35]    | group3.txt (,  contigs)
[2025-12-11 16:25:35]    | group4.txt (,  contigs)
[2025-12-11 16:25:35]    | group5.txt (,  contigs)
[2025-12-11 16:25:35]    | group6.txt (,  contigs)
[2025-12-11 16:25:35]    | group7.txt (,  contigs)
[2025-12-11 16:25:35]    | group8.txt (,  contigs)
[2025-12-11 16:25:35]    | group9.txt (,  contigs)
[2025-12-11 16:25:35] 
[2025-12-11 16:25:35] Checking CLM file validity:
[2025-12-11 16:26:16]   Unique contigs in CLM: 
[2025-12-11 16:26:16]   Contigs in group1.txt: 
[2025-12-11 16:26:41]   Matched contigs: 92/
[2025-12-11 16:26:41] 
[2025-12-11 16:26:41] Testing manual optimization on first incomplete group...
[2025-12-11 16:26:41] 
[2025-12-11 16:26:41] Diagnosis complete. Check the output above for issues.
