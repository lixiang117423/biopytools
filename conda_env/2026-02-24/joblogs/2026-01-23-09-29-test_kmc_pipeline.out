2026-01-23 09:29:10.428 - INFO - 开始k-mer统计模式|Starting k-mer counting mode
2026-01-23 09:29:10.428 - INFO - 检测到目录输入模式|Detected directory input mode: fastq
2026-01-23 09:29:10.428 - INFO - 数据模式|Data mode: 双末端|Paired-end
2026-01-23 09:29:10.428 - INFO - 文件模式|File pattern: *_1.clean.fq, *_2.clean.fq
2026-01-23 09:29:10.429 - INFO - 找到 3 个read1文件|Found 3 read1 files
2026-01-23 09:29:10.429 - INFO - 验证通过|Validation passed: 3 个样本|samples
2026-01-23 09:29:10.429 - INFO - 开始统计 3 个样本|Starting to count 3 samples
2026-01-23 09:29:10.429 - INFO - 处理进度|Progress: 1/3: test1
2026-01-23 09:29:10.429 - INFO - 开始统计样本|Starting to count sample: test1
2026-01-23 09:29:10.430 - INFO - 执行步骤|Executing step: 统计样本|Counting sample test1
2026-01-23 09:29:10.430 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc -k51 -ci2 -t64 @/share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test1/input_files.txt test1 /share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test1
2026-01-23 09:29:11.767 - INFO - 命令执行成功|Command executed successfully: 统计样本|Counting sample test1
2026-01-23 09:29:11.767 - INFO - 样本统计完成|Sample counting completed: test1
2026-01-23 09:29:11.767 - INFO - 处理进度|Progress: 2/3: test2
2026-01-23 09:29:11.767 - INFO - 开始统计样本|Starting to count sample: test2
2026-01-23 09:29:11.769 - INFO - 执行步骤|Executing step: 统计样本|Counting sample test2
2026-01-23 09:29:11.769 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc -k51 -ci2 -t64 @/share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test2/input_files.txt test2 /share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test2
2026-01-23 09:29:13.085 - INFO - 命令执行成功|Command executed successfully: 统计样本|Counting sample test2
2026-01-23 09:29:13.085 - INFO - 样本统计完成|Sample counting completed: test2
2026-01-23 09:29:13.086 - INFO - 处理进度|Progress: 3/3: test3
2026-01-23 09:29:13.086 - INFO - 开始统计样本|Starting to count sample: test3
2026-01-23 09:29:13.086 - INFO - 执行步骤|Executing step: 统计样本|Counting sample test3
2026-01-23 09:29:13.087 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc -k51 -ci2 -t64 @/share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test3/input_files.txt test3 /share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test3
2026-01-23 09:29:14.615 - INFO - 命令执行成功|Command executed successfully: 统计样本|Counting sample test3
2026-01-23 09:29:14.615 - INFO - 样本统计完成|Sample counting completed: test3
2026-01-23 09:29:14.615 - INFO - 统计完成|Counting completed: 3/3 个样本成功|samples successful
2026-01-23 09:29:14.615 - INFO - 统计完成|Counting completed: 3/3 个样本成功|samples successful
2026-01-23 09:29:14.616 - INFO - Metadata文件已保存|Metadata file saved: database/kmer_metadata.json
2026-01-23 09:29:14.616 - INFO - k-mer大小|K-mer size: 51
2026-01-23 09:29:14.761 - INFO - 开始丰度矩阵构建模式|Starting abundance matrix building mode
2026-01-23 09:29:14.761 - INFO - 使用自定义输入目录|Using custom input directory: database/kmc_databases
2026-01-23 09:29:14.762 - INFO - 从count metadata读取k-mer大小|Read k-mer size from count metadata: 21 → 51
2026-01-23 09:29:14.762 - INFO - 未指定样本名称，自动扫描数据库|No sample names specified, auto-scanning databases
2026-01-23 09:29:14.762 - INFO - 扫描已存在的KMC数据库|Scanning existing KMC databases
2026-01-23 09:29:14.762 - INFO - 找到 3 个KMC数据库|Found 3 KMC databases
2026-01-23 09:29:14.762 - INFO - 开始构建丰度矩阵|Starting to build abundance matrix: 3 样本|samples
2026-01-23 09:29:14.762 - INFO - 检测到已存在的k-mer文件，跳过union步骤|Found existing k-mer file, skipping union: database/global_kmers_with_id.txt
2026-01-23 09:29:14.764 - INFO - 元数据中n_kmers为0，统计k-mer数量（可能需要几分钟）|n_kmers is 0 in metadata, counting k-mers (may take a few minutes)
2026-01-23 09:29:17.407 - INFO - 统计k-mer数量：34,676,051|Counted k-mers: 34,676,051
2026-01-23 09:29:17.408 - INFO - 元数据已更新|Metadata updated
2026-01-23 09:29:17.408 - INFO - 初始化矩阵文件|Initializing matrix file
2026-01-23 09:29:17.413 - INFO - 矩阵文件初始化完成|Matrix file initialized
2026-01-23 09:29:17.413 - INFO - k-mer文件大小|K-mer file size: 2.03GB
2026-01-23 09:29:17.413 - INFO - 加载或构建索引|Loading or building index
2026-01-23 09:29:17.413 - INFO - 文件大小 2.03GB >= 阈值 1.0GB，使用数据库索引|File size 2.03GB >= threshold 1.0GB, using database index
2026-01-23 09:29:17.416 - INFO - 构建LevelDB索引|Building LevelDB index: database/kmer_index.ldb
2026-01-23 09:29:52.019 - INFO - LevelDB索引构建完成：34,676,051 k-mers|LevelDB index built: 34,676,051 k-mers
2026-01-23 09:30:30.960 - INFO - 处理样本|Processing sample 1/3: test2
2026-01-23 09:30:30.961 - INFO - 查询样本丰度|Querying sample abundances: test2
2026-01-23 09:30:47.265 - INFO - 从dump文件读取|Read from dump: 34,676,051 k-mers
2026-01-23 09:30:47.268 - INFO - 使用 64 线程并行查询|Using 64 threads for parallel query
2026-01-23 09:30:47.475 - INFO - 数据分块|Data chunks: 64, 每块约|~541,814 条
2026-01-23 09:33:27.334 - INFO - 查询完成|Query completed: 34,676,051 个k-mer
2026-01-23 09:33:28.881 - INFO - 保存样本丰度|Saving sample abundances: test2
2026-01-23 09:33:28.882 - INFO - 存储类型|Storage type: sparse (类型|type: <class 'str'>)
2026-01-23 09:33:28.882 - INFO - 使用稀疏存储|Using sparse storage
2026-01-23 09:33:28.882 - INFO - 当前数据集大小|Current dataset size: 5201407, 新增|new: 34676051
2026-01-23 09:33:28.882 - INFO - 数据集已扩展|Dataset resized to: 39877458
2026-01-23 09:33:39.531 - INFO - 样本丰度已保存|Sample abundances saved: test2
2026-01-23 09:33:39.531 - INFO - 处理样本|Processing sample 2/3: test3
2026-01-23 09:33:39.531 - INFO - 查询样本丰度|Querying sample abundances: test3
2026-01-23 09:33:56.499 - INFO - 从dump文件读取|Read from dump: 34,676,051 k-mers
2026-01-23 09:33:56.499 - INFO - 使用 64 线程并行查询|Using 64 threads for parallel query
2026-01-23 09:33:56.697 - INFO - 数据分块|Data chunks: 64, 每块约|~541,814 条
2026-01-23 09:36:34.374 - INFO - 查询完成|Query completed: 34,676,051 个k-mer
2026-01-23 09:36:37.080 - INFO - 保存样本丰度|Saving sample abundances: test3
2026-01-23 09:36:37.081 - INFO - 存储类型|Storage type: sparse (类型|type: <class 'str'>)
2026-01-23 09:36:37.081 - INFO - 使用稀疏存储|Using sparse storage
2026-01-23 09:36:37.081 - INFO - 当前数据集大小|Current dataset size: 39877458, 新增|new: 34676051
2026-01-23 09:36:37.082 - INFO - 数据集已扩展|Dataset resized to: 74553509
2026-01-23 09:36:47.665 - INFO - 样本丰度已保存|Sample abundances saved: test3
2026-01-23 09:36:47.666 - INFO - 处理样本|Processing sample 3/3: test1
2026-01-23 09:36:47.666 - INFO - 查询样本丰度|Querying sample abundances: test1
2026-01-23 09:37:04.083 - INFO - 从dump文件读取|Read from dump: 34,676,051 k-mers
2026-01-23 09:37:04.084 - INFO - 使用 64 线程并行查询|Using 64 threads for parallel query
2026-01-23 09:37:04.276 - INFO - 数据分块|Data chunks: 64, 每块约|~541,814 条
2026-01-23 09:39:42.213 - INFO - 查询完成|Query completed: 34,676,051 个k-mer
2026-01-23 09:39:44.919 - INFO - 保存样本丰度|Saving sample abundances: test1
2026-01-23 09:39:44.921 - INFO - 存储类型|Storage type: sparse (类型|type: <class 'str'>)
2026-01-23 09:39:44.921 - INFO - 使用稀疏存储|Using sparse storage
2026-01-23 09:39:44.921 - INFO - 当前数据集大小|Current dataset size: 74553509, 新增|new: 34676051
2026-01-23 09:39:44.921 - INFO - 数据集已扩展|Dataset resized to: 109229560
2026-01-23 09:39:56.266 - INFO - 样本丰度已保存|Sample abundances saved: test1
2026-01-23 09:39:56.368 - INFO - LevelDB索引已关闭|LevelDB index closed
2026-01-23 09:39:56.368 - INFO - 从文件保存k-mer字典到HDF5|Saving k-mer dictionary from file to HDF5
2026-01-23 09:40:46.027 - INFO - k-mer字典已保存|K-mer dictionary saved: database/kmer_dictionary.h5
2026-01-23 09:40:47.412 - INFO - 丰度矩阵构建完成|Abundance matrix built: database/abundance_matrix.h5
2026-01-23 09:40:48.532 - INFO - 矩阵统计|Matrix statistics:
2026-01-23 09:40:48.532 - INFO -   k-mer数量|K-mer count: 34.68M
2026-01-23 09:40:48.532 - INFO -   样本数量|Sample count: 3
2026-01-23 09:40:48.532 - INFO -   k-mer长度|K-mer size: 51
2026-01-23 09:40:48.532 - INFO -   存储类型|Storage type: sparse
2026-01-23 09:40:48.532 - INFO -   稀疏度|Sparsity: 105.00%
2026-01-23 09:40:48.532 - INFO - 自动导出TSV文件|Auto exporting TSV files
2026-01-23 09:40:48.532 - INFO - 导出丰度文件|Exporting abundance file: database/abundance_matrix.tsv
2026-01-23 09:40:48.532 - INFO - 开始导出矩阵到TSV|Starting to export matrix to TSV: database/abundance_matrix.tsv
2026-01-23 09:40:48.532 - INFO - 输出格式|Output format: full
2026-01-23 09:40:48.532 - INFO - 最小丰度阈值|Minimum abundance threshold: 1
2026-01-23 09:40:59.641 - INFO - 矩阵信息|Matrix info:
2026-01-23 09:40:59.641 - INFO -   样本数|Samples: 3
2026-01-23 09:40:59.641 - INFO -   k-mer数|K-mers: 34676051
2026-01-23 09:40:59.641 - INFO -   存储类型|Storage type: sparse
2026-01-23 09:40:59.641 - INFO - 使用完整矩阵格式导出|Exporting in full matrix format
2026-01-23 09:40:59.642 - WARNING - 从稀疏矩阵转换为完整矩阵可能需要大量内存和时间|Converting sparse to full matrix may require lots of memory and time
2026-01-23 09:42:10.379 - INFO - 写入 34676051 个k-mer x 3 个样本|Wrote 34676051 k-mers x 3 samples
2026-01-23 09:42:10.384 - INFO - 导出完成|Export completed: database/abundance_matrix.tsv
2026-01-23 09:42:11.251 - INFO - 导出存在文件|Exporting presence file: database/presence_matrix.tsv
2026-01-23 09:42:22.436 - INFO - 导出 34676051 k-mers x 3 samples 到存在矩阵|Exporting 34676051 k-mers x 3 samples to presence matrix
2026-01-23 09:44:03.839 - INFO - 存在文件已导出|Presence file exported: database/presence_matrix.tsv
2026-01-23 09:44:05.365 - INFO - TSV文件导出完成|TSV files exported
