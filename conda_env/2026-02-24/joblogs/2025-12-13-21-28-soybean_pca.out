2025-12-13 21:28:07,912 - INFO - 开始VCF PCA分析流程 | Starting VCF PCA analysis pipeline
2025-12-13 21:28:07,912 - INFO - VCF文件 | VCF file: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/variation.filtered.snp.vcf.gz
2025-12-13 21:28:07,912 - INFO - 输出目录 | Output directory: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output
2025-12-13 21:28:07,912 - INFO - 检查依赖软件 | Checking dependencies
2025-12-13 21:28:08,334 - INFO - ✓ PLINK 可用 | available
2025-12-13 21:28:08,771 - INFO - ✓ BCFtools 可用 | available
2025-12-13 21:28:08,771 - INFO - ============================================================
2025-12-13 21:28:08,771 - INFO - 步骤1: VCF转PLINK格式 | Step 1: VCF to PLINK conversion
2025-12-13 21:28:08,771 - INFO - ============================================================
2025-12-13 21:28:08,771 - INFO - 获取VCF文件统计信息 | Getting VCF file statistics
2025-12-13 23:20:18,647 - INFO - VCF统计 | VCF statistics: 2162 样本 | samples, 11959424 变异 | variants
2025-12-13 23:20:18,648 - INFO - 开始处理包含 2162 个样本和 11959424 个变异的VCF文件
2025-12-13 23:20:18,649 - INFO - 输出目录可写 | Output directory is writable: pca_output
2025-12-13 23:20:18,649 - INFO - 执行步骤 | Executing step: VCF转换为PLINK格式 | Convert VCF to PLINK format
2025-12-13 23:20:18,649 - INFO - 命令 | Command: plink --vcf /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/variation.filtered.snp.vcf.gz --make-bed --out /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output/vcf_pca --allow-extra-chr --double-id
2025-12-13 23:20:18,649 - INFO - 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output
2025-12-14 00:03:55,791 - INFO - 命令执行成功 | Command executed successfully: VCF转换为PLINK格式 | Convert VCF to PLINK format
2025-12-14 00:03:55,791 - INFO - PLINK文件已生成 | PLINK files generated: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output/vcf_pca
2025-12-14 00:03:55,791 - INFO - ============================================================
2025-12-14 00:03:55,791 - INFO - 步骤2: 质量控制 | Step 2: Quality control
2025-12-14 00:03:55,791 - INFO - ============================================================
2025-12-14 00:03:55,791 - INFO - 应用质量控制过滤 | Applying quality control filters
2025-12-14 00:03:55,791 - INFO - MAF阈值 | MAF threshold: 0.05
2025-12-14 00:03:55,792 - INFO - 缺失率阈值 | Missing rate threshold: 0.1
2025-12-14 00:03:55,792 - INFO - HWE p值阈值 | HWE p-value threshold: 1e-06
2025-12-14 00:03:55,792 - INFO - 执行步骤 | Executing step: MAF过滤 | MAF filtering (>=0.05)
2025-12-14 00:03:55,792 - INFO - 命令 | Command: plink --bfile /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output/vcf_pca --maf 0.05 --make-bed --out /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output/vcf_pca_maf --allow-extra-chr
2025-12-14 00:03:55,792 - INFO - 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output
2025-12-14 00:04:09,045 - INFO - 命令执行成功 | Command executed successfully: MAF过滤 | MAF filtering (>=0.05)
2025-12-14 00:04:09,045 - INFO - 执行步骤 | Executing step: HWE过滤 | HWE filtering (p>1e-06)
2025-12-14 00:04:09,045 - INFO - 命令 | Command: plink --bfile /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output/vcf_pca_maf --hwe 1e-06 --make-bed --out /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output/vcf_pca_hwe --allow-extra-chr
2025-12-14 00:04:09,048 - INFO - 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output
2025-12-14 00:04:16,472 - INFO - 命令执行成功 | Command executed successfully: HWE过滤 | HWE filtering (p>1e-06)
2025-12-14 00:04:16,472 - INFO - 执行步骤 | Executing step: 缺失率过滤 | Missing rate filtering (<0.1)
2025-12-14 00:04:16,472 - INFO - 命令 | Command: plink --bfile /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output/vcf_pca_hwe --geno 0.1 --mind 0.1 --make-bed --out /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output/vcf_pca_qc --allow-extra-chr
2025-12-14 00:04:16,472 - INFO - 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output
2025-12-14 00:04:17,640 - INFO - 命令执行成功 | Command executed successfully: 缺失率过滤 | Missing rate filtering (<0.1)
2025-12-14 00:04:17,640 - INFO - 质控后样本数 | Samples after QC: 1580
2025-12-14 00:04:17,664 - INFO - 质控后SNP数 | SNPs after QC: 461862
2025-12-14 00:04:17,664 - INFO - ============================================================
2025-12-14 00:04:17,664 - INFO - 步骤3: PCA分析 | Step 3: PCA analysis
2025-12-14 00:04:17,664 - INFO - ============================================================
2025-12-14 00:04:17,664 - INFO - 开始PCA分析 | Starting PCA analysis
2025-12-14 00:04:17,664 - INFO - 主成分数量 | Number of components: 10
2025-12-14 00:04:17,664 - INFO - 执行步骤 | Executing step: PCA分析 | PCA analysis (10 components)
2025-12-14 00:04:17,664 - INFO - 命令 | Command: plink --bfile /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output/vcf_pca_qc --pca 10 --out /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output/pca_results --allow-extra-chr
2025-12-14 00:04:17,664 - INFO - 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output
2025-12-14 00:04:23,673 - INFO - 命令执行成功 | Command executed successfully: PCA分析 | PCA analysis (10 components)
2025-12-14 00:04:23,673 - INFO - 分析PCA结果 | Analyzing PCA results
2025-12-14 00:04:23,674 - INFO - PCA分析结果 | PCA Analysis Results:
2025-12-14 00:04:23,674 - INFO - 总方差 | Total variance: 267.7459
2025-12-14 00:04:23,674 - INFO - 主成分解释方差 | Principal component explained variance:
2025-12-14 00:04:23,674 - INFO -   PC1: 特征值 | Eigenvalue = 76.6745, 解释方差比 | Explained variance ratio = 0.2864 (28.64%), 累积 | Cumulative = 0.2864 (28.64%)
2025-12-14 00:04:23,674 - INFO -   PC2: 特征值 | Eigenvalue = 42.7901, 解释方差比 | Explained variance ratio = 0.1598 (15.98%), 累积 | Cumulative = 0.4462 (44.62%)
2025-12-14 00:04:23,674 - INFO -   PC3: 特征值 | Eigenvalue = 27.7120, 解释方差比 | Explained variance ratio = 0.1035 (10.35%), 累积 | Cumulative = 0.5497 (54.97%)
2025-12-14 00:04:23,674 - INFO -   PC4: 特征值 | Eigenvalue = 23.1468, 解释方差比 | Explained variance ratio = 0.0865 (8.65%), 累积 | Cumulative = 0.6361 (63.61%)
2025-12-14 00:04:23,674 - INFO -   PC5: 特征值 | Eigenvalue = 22.8299, 解释方差比 | Explained variance ratio = 0.0853 (8.53%), 累积 | Cumulative = 0.7214 (72.14%)
2025-12-14 00:04:23,674 - INFO -   PC6: 特征值 | Eigenvalue = 18.5784, 解释方差比 | Explained variance ratio = 0.0694 (6.94%), 累积 | Cumulative = 0.7908 (79.08%)
2025-12-14 00:04:23,674 - INFO -   PC7: 特征值 | Eigenvalue = 15.1367, 解释方差比 | Explained variance ratio = 0.0565 (5.65%), 累积 | Cumulative = 0.8473 (84.73%)
2025-12-14 00:04:23,674 - INFO -   PC8: 特征值 | Eigenvalue = 14.8072, 解释方差比 | Explained variance ratio = 0.0553 (5.53%), 累积 | Cumulative = 0.9026 (90.26%)
2025-12-14 00:04:23,674 - INFO -   PC9: 特征值 | Eigenvalue = 13.2569, 解释方差比 | Explained variance ratio = 0.0495 (4.95%), 累积 | Cumulative = 0.9521 (95.21%)
2025-12-14 00:04:23,674 - INFO -   PC10: 特征值 | Eigenvalue = 12.8134, 解释方差比 | Explained variance ratio = 0.0479 (4.79%), 累积 | Cumulative = 1.0000 (100.00%)
2025-12-14 00:04:23,776 - INFO - 解释方差表已保存 | Explained variance table saved: pca_output/pca_explained_variance.txt
2025-12-14 00:04:23,776 - INFO - 特征值说明文件已保存 | Eigenvalues explanation saved: pca_output/eigenvalues_explanation.txt
2025-12-14 00:04:23,813 - INFO - 格式化特征向量已保存 | Formatted eigenvectors saved: pca_output/pca_eigenvectors_formatted.txt
2025-12-14 00:04:23,813 - INFO - 总结报告已生成 | Summary report generated: pca_output/pca_analysis_summary.txt
2025-12-14 00:04:23,813 - INFO - ============================================================
2025-12-14 00:04:23,813 - INFO - PCA分析完成！| PCA analysis completed!
2025-12-14 00:04:23,813 - INFO - ============================================================
2025-12-14 00:04:23,813 - INFO - 结果保存在 | Results saved in: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output
