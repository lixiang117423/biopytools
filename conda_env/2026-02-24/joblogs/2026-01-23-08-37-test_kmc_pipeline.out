2026-01-23 08:37:46.077 - INFO - 开始k-mer统计模式|Starting k-mer counting mode
2026-01-23 08:37:46.077 - INFO - 检测到目录输入模式|Detected directory input mode: fastq
2026-01-23 08:37:46.077 - INFO - 数据模式|Data mode: 双末端|Paired-end
2026-01-23 08:37:46.077 - INFO - 文件模式|File pattern: *_1.clean.fq, *_2.clean.fq
2026-01-23 08:37:46.077 - INFO - 找到 3 个read1文件|Found 3 read1 files
2026-01-23 08:37:46.078 - INFO - 验证通过|Validation passed: 3 个样本|samples
2026-01-23 08:37:46.078 - INFO - 开始统计 3 个样本|Starting to count 3 samples
2026-01-23 08:37:46.078 - INFO - 处理进度|Progress: 1/3: test1
2026-01-23 08:37:46.078 - INFO - 开始统计样本|Starting to count sample: test1
2026-01-23 08:37:46.091 - INFO - 执行步骤|Executing step: 统计样本|Counting sample test1
2026-01-23 08:37:46.091 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc -k51 -ci2 -t64 @/share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test1/input_files.txt test1 /share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test1
2026-01-23 08:37:47.463 - INFO - 命令执行成功|Command executed successfully: 统计样本|Counting sample test1
2026-01-23 08:37:47.463 - INFO - 样本统计完成|Sample counting completed: test1
2026-01-23 08:37:47.464 - INFO - 处理进度|Progress: 2/3: test2
2026-01-23 08:37:47.464 - INFO - 开始统计样本|Starting to count sample: test2
2026-01-23 08:37:47.465 - INFO - 执行步骤|Executing step: 统计样本|Counting sample test2
2026-01-23 08:37:47.465 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc -k51 -ci2 -t64 @/share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test2/input_files.txt test2 /share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test2
2026-01-23 08:37:48.961 - INFO - 命令执行成功|Command executed successfully: 统计样本|Counting sample test2
2026-01-23 08:37:48.961 - INFO - 样本统计完成|Sample counting completed: test2
2026-01-23 08:37:48.962 - INFO - 处理进度|Progress: 3/3: test3
2026-01-23 08:37:48.962 - INFO - 开始统计样本|Starting to count sample: test3
2026-01-23 08:37:48.963 - INFO - 执行步骤|Executing step: 统计样本|Counting sample test3
2026-01-23 08:37:48.963 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc -k51 -ci2 -t64 @/share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test3/input_files.txt test3 /share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test3
2026-01-23 08:37:50.303 - INFO - 命令执行成功|Command executed successfully: 统计样本|Counting sample test3
2026-01-23 08:37:50.303 - INFO - 样本统计完成|Sample counting completed: test3
2026-01-23 08:37:50.304 - INFO - 统计完成|Counting completed: 3/3 个样本成功|samples successful
2026-01-23 08:37:50.304 - INFO - 统计完成|Counting completed: 3/3 个样本成功|samples successful
2026-01-23 08:37:50.306 - INFO - Metadata文件已保存|Metadata file saved: database/kmer_metadata.json
2026-01-23 08:37:50.306 - INFO - k-mer大小|K-mer size: 51
2026-01-23 08:37:50.439 - INFO - 开始丰度矩阵构建模式|Starting abundance matrix building mode
2026-01-23 08:37:50.439 - INFO - 使用自定义输入目录|Using custom input directory: database/kmc_databases
2026-01-23 08:37:50.439 - INFO - 从count metadata读取k-mer大小|Read k-mer size from count metadata: 21 → 51
2026-01-23 08:37:50.439 - INFO - 未指定样本名称，自动扫描数据库|No sample names specified, auto-scanning databases
2026-01-23 08:37:50.439 - INFO - 扫描已存在的KMC数据库|Scanning existing KMC databases
2026-01-23 08:37:50.440 - INFO - 找到 3 个KMC数据库|Found 3 KMC databases
2026-01-23 08:37:50.440 - INFO - 开始构建丰度矩阵|Starting to build abundance matrix: 3 样本|samples
2026-01-23 08:37:50.440 - INFO - 检测到已存在的k-mer文件，跳过union步骤|Found existing k-mer file, skipping union: database/global_kmers_with_id.txt
2026-01-23 08:37:50.442 - INFO - 从元数据加载 0 个k-mer|Loaded 0 k-mers from metadata
2026-01-23 08:37:50.442 - INFO - 初始化矩阵文件|Initializing matrix file
2026-01-23 08:37:50.447 - INFO - 矩阵文件初始化完成|Matrix file initialized
2026-01-23 08:37:50.447 - INFO - k-mer文件大小|K-mer file size: 2.03GB
2026-01-23 08:37:50.447 - INFO - 加载或构建索引|Loading or building index
2026-01-23 08:37:50.447 - INFO - 文件大小 2.03GB >= 阈值 1.0GB，使用数据库索引|File size 2.03GB >= threshold 1.0GB, using database index
2026-01-23 08:37:50.448 - INFO - 构建LevelDB索引|Building LevelDB index: database/kmer_index.ldb
2026-01-23 08:38:27.183 - INFO - LevelDB索引构建完成：34,676,051 k-mers|LevelDB index built: 34,676,051 k-mers
2026-01-23 08:39:07.106 - INFO - 处理样本|Processing sample 1/3: test2
2026-01-23 08:39:07.166 - INFO - 查询样本丰度|Querying sample abundances: test2
2026-01-23 08:39:24.986 - INFO - 从dump文件读取|Read from dump: 34,676,051 k-mers
2026-01-23 08:39:24.993 - INFO - 使用 12 进程并行查询|Using 12 processes for parallel query
2026-01-23 08:39:25.247 - INFO - 数据分块|Data chunks: 12, 每块约|~2,889,671 条
2026-01-23 08:40:04.080 - ERROR - 程序执行出错|Program execution error: b'IO error: lock database/kmer_index.ldb/LOCK: Resource temporarily unavailable'
