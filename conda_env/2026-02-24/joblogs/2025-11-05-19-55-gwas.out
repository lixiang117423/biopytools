2025-11-05 19:56:00,596 - INFO - 工作目录 | Working directory: gwas_results
2025-11-05 19:56:00,597 - INFO - 开始PLINK GWAS分析流程 | Starting PLINK GWAS analysis pipeline...
2025-11-05 19:56:00,597 - INFO - 表型类型 | Trait type: qualitative
2025-11-05 19:56:00,597 - INFO - 遗传模型 | Genetic model: dominant
2025-11-05 19:56:00,597 - INFO - 显著性校正方法 | Correction method: all
2025-11-05 19:56:00,597 - INFO - ==================================================
2025-11-05 19:56:00,597 - INFO - 步骤1: 检查输入文件 | Step 1: Checking input files
2025-11-05 19:56:00,598 - INFO - 📂 复制输入文件到工作目录 | Copying input files to working directory...
2025-11-05 19:56:00,598 - INFO - 📁 正在复制VCF文件 | Copying VCF file (8750.3 MB)...
2025-11-05 19:56:14,103 - INFO - ✅ VCF文件已复制 | VCF file copied: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/06.gwas/gwas_results/input.vcf.gz
2025-11-05 19:56:14,104 - INFO - 📁 正在复制表型文件 | Copying phenotype file (0.8 KB)...
2025-11-05 19:56:14,106 - INFO - ✅ 表型文件已复制 | Phenotype file copied: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/06.gwas/gwas_results/phenotype.txt
2025-11-05 19:56:14,106 - INFO - 步骤2: 转换表型文件 | Step 2: Converting phenotype file
2025-11-05 19:56:14,106 - INFO - 开始转换表型文件 | Starting phenotype file conversion...
2025-11-05 19:56:14,106 - INFO - 表型类型 | Trait type: qualitative
2025-11-05 19:56:14,112 - INFO - 成功读取表型文件 | Successfully read phenotype file: (100, 2)
2025-11-05 19:56:14,112 - INFO - 表型文件列名 | Phenotype file columns: ['sample', 'group']
2025-11-05 19:56:14,112 - INFO - 样本ID列 | Sample ID column: sample
2025-11-05 19:56:14,112 - INFO - 表型值列 | Phenotype column: group
2025-11-05 19:56:14,113 - INFO - 原始表型分布 | Original phenotype distribution: {0: np.int64(50), 1: np.int64(50)}
2025-11-05 19:56:14,113 - INFO - 处理质量性状：将0转换为1（对照），1转换为2（病例） | Processing qualitative trait: converting 0 to 1 (control), 1 to 2 (case)
2025-11-05 19:56:14,113 - INFO - 转换后表型分布 | Converted phenotype distribution: {1: np.int64(50), 2: np.int64(50)}
2025-11-05 19:56:14,114 - INFO - 对照数 (抗病, 原值0) | Controls (resistant, original 0): 50
2025-11-05 19:56:14,114 - INFO - 病例数 (感病, 原值1) | Cases (susceptible, original 1): 50
2025-11-05 19:56:14,117 - INFO - 表型文件转换完成 | Phenotype file conversion completed
2025-11-05 19:56:14,117 - INFO - === 表型转换统计 | Phenotype Conversion Statistics ===
2025-11-05 19:56:14,117 - INFO - 原始表型分布 | Original phenotype distribution:
2025-11-05 19:56:14,117 - INFO -   0: 50
2025-11-05 19:56:14,117 - INFO -   1: 50
2025-11-05 19:56:14,118 - INFO - 转换后表型分布 | Converted phenotype distribution:
2025-11-05 19:56:14,118 - INFO -   1: 50
2025-11-05 19:56:14,118 - INFO -   2: 50
2025-11-05 19:56:14,118 - INFO - 总样本数 | Total samples: 100
2025-11-05 19:56:14,118 - INFO - 原始有效样本数 | Original valid samples: 100
2025-11-05 19:56:14,118 - INFO - 转换后有效样本数 | Converted valid samples: 100
2025-11-05 19:56:14,118 - INFO - 转换后统计 | Post-conversion statistics:
2025-11-05 19:56:14,118 - INFO -   对照组(抗病) | Controls(resistant): 50
2025-11-05 19:56:14,118 - INFO -   病例组(感病) | Cases(susceptible): 50
2025-11-05 19:56:14,118 - INFO -   缺失值 | Missing: 0
2025-11-05 19:56:14,119 - INFO -   病例/对照比例 | Case/control ratio: 1.000
2025-11-05 19:56:14,119 - INFO - 样本量充足 | Sufficient sample size: 最小组有50个样本 | minimum group has 50 samples
2025-11-05 19:56:14,120 - INFO - 转换详情已保存到 phenotype_conversion_debug.txt | Conversion details saved to phenotype_conversion_debug.txt
2025-11-05 19:56:14,120 - INFO - 步骤3: 转换VCF文件 | Step 3: Converting VCF file
2025-11-05 19:56:14,123 - INFO - 转换VCF文件为PLINK格式 | Converting VCF file to PLINK format...
2025-11-05 19:56:14,123 - INFO - 🚀 执行步骤 | Executing step: VCF转换为PLINK格式 | Converting VCF to PLINK format
2025-11-05 19:56:14,123 - INFO - ⚡ 命令 | Command: plink --vcf input.vcf.gz --make-bed --out raw_data --allow-extra-chr --set-missing-var-ids @:# --keep-allele-order
2025-11-05 19:56:14,123 - INFO - 📁 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/06.gwas/gwas_results
2025-11-05 19:56:14,123 - INFO - ============================================================
2025-11-05 19:56:14,123 - INFO - 📋 命令参数详解 | Command Parameter Explanation
2025-11-05 19:56:14,123 - INFO - ============================================================
2025-11-05 19:56:14,123 - INFO -   plink
2025-11-05 19:56:14,123 - INFO -     💡 PLINK v1.9 - 全基因组关联分析工具 | PLINK v1.9 - Genome-wide association analysis tool
2025-11-05 19:56:14,123 - INFO -   --vcf input.vcf.gz
2025-11-05 19:56:14,123 - INFO -     💡 指定VCF格式输入文件 | Specify VCF format input file
2025-11-05 19:56:14,123 - INFO -   --make-bed
2025-11-05 19:56:14,123 - INFO -     💡 生成二进制PLINK文件格式(.bed/.bim/.fam) | Generate binary PLINK format files (.bed/.bim/.fam)
2025-11-05 19:56:14,123 - INFO -   --out raw_data
2025-11-05 19:56:14,123 - INFO -     💡 指定输出文件前缀 | Specify output file prefix
2025-11-05 19:56:14,123 - INFO -   --allow-extra-chr
2025-11-05 19:56:14,123 - INFO -     💡 允许非标准染色体编号 | Allow non-standard chromosome codes
2025-11-05 19:56:14,123 - INFO -   --set-missing-var-ids @:#
2025-11-05 19:56:14,123 - INFO -     💡 为缺失变异ID设置格式(@:#表示chr:pos) | Set format for missing variant IDs (@:# means chr:pos)
2025-11-05 19:56:14,123 - INFO -   --keep-allele-order
2025-11-05 19:56:14,123 - INFO -     💡 保持等位基因顺序不变 | Keep allele order unchanged
2025-11-05 19:56:14,123 - INFO - ============================================================
2025-11-05 19:59:01,687 - INFO - ✅ 完成 | Completed: VCF转换为PLINK格式 | Converting VCF to PLINK format
2025-11-05 19:59:09,485 - INFO - 染色体分布 | Chromosome distribution: {'NC_081823.1': np.int64(826521), 'NC_081822.1': np.int64(824801), 'NC_081809.1': np.int64(799774), 'NC_081811.1': np.int64(781611), 'NC_081817.1': np.int64(771401), 'NC_081813.1': np.int64(753740), 'NC_081805.1': np.int64(742573), 'NC_081820.1': np.int64(722835), 'NC_081818.1': np.int64(695832), 'NC_081816.1': np.int64(664796)}
2025-11-05 19:59:09,485 - INFO - 总SNP数 | Total SNPs: 12697136
2025-11-05 19:59:09,485 - INFO - VCF转换完成 | VCF conversion completed
2025-11-05 19:59:09,671 - INFO - 步骤4: 合并表型信息 | Step 4: Merging phenotype information
2025-11-05 19:59:09,671 - INFO - 合并表型信息 | Merging phenotype information...
2025-11-05 19:59:09,671 - INFO - 🚀 执行步骤 | Executing step: 合并表型信息 | Merging phenotype information
2025-11-05 19:59:09,671 - INFO - ⚡ 命令 | Command: plink --bfile raw_data --pheno phenotype_converted.txt --make-bed --allow-extra-chr --allow-no-sex --out data_with_pheno
2025-11-05 19:59:09,671 - INFO - 📁 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/06.gwas/gwas_results
2025-11-05 19:59:09,672 - INFO - ============================================================
2025-11-05 19:59:09,672 - INFO - 📋 命令参数详解 | Command Parameter Explanation
2025-11-05 19:59:09,672 - INFO - ============================================================
2025-11-05 19:59:09,672 - INFO -   plink
2025-11-05 19:59:09,672 - INFO -     💡 PLINK v1.9 - 全基因组关联分析工具 | PLINK v1.9 - Genome-wide association analysis tool
2025-11-05 19:59:09,672 - INFO -   --bfile raw_data
2025-11-05 19:59:09,672 - INFO -     💡 指定二进制PLINK文件集合的前缀名 | Specify binary PLINK fileset prefix
2025-11-05 19:59:09,672 - INFO -   --pheno phenotype_converted.txt
2025-11-05 19:59:09,672 - INFO -     💡 指定表型文件 | Specify phenotype file
2025-11-05 19:59:09,672 - INFO -   --make-bed
2025-11-05 19:59:09,672 - INFO -     💡 生成二进制PLINK文件格式(.bed/.bim/.fam) | Generate binary PLINK format files (.bed/.bim/.fam)
2025-11-05 19:59:09,672 - INFO -   --allow-extra-chr
2025-11-05 19:59:09,672 - INFO -     💡 允许非标准染色体编号 | Allow non-standard chromosome codes
2025-11-05 19:59:09,672 - INFO -   --allow-no-sex
2025-11-05 19:59:09,672 - INFO -     💡 允许性别信息缺失 | Allow missing sex information
2025-11-05 19:59:09,672 - INFO -   --out data_with_pheno
2025-11-05 19:59:09,672 - INFO -     💡 指定输出文件前缀 | Specify output file prefix
2025-11-05 19:59:09,672 - INFO - ============================================================
2025-11-05 19:59:14,960 - INFO - ✅ 完成 | Completed: 合并表型信息 | Merging phenotype information
2025-11-05 19:59:14,961 - INFO - 合并后样本数 | Samples after merge: 100
2025-11-05 19:59:14,962 - INFO - 表型分布 | Phenotype distribution: {1: np.int64(50), 2: np.int64(50)}
2025-11-05 19:59:14,962 - INFO - 表型合并成功 | Phenotype merging successful
2025-11-05 19:59:14,962 - INFO - 步骤5: 数据质量控制 | Step 5: Data quality control
2025-11-05 19:59:14,962 - INFO - 开始数据质量控制 | Starting data quality control...
2025-11-05 19:59:14,962 - INFO - 计算基本统计 | Calculating basic statistics...
2025-11-05 19:59:14,962 - INFO - 🚀 执行步骤 | Executing step: 计算基本统计 | Calculating basic statistics
2025-11-05 19:59:14,962 - INFO - ⚡ 命令 | Command: plink --bfile data_with_pheno --freq --missing --hardy --allow-extra-chr --allow-no-sex --out qc_stats
2025-11-05 19:59:14,962 - INFO - 📁 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/06.gwas/gwas_results
2025-11-05 19:59:14,962 - INFO - ============================================================
2025-11-05 19:59:14,962 - INFO - 📋 命令参数详解 | Command Parameter Explanation
2025-11-05 19:59:14,962 - INFO - ============================================================
2025-11-05 19:59:14,962 - INFO -   plink
2025-11-05 19:59:14,962 - INFO -     💡 PLINK v1.9 - 全基因组关联分析工具 | PLINK v1.9 - Genome-wide association analysis tool
2025-11-05 19:59:14,962 - INFO -   --bfile data_with_pheno
2025-11-05 19:59:14,962 - INFO -     💡 指定二进制PLINK文件集合的前缀名 | Specify binary PLINK fileset prefix
2025-11-05 19:59:14,962 - INFO -   --freq
2025-11-05 19:59:14,962 - INFO -     💡 计算等位基因频率 | Calculate allele frequencies
2025-11-05 19:59:14,962 - INFO -   --missing
2025-11-05 19:59:14,962 - INFO -     💡 计算缺失率统计 | Calculate missing rate statistics
2025-11-05 19:59:14,962 - INFO -   --hardy
2025-11-05 19:59:14,962 - INFO -     💡 进行Hardy-Weinberg平衡检验 | Perform Hardy-Weinberg equilibrium test
2025-11-05 19:59:14,962 - INFO -   --allow-extra-chr
2025-11-05 19:59:14,962 - INFO -     💡 允许非标准染色体编号 | Allow non-standard chromosome codes
2025-11-05 19:59:14,962 - INFO -   --allow-no-sex
2025-11-05 19:59:14,962 - INFO -     💡 允许性别信息缺失 | Allow missing sex information
2025-11-05 19:59:14,962 - INFO -   --out qc_stats
2025-11-05 19:59:14,963 - INFO -     💡 指定输出文件前缀 | Specify output file prefix
2025-11-05 19:59:14,963 - INFO - ============================================================
2025-11-05 19:59:26,060 - INFO - ✅ 完成 | Completed: 计算基本统计 | Calculating basic statistics
2025-11-05 19:59:26,060 - INFO - 应用质量控制过滤 | Applying quality control filters...
2025-11-05 19:59:26,060 - INFO - 质控参数 | QC parameters: mind=0.9, geno=0.05, maf=0.01, hwe=1e-06
2025-11-05 19:59:26,060 - INFO - 🚀 执行步骤 | Executing step: 质量控制过滤 | Quality control filtering
2025-11-05 19:59:26,060 - INFO - ⚡ 命令 | Command: plink --bfile data_with_pheno --mind 0.9 --geno 0.05 --maf 0.01 --hwe 1e-06 --make-bed --allow-extra-chr --allow-no-sex --out data_qc1
2025-11-05 19:59:26,060 - INFO - 📁 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/06.gwas/gwas_results
2025-11-05 19:59:26,060 - INFO - ============================================================
2025-11-05 19:59:26,060 - INFO - 📋 命令参数详解 | Command Parameter Explanation
2025-11-05 19:59:26,060 - INFO - ============================================================
2025-11-05 19:59:26,060 - INFO -   plink
2025-11-05 19:59:26,060 - INFO -     💡 PLINK v1.9 - 全基因组关联分析工具 | PLINK v1.9 - Genome-wide association analysis tool
2025-11-05 19:59:26,060 - INFO -   --bfile data_with_pheno
2025-11-05 19:59:26,060 - INFO -     💡 指定二进制PLINK文件集合的前缀名 | Specify binary PLINK fileset prefix
2025-11-05 19:59:26,060 - INFO -   --mind 0.9
2025-11-05 19:59:26,060 - INFO -     💡 移除个体缺失率超过阈值的样本 | Remove individuals with missing rate above threshold
2025-11-05 19:59:26,060 - INFO -        📊 移除个体缺失率>90.0%的样本 | Remove samples with missing rate > 90.0%
2025-11-05 19:59:26,060 - INFO -   --geno 0.05
2025-11-05 19:59:26,060 - INFO -     💡 移除SNP缺失率超过阈值的位点 | Remove SNPs with missing rate above threshold
2025-11-05 19:59:26,060 - INFO -        📊 移除SNP缺失率>5.0%的位点 | Remove SNPs with missing rate > 5.0%
2025-11-05 19:59:26,060 - INFO -   --maf 0.01
2025-11-05 19:59:26,060 - INFO -     💡 移除次要等位基因频率低于阈值的SNP | Remove SNPs with minor allele frequency below threshold
2025-11-05 19:59:26,061 - INFO -        📊 移除次要等位基因频率<1.0%的SNP | Remove SNPs with MAF < 1.0%
2025-11-05 19:59:26,061 - INFO -   --hwe 1e-06
2025-11-05 19:59:26,061 - INFO -     💡 移除不符合Hardy-Weinberg平衡的SNP | Remove SNPs failing Hardy-Weinberg equilibrium test
2025-11-05 19:59:26,061 - INFO -        📊 移除HWE检验P值<1e-06的SNP | Remove SNPs with HWE test p-value < 1e-06
2025-11-05 19:59:26,061 - INFO -   --make-bed
2025-11-05 19:59:26,061 - INFO -     💡 生成二进制PLINK文件格式(.bed/.bim/.fam) | Generate binary PLINK format files (.bed/.bim/.fam)
2025-11-05 19:59:26,061 - INFO -   --allow-extra-chr
2025-11-05 19:59:26,061 - INFO -     💡 允许非标准染色体编号 | Allow non-standard chromosome codes
2025-11-05 19:59:26,061 - INFO -   --allow-no-sex
2025-11-05 19:59:26,061 - INFO -     💡 允许性别信息缺失 | Allow missing sex information
2025-11-05 19:59:26,061 - INFO -   --out data_qc1
2025-11-05 19:59:26,061 - INFO -     💡 指定输出文件前缀 | Specify output file prefix
2025-11-05 19:59:26,061 - INFO - ============================================================
2025-11-05 19:59:30,565 - INFO - ✅ 完成 | Completed: 质量控制过滤 | Quality control filtering
2025-11-05 19:59:38,510 - INFO - === 质控统计结果 | QC Statistics Results ===
2025-11-05 19:59:38,511 - INFO - 质控前SNP数 | SNPs before QC: 12697136
2025-11-05 19:59:38,511 - INFO - 质控后SNP数 | SNPs after QC: 1152747
2025-11-05 19:59:38,511 - INFO - 质控前样本数 | Samples before QC: 100
2025-11-05 19:59:38,511 - INFO - 质控后样本数 | Samples after QC: 100
2025-11-05 19:59:38,511 - INFO - 染色体数 | Number of chromosomes: 20
2025-11-05 19:59:38,511 - INFO - 病例数(感病) | Cases(susceptible): 50
2025-11-05 19:59:38,511 - INFO - 对照数(抗病) | Controls(resistant): 50
2025-11-05 19:59:38,511 - INFO - 表型缺失 | Missing phenotype: 0
2025-11-05 19:59:38,511 - INFO - SNP保留率 | SNP retention rate: 9.08%
2025-11-05 19:59:38,511 - INFO - 样本保留率 | Sample retention rate: 100.00%
2025-11-05 19:59:38,715 - INFO - 数据质量控制完成 | Data quality control completed
2025-11-05 19:59:38,716 - INFO - 步骤6: 群体结构分析 | Step 6: Population structure analysis
2025-11-05 19:59:38,716 - INFO - 开始群体结构分析 | Starting population structure analysis...
2025-11-05 19:59:38,716 - INFO - 进行LD剪枝 | Performing LD pruning...
2025-11-05 19:59:38,716 - INFO - 🚀 执行步骤 | Executing step: LD剪枝 | LD pruning
2025-11-05 19:59:38,716 - INFO - ⚡ 命令 | Command: plink --bfile data_qc1 --indep-pairwise 50 5 0.2 --allow-extra-chr --allow-no-sex --out pruned_snps
2025-11-05 19:59:38,716 - INFO - 📁 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/06.gwas/gwas_results
2025-11-05 19:59:38,716 - INFO - ============================================================
2025-11-05 19:59:38,716 - INFO - 📋 命令参数详解 | Command Parameter Explanation
2025-11-05 19:59:38,716 - INFO - ============================================================
2025-11-05 19:59:38,716 - INFO -   plink
2025-11-05 19:59:38,716 - INFO -     💡 PLINK v1.9 - 全基因组关联分析工具 | PLINK v1.9 - Genome-wide association analysis tool
2025-11-05 19:59:38,716 - INFO -   --bfile data_qc1
2025-11-05 19:59:38,716 - INFO -     💡 指定二进制PLINK文件集合的前缀名 | Specify binary PLINK fileset prefix
2025-11-05 19:59:38,716 - INFO -   --indep-pairwise 50
2025-11-05 19:59:38,716 - INFO -     💡 基于成对LD进行SNP剪枝 | Perform SNP pruning based on pairwise LD
2025-11-05 19:59:38,716 - INFO -        📊 窗口大小 | Window size: 50kb
2025-11-05 19:59:38,716 - INFO -        📊 步长 | Step size: 5 SNPs
2025-11-05 19:59:38,716 - INFO -        📊 r²阈值 | r² threshold: 0.2
2025-11-05 19:59:38,716 - INFO -   --allow-extra-chr
2025-11-05 19:59:38,716 - INFO -     💡 允许非标准染色体编号 | Allow non-standard chromosome codes
2025-11-05 19:59:38,716 - INFO -   --allow-no-sex
2025-11-05 19:59:38,716 - INFO -     💡 允许性别信息缺失 | Allow missing sex information
2025-11-05 19:59:38,716 - INFO -   --out pruned_snps
2025-11-05 19:59:38,716 - INFO -     💡 指定输出文件前缀 | Specify output file prefix
2025-11-05 19:59:38,716 - INFO - ============================================================
2025-11-05 19:59:40,160 - INFO - ✅ 完成 | Completed: LD剪枝 | LD pruning
2025-11-05 19:59:40,193 - INFO - LD剪枝后SNP数 | SNPs after LD pruning: 530825
2025-11-05 19:59:40,193 - INFO - 进行主成分分析 | Performing principal component analysis...
2025-11-05 19:59:40,193 - INFO - 🚀 执行步骤 | Executing step: 主成分分析 | Principal component analysis
2025-11-05 19:59:40,193 - INFO - ⚡ 命令 | Command: plink --bfile data_qc1 --extract pruned_snps.prune.in --pca 10 --allow-extra-chr --allow-no-sex --out pca_results
2025-11-05 19:59:40,193 - INFO - 📁 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/06.gwas/gwas_results
2025-11-05 19:59:40,193 - INFO - ============================================================
2025-11-05 19:59:40,193 - INFO - 📋 命令参数详解 | Command Parameter Explanation
2025-11-05 19:59:40,193 - INFO - ============================================================
2025-11-05 19:59:40,193 - INFO -   plink
2025-11-05 19:59:40,193 - INFO -     💡 PLINK v1.9 - 全基因组关联分析工具 | PLINK v1.9 - Genome-wide association analysis tool
2025-11-05 19:59:40,193 - INFO -   --bfile data_qc1
2025-11-05 19:59:40,193 - INFO -     💡 指定二进制PLINK文件集合的前缀名 | Specify binary PLINK fileset prefix
2025-11-05 19:59:40,193 - INFO -   --extract pruned_snps.prune.in
2025-11-05 19:59:40,193 - INFO -     💡 仅保留指定列表中的SNP | Keep only SNPs in specified list
2025-11-05 19:59:40,193 - INFO -   --pca 10
2025-11-05 19:59:40,193 - INFO -     💡 进行主成分分析，指定输出的主成分数量 | Perform PCA, specify number of components to output
2025-11-05 19:59:40,193 - INFO -        📊 将计算前10个主成分 | Will compute top 10 principal components
2025-11-05 19:59:40,193 - INFO -   --allow-extra-chr
2025-11-05 19:59:40,193 - INFO -     💡 允许非标准染色体编号 | Allow non-standard chromosome codes
2025-11-05 19:59:40,193 - INFO -   --allow-no-sex
2025-11-05 19:59:40,193 - INFO -     💡 允许性别信息缺失 | Allow missing sex information
2025-11-05 19:59:40,193 - INFO -   --out pca_results
2025-11-05 19:59:40,193 - INFO -     💡 指定输出文件前缀 | Specify output file prefix
2025-11-05 19:59:40,193 - INFO - ============================================================
2025-11-05 19:59:41,576 - INFO - ✅ 完成 | Completed: 主成分分析 | Principal component analysis
2025-11-05 19:59:41,577 - INFO - 为主成分文件添加header | Adding header to PCA file...
2025-11-05 19:59:41,583 - INFO - 主成分分析完成 | Principal component analysis completed
2025-11-05 19:59:41,584 - INFO - 生成主成分数 | Generated PCs: 10
2025-11-05 19:59:41,584 - INFO - 样本数 | Number of samples: 100
2025-11-05 19:59:41,584 - INFO - 步骤7: 关联分析 | Step 7: Association analysis
2025-11-05 19:59:41,584 - INFO - 开始关联分析 | Starting association analysis...
2025-11-05 19:59:41,584 - INFO - 表型类型 | Trait type: qualitative
2025-11-05 19:59:41,584 - INFO - 遗传模型 | Genetic model: dominant
2025-11-05 19:59:41,584 - INFO - 质量性状关联分析（逻辑回归） | Qualitative trait association analysis (logistic regression)
2025-11-05 19:59:41,584 - INFO - 运行dominant模型分析 | Running dominant model analysis...
2025-11-05 19:59:41,584 - INFO - 基本关联分析（dominant模型，无协变量） | Basic association analysis (dominant model, no covariates)...
2025-11-05 19:59:41,584 - INFO - 🚀 执行步骤 | Executing step: 基本关联分析（dominant模型） | Basic association analysis (dominant model)
2025-11-05 19:59:41,584 - INFO - ⚡ 命令 | Command: plink --bfile data_qc1 --logistic --ci 0.95 --allow-extra-chr --allow-no-sex --out gwas_basic_dominant --dominant
2025-11-05 19:59:41,584 - INFO - 📁 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/06.gwas/gwas_results
2025-11-05 19:59:41,584 - INFO - ============================================================
2025-11-05 19:59:41,584 - INFO - 📋 命令参数详解 | Command Parameter Explanation
2025-11-05 19:59:41,584 - INFO - ============================================================
2025-11-05 19:59:41,584 - INFO -   plink
2025-11-05 19:59:41,584 - INFO -     💡 PLINK v1.9 - 全基因组关联分析工具 | PLINK v1.9 - Genome-wide association analysis tool
2025-11-05 19:59:41,584 - INFO -   --bfile data_qc1
2025-11-05 19:59:41,584 - INFO -     💡 指定二进制PLINK文件集合的前缀名 | Specify binary PLINK fileset prefix
2025-11-05 19:59:41,584 - INFO -   --logistic
2025-11-05 19:59:41,584 - INFO -     💡 进行逻辑回归关联分析（质量性状） | Perform logistic regression association analysis (qualitative traits)
2025-11-05 19:59:41,584 - INFO -   --ci 0.95
2025-11-05 19:59:41,584 - INFO -     💡 计算置信区间（指定置信水平） | Calculate confidence intervals (specify confidence level)
2025-11-05 19:59:41,584 - INFO -        📊 计算95.0%置信区间 | Calculate 95.0% confidence intervals
2025-11-05 19:59:41,584 - INFO -   --allow-extra-chr
2025-11-05 19:59:41,584 - INFO -     💡 允许非标准染色体编号 | Allow non-standard chromosome codes
2025-11-05 19:59:41,584 - INFO -   --allow-no-sex
2025-11-05 19:59:41,584 - INFO -     💡 允许性别信息缺失 | Allow missing sex information
2025-11-05 19:59:41,584 - INFO -   --out gwas_basic_dominant
2025-11-05 19:59:41,584 - INFO -     💡 指定输出文件前缀 | Specify output file prefix
2025-11-05 19:59:41,584 - INFO -   --dominant
2025-11-05 19:59:41,584 - INFO -     💡 使用显性遗传模型 | Use dominant genetic model
2025-11-05 19:59:41,584 - INFO - ============================================================
2025-11-05 19:59:43,889 - INFO - ✅ 完成 | Completed: 基本关联分析（dominant模型） | Basic association analysis (dominant model)
2025-11-05 19:59:43,889 - INFO - 主成分校正关联分析（dominant模型） | PCA-adjusted association analysis (dominant model)...
2025-11-05 19:59:43,889 - INFO - 🚀 执行步骤 | Executing step: 主成分校正关联分析（dominant模型） | PCA-adjusted association analysis (dominant model)
2025-11-05 19:59:43,890 - INFO - ⚡ 命令 | Command: plink --bfile data_qc1 --logistic --covar pca_with_header.txt --covar-name PC1,PC2,PC3,PC4,PC5 --ci 0.95 --allow-extra-chr --allow-no-sex --out gwas_adjusted_dominant --dominant
2025-11-05 19:59:43,890 - INFO - 📁 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/06.gwas/gwas_results
2025-11-05 19:59:43,890 - INFO - ============================================================
2025-11-05 19:59:43,890 - INFO - 📋 命令参数详解 | Command Parameter Explanation
2025-11-05 19:59:43,890 - INFO - ============================================================
2025-11-05 19:59:43,890 - INFO -   plink
2025-11-05 19:59:43,890 - INFO -     💡 PLINK v1.9 - 全基因组关联分析工具 | PLINK v1.9 - Genome-wide association analysis tool
2025-11-05 19:59:43,890 - INFO -   --bfile data_qc1
2025-11-05 19:59:43,890 - INFO -     💡 指定二进制PLINK文件集合的前缀名 | Specify binary PLINK fileset prefix
2025-11-05 19:59:43,890 - INFO -   --logistic
2025-11-05 19:59:43,890 - INFO -     💡 进行逻辑回归关联分析（质量性状） | Perform logistic regression association analysis (qualitative traits)
2025-11-05 19:59:43,890 - INFO -   --covar pca_with_header.txt
2025-11-05 19:59:43,890 - INFO -     💡 指定协变量文件 | Specify covariate file
2025-11-05 19:59:43,890 - INFO -   --covar-name PC1,PC2,PC3,PC4,PC5
2025-11-05 19:59:43,890 - INFO -     💡 指定要使用的协变量名称 | Specify covariate names to use
2025-11-05 19:59:43,890 - INFO -   --ci 0.95
2025-11-05 19:59:43,890 - INFO -     💡 计算置信区间（指定置信水平） | Calculate confidence intervals (specify confidence level)
2025-11-05 19:59:43,890 - INFO -        📊 计算95.0%置信区间 | Calculate 95.0% confidence intervals
2025-11-05 19:59:43,890 - INFO -   --allow-extra-chr
2025-11-05 19:59:43,890 - INFO -     💡 允许非标准染色体编号 | Allow non-standard chromosome codes
2025-11-05 19:59:43,890 - INFO -   --allow-no-sex
2025-11-05 19:59:43,890 - INFO -     💡 允许性别信息缺失 | Allow missing sex information
2025-11-05 19:59:43,890 - INFO -   --out gwas_adjusted_dominant
2025-11-05 19:59:43,890 - INFO -     💡 指定输出文件前缀 | Specify output file prefix
2025-11-05 19:59:43,890 - INFO -   --dominant
2025-11-05 19:59:43,890 - INFO -     💡 使用显性遗传模型 | Use dominant genetic model
2025-11-05 19:59:43,890 - INFO - ============================================================
2025-11-05 19:59:49,650 - INFO - ✅ 完成 | Completed: 主成分校正关联分析（dominant模型） | PCA-adjusted association analysis (dominant model)
2025-11-05 19:59:49,650 - INFO - 主成分校正分析（dominant模型）完成 | PCA-adjusted analysis (dominant model) completed
2025-11-05 19:59:49,650 - INFO - 步骤7: 结果处理 | Step 7: Results processing
2025-11-05 19:59:49,650 - INFO - 🔄 处理分析结果 | Processing analysis results...
2025-11-05 19:59:49,650 - INFO - 📁 主结果文件前缀 | Main result file prefix: gwas_adjusted_dominant
2025-11-05 19:59:49,650 - INFO - 📊 处理dominant模型结果 | Processing dominant model results
2025-11-05 19:59:57,044 - INFO - ✅ 成功读取结果文件 | Successfully read results file: (6916482, 12)
2025-11-05 19:59:57,133 - INFO - 🧹 数据清理：移除了6916374个无效记录 | Data cleaning: removed 6916374 invalid records
2025-11-05 19:59:57,136 - INFO - 📈 对dominant模型应用显著性校正: all | Applying significance corrections for dominant model: all
2025-11-05 19:59:57,136 - INFO - 🎯 dominant模型Bonferroni校正阈值: 4.63e-04 | Bonferroni threshold: 4.63e-04
2025-11-05 19:59:57,136 - INFO - ⭐ dominant模型Bonferroni显著位点数: 0 | Bonferroni significant loci: 0
2025-11-05 19:59:57,137 - INFO - 🎯 dominant模型提示性关联阈值: 1.00e-05 | Suggestive threshold: 1.00e-05
2025-11-05 19:59:57,137 - INFO - 🔍 dominant模型提示性关联位点数: 0 | Suggestive loci: 0
2025-11-05 19:59:57,140 - INFO - 🎯 dominant模型FDR校正q值阈值: 0.05 | FDR q-value threshold: 0.05
2025-11-05 19:59:57,140 - INFO - 📊 dominant模型FDR显著位点数: 0 | FDR significant loci: 0
2025-11-05 19:59:57,142 - INFO - 步骤8: 生成报告 | Step 8: Generating reports
2025-11-05 19:59:57,433 - INFO - 📋 生成总结报告 | Generating summary report...
2025-11-05 19:59:57,435 - INFO - 📄 GWAS总结报告已保存 | GWAS summary report saved: gwas_summary_report.txt
2025-11-05 19:59:57,435 - INFO - 步骤9: 生成可视化 | Step 9: Generating visualizations
2025-11-05 19:59:57,435 - INFO - 📊 生成可视化图表 | Generating visualization plots...
2025-11-05 19:59:57,435 - INFO - --- 正在为 dominant 模型生成图表 | Generating plots for dominant model ---
2025-11-05 19:59:58,290 - INFO - ✅ Manhattan图已保存 | Manhattan plot saved: manhattan_plot_dominant.png
2025-11-05 19:59:58,591 - INFO - ✅ QQ图已保存 | QQ plot saved: qq_plot_dominant.png (λ = 3.7918)
2025-11-05 19:59:58,592 - INFO - ==================================================
2025-11-05 19:59:58,592 - INFO - PLINK GWAS分析完成! | PLINK GWAS analysis completed!

============================================================
PLINK GWAS 分析结果摘要 | Analysis Results Summary
============================================================
遗传模型 | Genetic model: dominant
表型类型 | Trait type: qualitative
质控后样本数 | Samples after QC: 100
质控后SNP数 | SNPs after QC: 1152747
病例数 | Cases: 50
对照数 | Controls: 50

模型结果 | Model Results:
  DOMINANT: 最小P值 | Min P-value = 1.95e-02
            Bonferroni显著位点 | Bonferroni significant: 0
            提示性关联位点 | Suggestive loci: 0

主要输出文件 | Main output files:
  - gwas_summary_report.txt: 总结报告 | Summary report
  - gwas_results_*.txt: 详细关联分析结果 | Detailed association results
============================================================

✅ 分析成功完成! | Analysis completed successfully!
📁 结果保存在: gwas_results | Results saved in: gwas_results
