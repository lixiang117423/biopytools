2026-01-07 08:36:17.257 - INFO - HapHiCå¤„ç†å™¨å·²åˆå§‹åŒ–|HapHiC processor initialized
2026-01-07 08:36:17.257 - INFO - é…ç½®å‚æ•°|Configuration Parameters:
2026-01-07 08:36:17.257 - INFO -   assembly_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/OV53_1.hap1.primary.fa
2026-01-07 08:36:17.257 - INFO -   hic_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/01.data/hic/OV53_1-hic_R1.fastq.gz
2026-01-07 08:36:17.257 - INFO -   hic_file_type: fastq
2026-01-07 08:36:17.257 - INFO -   nchrs: 12
2026-01-07 08:36:17.257 - INFO -   output_dir: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1
2026-01-07 08:36:17.257 - INFO -   prefix: OV53_1.hap1.primary
2026-01-07 08:36:17.257 - INFO -   threads: 64
2026-01-07 08:36:17.257 - INFO -   processes: 8
2026-01-07 08:36:17.257 - INFO -   quick_view: False
2026-01-07 08:36:17.257 - INFO -   restriction_sites: ['GATC']
2026-01-07 08:36:17.257 - INFO -   correct_nrounds: 2
2026-01-07 08:36:17.257 - INFO -   remove_allelic_links: None
2026-01-07 08:36:17.257 - INFO -   phasing_weight: 1.0
2026-01-07 08:36:17.257 - INFO -   gfa_files: None
2026-01-07 08:36:17.257 - INFO -   haphic_bin: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic
2026-01-07 08:36:17.257 - INFO -   bwa_bin: bwa
2026-01-07 08:36:17.257 - INFO -   samtools_bin: samtools
2026-01-07 08:36:17.257 - INFO - å¼€å§‹HapHiCæµç¨‹|Starting HapHiC pipeline
2026-01-07 08:36:17.258 - INFO - ç³»ç»Ÿé¢„æ£€æŸ¥|System pre-flight checks
2026-01-07 08:36:17.258 - INFO - éªŒè¯è¾“å…¥æ–‡ä»¶|Validating input files
2026-01-07 08:36:18.481 - INFO - åŸºå› ç»„åºåˆ—æ•°é‡|Assembly sequence count: 1282
2026-01-07 08:36:18.481 - INFO - FASTQæ–‡ä»¶å¤§å°|FASTQ file sizes: R1 60.14 GB, R2 58.01 GB
2026-01-07 08:36:18.481 - INFO - è¾“å…¥æ–‡ä»¶éªŒè¯é€šè¿‡|Input files validated
2026-01-07 08:36:18.481 - INFO - æ£€æŸ¥ç³»ç»Ÿèµ„æº|Checking system resources
2026-01-07 08:36:18.912 - INFO - å¯ç”¨å†…å­˜|Available memory: 456.5 GB
2026-01-07 08:36:18.912 - INFO - å¯ç”¨ç£ç›˜ç©ºé—´|Available disk space: 1655590.4 GB
2026-01-07 08:36:18.912 - INFO - CPUæ ¸å¿ƒæ•°|CPU cores: 88
2026-01-07 08:36:22.648 - INFO - é¢„æ£€æŸ¥é€šè¿‡|Pre-flight checks passed
2026-01-07 08:36:22.649 - INFO - æ£€æŸ¥å·²å­˜åœ¨çš„æ¯”å¯¹ç»“æœ|Checking for existing alignment results
2026-01-07 08:36:22.649 - INFO - è¾“å‡ºç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1
2026-01-07 08:36:22.649 - INFO - æ¯”å¯¹ç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/00.mapping
2026-01-07 08:36:22.649 - INFO - æ½œåœ¨BAMæ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/00.mapping/HiC.bam
2026-01-07 08:36:22.649 - INFO - æ½œåœ¨è¿‡æ»¤BAMæ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/00.mapping/HiC.filtered.bam
2026-01-07 08:36:22.649 - INFO - æ¯”å¯¹ç›®å½•ä¸å­˜åœ¨|Alignment directory does not exist
2026-01-07 08:36:22.649 - INFO - æ‰§è¡ŒBWAæ¯”å¯¹|Executing BWA alignment
2026-01-07 08:36:22.649 - INFO - ğŸ”— å¼€å§‹BWAæ¯”å¯¹|Starting BWA alignment (official method)
2026-01-07 08:36:22.651 - INFO -  ä½¿ç”¨æä¾›çš„FASTQæ–‡ä»¶å¯¹|Using provided FASTQ pair: OV53_1-hic_R1.fastq.gz
2026-01-07 08:36:22.651 - INFO -  æ‰¾åˆ° 1 å¯¹FASTQæ–‡ä»¶|Found 1 FASTQ pairs
2026-01-07 08:36:22.651 - INFO - ğŸ”— åˆ›å»ºåŸºå› ç»„è½¯é“¾æ¥|Created assembly symlink: assembly.fa
2026-01-07 08:36:22.651 - INFO - ğŸ”— åˆ›å»ºFASTQè½¯é“¾æ¥|Created FASTQ symlinks: read1_1.fastq.gz, read2_1.fastq.gz
2026-01-07 08:36:22.651 - INFO -  åˆ›å»ºBWAç´¢å¼•|Creating BWA index: assembly.fa
2026-01-07 08:54:51.233 - INFO -  BWAç´¢å¼•åˆ›å»ºå®Œæˆ|BWA index created
2026-01-07 08:54:51.234 - INFO - ğŸ”— æ­¥éª¤1: BWAæ¯”å¯¹ + å»é‡ + åˆæ­¥è¿‡æ»¤ (ä½¿ç”¨ 64 çº¿ç¨‹)|Step 1: BWA alignment + deduplication + initial filtering (using 64 threads)
2026-01-07 08:54:51.237 - INFO -  æ‰§è¡ŒBWAæ¯”å¯¹ç®¡é“|Executing BWA alignment pipeline
2026-01-07 19:59:12.819 - INFO -  BWAæ¯”å¯¹å®Œæˆï¼Œç”Ÿæˆ HiC.bam
2026-01-07 19:59:12.876 - INFO -  BAMæ–‡ä»¶å¤§å°: 196407.39 MB
2026-01-07 19:59:12.876 - INFO -  æ­¥éª¤2: HapHiCè¿‡æ»¤|Step 2: HapHiC filtering
2026-01-07 20:35:20.495 - INFO -  HapHiCè¿‡æ»¤å®Œæˆï¼Œç”Ÿæˆ HiC.filtered.bam
2026-01-07 20:35:20.495 - INFO -  è¿‡æ»¤åBAMæ–‡ä»¶å¤§å°: 66018.63 MB
2026-01-07 20:35:20.495 - INFO -  BWAæ¯”å¯¹å®Œæˆ|BWA alignment completed: HiC.filtered.bam
2026-01-07 20:35:20.575 - INFO -  å¼€å§‹HapHiC Pipelineæµç¨‹|Starting HapHiC Pipeline
2026-01-07 20:35:20.575 - INFO -  è®¾ç½®ç›®å½•ç»“æ„|Setting up directory structure
2026-01-07 20:35:20.575 - INFO -  ç›®å½•ç»“æ„è®¾ç½®å®Œæˆ|Directory structure setup complete
2026-01-07 20:35:20.575 - INFO -  æ£€æŸ¥HapHiC Pipelineå®ŒæˆçŠ¶æ€|Checking HapHiC Pipeline completion status
2026-01-07 20:35:20.575 - INFO -  Clusteræ­¥éª¤æœªå®Œæˆ|Cluster step not completed
2026-01-07 20:35:20.575 - INFO -    æœŸå¾…æ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/01.cluster/corrected_asm.fa, /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/01.cluster/paired_links.clm
2026-01-07 20:35:20.575 - INFO -  Reassignæ­¥éª¤æœªå®Œæˆ|Reassign step not completed
2026-01-07 20:35:20.575 - INFO -    æœŸå¾…æ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/02.reassign/final_groups/final_clusters.txt
2026-01-07 20:35:20.575 - INFO -  Sortæ­¥éª¤æœªå®Œæˆ|Sort step not completed
2026-01-07 20:35:20.575 - INFO -    æœŸå¾…æ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/03.sort/*.tour (0 files)
2026-01-07 20:35:20.575 - INFO -  Buildæ­¥éª¤æœªå®Œæˆ|Build step not completed
2026-01-07 20:35:20.575 - INFO -    æœŸå¾…æ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/04.build/OV53_1.hap1.primary.fa, /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/04.build/OV53_1.hap1.primary.agp
2026-01-07 20:35:20.575 - INFO -  è¿è¡ŒHapHiC Pipeline|Running HapHiC Pipeline
2026-01-07 20:35:20.575 - INFO - â„¹ HapHiCå°†å¤„ç†å·²å­˜åœ¨çš„ç›®å½•|HapHiC will handle existing directories
2026-01-07 20:35:20.575 - INFO -  è‡ªåŠ¨ä¼˜åŒ–åˆ†è¾¨ç‡: 500bp (åŸºäºè¦†ç›–ç‡10.0)
2026-01-07 20:35:20.576 - INFO -  å¯ç”¨ç»„è£…æ ¡æ­£ï¼Œä½¿ç”¨åˆ†è¾¨ç‡: 500bp (å†…å­˜ä¼˜åŒ–)
2026-01-07 20:35:20.576 - INFO -  å·¥ä½œç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1
2026-01-07 20:35:20.576 - INFO - HapHiC Pipeline
2026-01-07 21:24:31.084 - INFO - å‘½ä»¤æ‰§è¡ŒæˆåŠŸ|Command executed successfully (è€—æ—¶: 2950.51ç§’)
2026-01-07 21:24:31.095 - INFO - å‘½ä»¤è¾“å‡º|Command Output:
2026-01-07 20:35:51 <HapHiC_pipeline.py> [main] Pipeline started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-07 20:35:51 <HapHiC_pipeline.py> [main] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-07 20:35:51 <HapHiC_pipeline.py> [main] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/OV53_1.hap1.primary.fa /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/00.mapping/HiC.filtered.bam 12 --aln_format bam --outdir /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1 --RE GATC --steps 1,2,3,4 --threads 64 --processes 8 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000 --Nx 80 --RE_site_cutoff 25 --density_lower 0.2X --density_upper 1.9X --read_depth_upper 1.5X --topN 10 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --expansion 2 --max_iter 200 --pruning 0.0001 --min_group_len 0 --max_ctg_len 10000 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --min_density_ratio 4 --ambiguous_cutoff 0.6 --reassign_nrounds 5 --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --Ns 100 --max_width 60 --prefix OV53_1.hap1.primary
2026-01-07 20:35:51 <HapHiC_pipeline.py> [main] The directory /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1 already exists
2026-01-07 20:35:51 <HapHiC_pipeline.py> [haphic_cluster] Step1: Execute preprocessing and Markov clustering for contigs...
2026-01-07 20:35:51 <HapHiC_cluster.py> [run] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-07 20:35:51 <HapHiC_cluster.py> [run] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-07 20:35:51 <HapHiC_cluster.py> [run] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/OV53_1.hap1.primary.fa /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/00.mapping/HiC.filtered.bam 12 --aln_format bam --outdir /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1 --RE GATC --steps 1,2,3,4 --threads 64 --processes 8 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000 --Nx 80 --RE_site_cutoff 25 --density_lower 0.2X --density_upper 1.9X --read_depth_upper 1.5X --topN 10 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --expansion 2 --max_iter 200 --pruning 0.0001 --min_group_len 0 --max_ctg_len 10000 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --min_density_ratio 4 --ambiguous_cutoff 0.6 --reassign_nrounds 5 --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --Ns 100 --max_width 60 --prefix OV53_1.hap1.primary
2026-01-07 20:35:51 <HapHiC_cluster.py> [parse_fasta] Parsing input FASTA file...
2026-01-07 20:35:56 <HapHiC_cluster.py> [determine_int_type] The longest and second longest contigs are 28194490 bp and 15693761 bp, respectively. The data types for contig positions and CLM distances are calculated to be int32 and int32, respectively.
2026-01-07 20:35:56 <HapHiC_cluster.py> [parse_bam_for_correction] Parsing input BAM file for contig correction...
2026-01-07 20:35:56 <HapHiC_cluster.py> [check_sorting_order] The sorting order of the BAM file is unsorted
2026-01-07 20:55:48 <HapHiC_cluster.py> [correct_assembly] Performing assembly correction...
2026-01-07 20:55:58 <HapHiC_cluster.py> [correct_assembly] Correction round 1, breakpoints are detected in 13 contig(s)
2026-01-07 20:55:58 <HapHiC_cluster.py> [break_and_update_ctgs] Breaking contigs and updating data...
2026-01-07 20:55:58 <HapHiC_cluster.py> [correct_assembly] Correction round 2, breakpoints are detected in 0 contig(s)
2026-01-07 20:55:58 <HapHiC_cluster.py> [correct_assembly] Generating corrected assembly file...
2026-01-07 20:55:58 <HapHiC_cluster.py> [correct_assembly] 13 contigs were broken into 26 contigs. Writing corrected assembly to corrected_asm.fa...
2026-01-07 20:55:59 <HapHiC_cluster.py> [stat_fragments] Making some statistics of fragments (contigs / bins)
2026-01-07 20:55:59 <HapHiC_cluster.py> [stat_fragments] bin_size is calculated to be 2000000 bp
2026-01-07 20:56:00 <HapHiC_cluster.py> [parse_alignments] Parsing input alignments...
2026-01-07 20:56:00 <HapHiC_cluster.py> [check_sorting_order] The sorting order of the BAM file is unsorted
2026-01-07 21:20:44 <HapHiC_cluster.py> [output_pickle] Writing HT_link_dict to HT_links.pkl...
2026-01-07 21:20:46 <HapHiC_cluster.py> [output_clm] Writing clm_dict to paired_links.clm...
2026-01-07 21:23:07 <HapHiC_cluster.py> [filter_fragments] Filtering fragments...
2026-01-07 21:23:07 <HapHiC_cluster.py> [filter_fragments] [Nx filtering] 661 fragments kept
2026-01-07 21:23:07 <HapHiC_cluster.py> [filter_fragments] [RE sites filtering] 0 fragments removed, 661 fragments kept
2026-01-07 21:23:07 <HapHiC_cluster.py> [filter_fragments] [link density filtering] Parameter --density_lower 0.2X is set to "multiple" mode and equivalent to 0.02723146747352496 in "fraction" mode
2026-01-07 21:23:07 <HapHiC_cluster.py> [filter_fragments] [link density filtering] Parameter --density_upper 1.9X is set to "multiple" mode and equivalent to 0.9924357034795764 in "fraction" mode
2026-01-07 21:23:07 <HapHiC_cluster.py> [filter_fragments] [link density filtering] 23 fragments removed, 638 fragments kept
2026-01-07 21:23:07 <HapHiC_cluster.py> [filter_fragments] [rank sum filtering] Q1=241.0, median=271.0, Q3=313.0, IQR=Q3-Q1=72.0
2026-01-07 21:23:07 <HapHiC_cluster.py> [filter_fragments] [rank sum filtering] Parameter --rank_sum_upper 1.5X is set to "multiple" mode and equivalent to 0.8793103448275862 in "fraction" mode
2026-01-07 21:23:07 <HapHiC_cluster.py> [filter_fragments] [rank sum filtering] 77 fragments removed, 561 fragments kept
2026-01-07 21:23:07 <HapHiC_cluster.py> [output_pickle] Writing full_link_dict to full_links.pkl...
2026-01-07 21:23:08 <HapHiC_cluster.py> [run] Hi-C linking matrix was constructed in 2837.037414073944s
2026-01-07 21:23:08 <HapHiC_cluster.py> [run_mcl_clustering] Performing Markov clustering...
2026-01-07 21:23:09 <HapHiC_cluster.py> [mcl] The matrix has converged after 5 rounds of iterations (expansion: 2, inflation: 1.0, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-07 21:23:10 <HapHiC_cluster.py> [mcl] The matrix has converged after 47 rounds of iterations (expansion: 2, inflation: 1.2, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-07 21:23:10 <HapHiC_cluster.py> [mcl] The matrix has converged after 25 rounds of iterations (expansion: 2, inflation: 1.4, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-07 21:23:11 <HapHiC_cluster.py> [mcl] The matrix has converged after 17 rounds of iterations (expansion: 2, inflation: 1.6, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-07 21:23:11 <HapHiC_cluster.py> [mcl] The matrix has converged after 21 rounds of iterations (expansion: 2, inflation: 1.8, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-07 21:23:11 <HapHiC_cluster.py> [mcl] The matrix has converged after 19 rounds of iterations (expansion: 2, inflation: 2.0, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-07 21:23:11 <HapHiC_cluster.py> [mcl] The matrix has converged after 13 rounds of iterations (expansion: 2, inflation: 2.2, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-07 21:23:11 <HapHiC_cluster.py> [mcl] The matrix has converged after 14 rounds of iterations (expansion: 2, inflation: 2.4, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-07 21:23:11 <HapHiC_cluster.py> [mcl] The matrix has converged after 13 rounds of iterations (expansion: 2, inflation: 2.6, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-07 21:23:12 <HapHiC_cluster.py> [mcl] The matrix has converged after 11 rounds of iterations (expansion: 2, inflation: 2.8, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-07 21:23:12 <HapHiC_cluster.py> [mcl] The matrix has converged after 10 rounds of iterations (expansion: 2, inflation: 3.0, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-07 21:23:12 <HapHiC_cluster.py> [recommend_inflation] You could try inflation from 2.4 (length ratio = 0.75)
2026-01-07 21:23:12 <HapHiC_cluster.py> [run] 11 round(s) of Markov clustering finished in 3.7090210914611816s, average 0.33718373558738013s per round
2026-01-07 21:23:12 <HapHiC_cluster.py> [output_statistics] Making some statistics for the next HapHiC reassignment step...
2026-01-07 21:23:26 <HapHiC_cluster.py> [run] Program finished in 2854.8116023540497s
2026-01-07 21:23:26 <HapHiC_pipeline.py> [haphic_reassign] Step2: Reassign and rescue contigs...
2026-01-07 21:23:26 <HapHiC_reassign.py> [run] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-07 21:23:26 <HapHiC_reassign.py> [run] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-07 21:23:26 <HapHiC_reassign.py> [run] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/OV53_1.hap1.primary.fa /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/00.mapping/HiC.filtered.bam 12 --aln_format bam --outdir /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1 --RE GATC --steps 1,2,3,4 --threads 64 --processes 8 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000 --Nx 80 --RE_site_cutoff 25 --density_lower 0.2X --density_upper 1.9X --read_depth_upper 1.5X --topN 10 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --expansion 2 --max_iter 200 --pruning 0.0001 --min_group_len 0 --max_ctg_len 10000 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --min_density_ratio 4 --ambiguous_cutoff 0.6 --reassign_nrounds 5 --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --Ns 100 --max_width 60 --prefix OV53_1.hap1.primary
2026-01-07 21:23:26 <HapHiC_cluster.py> [parse_fasta] Parsing input FASTA file...
2026-01-07 21:23:31 <HapHiC_cluster.py> [determine_int_type] The longest and second longest contigs are 28194490 bp and 15693761 bp, respectively. The data types for contig positions and CLM distances are calculated to be int32 and int32, respectively.
2026-01-07 21:23:31 <HapHiC_reassign.py> [parse_pickle] Parsing input pickle file...
2026-01-07 21:23:31 <HapHiC_reassign.py> [parse_clusters] Parsing .clusters.txt file...
2026-01-07 21:23:31 <HapHiC_reassign.py> [run] File parsing and data preparation finished in 5.244901895523071s
2026-01-07 21:23:31 <HapHiC_reassign.py> [run_reassignment] Performing reassignment...
2026-01-07 21:23:32 <HapHiC_reassign.py> [run_reassignment] [result::round1] Total: 1295, consistent: 314, rescued: 524, reassigned: 1, not rescued: 456
2026-01-07 21:23:32 <HapHiC_reassign.py> [run_reassignment] Performing reassignment...
2026-01-07 21:23:32 <HapHiC_reassign.py> [run_reassignment] [result::round2] Total: 1295, consistent: 841, rescued: 18, reassigned: 0, not rescued: 436
2026-01-07 21:23:32 <HapHiC_reassign.py> [run_reassignment] Performing reassignment...
2026-01-07 21:23:32 <HapHiC_reassign.py> [run_reassignment] [result::round3] Total: 1295, consistent: 859, rescued: 1, reassigned: 0, not rescued: 435
2026-01-07 21:23:32 <HapHiC_reassign.py> [run_reassignment] Performing reassignment...
2026-01-07 21:23:32 <HapHiC_reassign.py> [run_reassignment] [result::round4] Total: 1295, consistent: 860, rescued: 0, reassigned: 0, not rescued: 435
2026-01-07 21:23:32 <HapHiC_reassign.py> [run] [result::round4] Result has converged after 3 rounds of reassignment, break
2026-01-07 21:23:32 <HapHiC_reassign.py> [run_reassignment] Performing additional round of rescue...
2026-01-07 21:23:32 <HapHiC_reassign.py> [run_reassignment] [result::additional_rescue] Total: 1295, consistent: 912, rescued: 58, reassigned: 0, not rescued: 325
2026-01-07 21:23:32 <HapHiC_reassign.py> [run] 4 round(s) of reassignment finished in 0.5126116275787354s, average 0.12815290689468384s per round
2026-01-07 21:23:32 <HapHiC_reassign.py> [agglomerative_hierarchical_clustering] Performing additional agglomerative hierarchical clustering...
2026-01-07 21:23:32 <HapHiC_reassign.py> [agglomerative_hierarchical_clustering] The parameter "affinity" is not found in AgglomerativeClustering, use "metric" instead
2026-01-07 21:23:32 <HapHiC_reassign.py> [split_clm_file] Splitting clm file into subfiles by group...
2026-01-07 21:24:00 <HapHiC_reassign.py> [run] Program finished in 34.386695861816406s
2026-01-07 21:24:00 <HapHiC_pipeline.py> [haphic_sort] Step3: Order and orient contigs within each group...
2026-01-07 21:24:16 <HapHiC_sort.py> [run] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-07 21:24:16 <HapHiC_sort.py> [run] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-07 21:24:16 <HapHiC_sort.py> [run] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_sort.py /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/01.cluster/corrected_asm.fa /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/01.cluster/HT_links.pkl /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/02.reassign/split_clms /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/02.reassign/final_groups/group8_98517488bp.txt /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/02.reassign/final_groups/group5_106107708bp.txt /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/02.reassign/final_groups/group2_112463983bp.txt /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/02.reassign/final_groups/group10_94440841bp.txt /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/02.reassign/final_groups/group11_94176419bp.txt /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/02.reassign/final_groups/group4_107843814bp.txt /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/02.reassign/final_groups/group9_96602806bp.txt /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/02.reassign/final_groups/group3_108588022bp.txt /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/02.reassign/final_groups/group12_81571415bp.txt /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/02.reassign/final_groups/group1_151512229bp.txt /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/02.reassign/final_groups/group7_102928947bp.txt /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/02.reassign/final_groups/group6_103040660bp.txt --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --processes 8 --flanking_region 0 --density_cal_method multiplication --confidence_cutoff 1
2026-01-07 21:24:16 <HapHiC_sort.py> [run] Checking the path of ALLHiC...
2026-01-07 21:24:16 <HapHiC_sort.py> [run] ALLHiC has been found in /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts
2026-01-07 21:24:16 <HapHiC_sort.py> [parse_fasta] Parsing fasta file...
2026-01-07 21:24:17 <HapHiC_sort.py> [run] Loading input pickle file...
2026-01-07 21:24:18 <HapHiC_sort.py> [run] Parsing group files and clm files...
2026-01-07 21:24:19 <HapHiC_sort.py> [run] Program will be executed in multiprocessing mode (processes=8)
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group8_98517488bp] Performing fast sorting...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group8_98517488bp] Checking the content of input group file...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group8_98517488bp] Starting fast sorting iterations...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group5_106107708bp] Performing fast sorting...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group5_106107708bp] Checking the content of input group file...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group5_106107708bp] Starting fast sorting iterations...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group10_94440841bp] Performing fast sorting...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group11_94176419bp] Performing fast sorting...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group4_107843814bp] Performing fast sorting...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group10_94440841bp] Checking the content of input group file...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group11_94176419bp] Checking the content of input group file...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group4_107843814bp] Checking the content of input group file...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group10_94440841bp] Starting fast sorting iterations...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group11_94176419bp] Starting fast sorting iterations...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group4_107843814bp] Starting fast sorting iterations...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group2_112463983bp] Performing fast sorting...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group2_112463983bp] Checking the content of input group file...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group2_112463983bp] Starting fast sorting iterations...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group9_96602806bp] Performing fast sorting...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group9_96602806bp] Checking the content of input group file...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group9_96602806bp] Starting fast sorting iterations...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group3_108588022bp] Performing fast sorting...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group3_108588022bp] Checking the content of input group file...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group3_108588022bp] Starting fast sorting iterations...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group12_81571415bp] Performing fast sorting...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group12_81571415bp] Checking the content of input group file...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group12_81571415bp] Starting fast sorting iterations...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group1_151512229bp] Performing fast sorting...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group1_151512229bp] Checking the content of input group file...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group1_151512229bp] Starting fast sorting iterations...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group7_102928947bp] Performing fast sorting...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group7_102928947bp] Checking the content of input group file...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group7_102928947bp] Starting fast sorting iterations...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group6_103040660bp] Performing fast sorting...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group6_103040660bp] Checking the content of input group file...
2026-01-07 21:24:19 <HapHiC_sort.py> [fast_sort] [group6_103040660bp] Starting fast sorting iterations...
2026-01-07 21:24:19 <HapHiC_sort.py> [run] Program finished in 3.2669639587402344s
2026-01-07 21:24:20 <HapHiC_pipeline.py> [haphic_build] Step4: Build final scaffolds (pseudomolecules)...
2026-01-07 21:24:20 <HapHiC_build.py> [run] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-07 21:24:20 <HapHiC_build.py> [run] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-07 21:24:20 <HapHiC_build.py> [run] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/OV53_1.hap1.primary.fa /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/00.mapping/HiC.filtered.bam 12 --aln_format bam --outdir /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1 --RE GATC --steps 1,2,3,4 --threads 64 --processes 8 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000 --Nx 80 --RE_site_cutoff 25 --density_lower 0.2X --density_upper 1.9X --read_depth_upper 1.5X --topN 10 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --expansion 2 --max_iter 200 --pruning 0.0001 --min_group_len 0 --max_ctg_len 10000 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --min_density_ratio 4 --ambiguous_cutoff 0.6 --reassign_nrounds 5 --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --Ns 100 --max_width 60 --prefix OV53_1.hap1.primary
2026-01-07 21:24:20 <HapHiC_cluster.py> [parse_fasta] Parsing input FASTA file...
2026-01-07 21:24:24 <HapHiC_build.py> [parse_tours] Parsing tour files...
2026-01-07 21:24:24 <HapHiC_build.py> [build_final_scaffolds] Building final scaffolds...
2026-01-07 21:24:30 <HapHiC_build.py> [run] Program finished in 9.949743032455444s
2026-01-07 21:24:30 <HapHiC_pipeline.py> [main] HapHiC pipeline finished in 2918.5488755702972s
2026-01-07 21:24:31.129 - INFO -  éªŒè¯Pipelineè¾“å‡º|Verifying pipeline output
2026-01-07 21:24:31.129 - WARNING -  corrected_asmä¸å­˜åœ¨: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/OV53_1.hap1.primary_corrected.asm.fa
2026-01-07 21:24:31.129 - WARNING -  scaffolds_agpä¸å­˜åœ¨: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/OV53_1.hap1.primary_scaffolds.agp
2026-01-07 21:24:31.129 - WARNING -  scaffolds_raw_agpä¸å­˜åœ¨: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/OV53_1.hap1.primary_scaffolds.raw.agp
2026-01-07 21:24:31.129 - WARNING -  scaffolds_fastaä¸å­˜åœ¨: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/OV53_1.hap1.primary_scaffolds.fa
2026-01-07 21:24:31.129 - WARNING -  juicebox_scriptä¸å­˜åœ¨: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/OV53_1.hap1.primary_juicebox.sh
2026-01-07 21:24:31.129 - WARNING -  contact_mapä¸å­˜åœ¨: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/OV53_1.hap1.primary_contact_map.pdf
2026-01-07 21:24:31.180 - WARNING -  hic_fileä¸å­˜åœ¨: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/06.juicebox/OV53_1.hap1.primary.hic
2026-01-07 21:24:31.180 - WARNING -  assembly_fileä¸å­˜åœ¨: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/06.juicebox/OV53_1.hap1.primary.assembly
2026-01-07 21:24:31.180 - INFO -  log_file: OV53_1.hap1.primary_haphic.log (32,592 bytes)
2026-01-07 21:24:31.180 - INFO -  ç”ŸæˆHi-Cæ¥è§¦å›¾å¯è§†åŒ–|Generating Hi-C contact map visualization
2026-01-07 21:24:31.180 - INFO -  ä½¿ç”¨Raw AGPæ–‡ä»¶ï¼ˆæ ¼å¼æ›´æ ‡å‡†ï¼‰: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/04.build/OV53_1.hap1.primary.raw.agp
2026-01-07 21:24:31.182 - INFO -  AGPæ–‡ä»¶é¢„å¤„ç†å®Œæˆ: å…± 2254 è¡Œï¼Œè·³è¿‡ 0 è¡Œï¼Œè¾“å‡ºåˆ° /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/04.build/OV53_1.hap1.primary.raw.processed.agp
2026-01-07 21:24:31.182 - INFO - ç”Ÿæˆå¯è§†åŒ–
2026-01-07 21:24:31.848 - ERROR - å‘½ä»¤æ‰§è¡Œå¤±è´¥|Command failed (è¿”å›ç : 1)
2026-01-07 21:24:31.848 - ERROR - å‘½ä»¤è¾“å‡º|Command Output:
2026-01-07 21:24:31 <HapHiC_plot.py> [main] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-07 21:24:31 <HapHiC_plot.py> [main] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-07 21:24:31 <HapHiC_plot.py> [main] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/OV53_1.hap1.primary.fa /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/04.build/OV53_1.hap1.primary.raw.processed.agp --bin_size 500 --min_len 1
2026-01-07 21:24:31 <HapHiC_plot.py> [parse_agp] Parsing input AGP file...
Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py", line 840, in <module>
    main()
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py", line 808, in main
    ctg_dict, ctg_aln_dict, group_size_dict, frag_set, group_frag_dict = parse_agp(args.agp, bin_size)
                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py", line 60, in parse_agp
    if cols[4] == 'W':
       ~~~~^^^
IndexError: list index out of range
Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic", line 117, in <module>
    subprocess.run(commands, check=True)
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/lib/python3.12/subprocess.py", line 571, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py', '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/OV53_1.hap1.primary.fa', '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/04.build/OV53_1.hap1.primary.raw.processed.agp', '--bin_size', '500', '--min_len', '1']' returned non-zero exit status 1.
2026-01-07 21:24:31.848 - WARNING -  å¯è§†åŒ–ç”Ÿæˆå¤±è´¥ï¼Œä½†ç»§ç»­æ‰§è¡Œå…¶ä»–æ­¥éª¤|Visualization failed, but continuing with other steps
2026-01-07 21:24:31.848 - INFO - ğŸ¥¤ ç”ŸæˆJuiceboxæ–‡ä»¶|Generating Juicebox files
2026-01-07 21:24:31.848 - INFO -  Juiceboxç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/06.juicebox
2026-01-07 21:24:31.849 - INFO - ğŸ¥¤ ä½¿ç”¨Raw AGPæ–‡ä»¶ï¼ˆæ ¼å¼æ›´æ ‡å‡†ï¼‰: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/04.build/OV53_1.hap1.primary.raw.agp
2026-01-07 21:24:31.849 - INFO -  æ­¥éª¤1: ä½¿ç”¨matlockç”Ÿæˆ.mndæ–‡ä»¶|Step 1: Generate .mnd file with matlock
2026-01-07 21:24:31.849 - INFO - ç”Ÿæˆ.mndæ–‡ä»¶
2026-01-07 21:41:50.540 - INFO - å‘½ä»¤æ‰§è¡ŒæˆåŠŸ|Command executed successfully (è€—æ—¶: 1038.69ç§’)
2026-01-07 21:41:50.574 - INFO - å‘½ä»¤è¾“å‡º|Command Output:
INFO: converting bam to juicer on /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/00.mapping/HiC.filtered.bam
INFO: detected bam filetype
INFO: reading file "/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/43.å•å€å‹æŒ‚è½½/hap1/00.mapping/HiC.filtered.bam"
INFO: parsed 1000000 read pairs
INFO: parsed 2000000 read pairs
INFO: parsed 3000000 read pairs
INFO: parsed 4000000 read pairs
INFO: parsed 5000000 read pairs
INFO: parsed 6000000 read pairs
INFO: parsed 7000000 read pairs
INFO: parsed 8000000 read pairs
INFO: parsed 9000000 read pairs
INFO: parsed 10000000 read pairs
INFO: parsed 11000000 read pairs
INFO: parsed 12000000 read pairs
INFO: parsed 13000000 read pairs
INFO: parsed 14000000 read pairs
INFO: parsed 15000000 read pairs
INFO: parsed 16000000 read pairs
INFO: parsed 17000000 read pairs
INFO: parsed 18000000 read pairs
INFO: parsed 19000000 read pairs
INFO: parsed 20000000 read pairs
INFO: parsed 21000000 read pairs
INFO: parsed 22000000 read pairs
INFO: parsed 23000000 read pairs
INFO: parsed 24000000 read pairs
INFO: parsed 25000000 read pairs
INFO: parsed 26000000 read pairs
INFO: parsed 27000000 read pairs
INFO: parsed 28000000 read pairs
INFO: parsed 29000000 read pairs
INFO: parsed 30000000 read pairs
INFO: parsed 31000000 read pairs
INFO: parsed 32000000 read pairs
INFO: parsed 33000000 read pairs
INFO: parsed 34000000 read pairs
INFO: parsed 35000000 read pairs
INFO: parsed 36000000 read pairs
INFO: parsed 37000000 read pairs
INFO: parsed 38000000 read pairs
INFO: parsed 39000000 read pairs
INFO: parsed 40000000 read pairs
INFO: parsed 41000000 read pairs
INFO: parsed 42000000 read pairs
INFO: parsed 43000000 read pairs
INFO: parsed 44000000 read pairs
INFO: parsed 45000000 read pairs
INFO: parsed 46000000 read pairs
INFO: parsed 47000000 read pairs
INFO: parsed 48000000 read pairs
INFO: parsed 49000000 read pairs
INFO: parsed 50000000 read pairs
INFO: parsed 51000000 read pairs
INFO: parsed 52000000 read pairs
INFO: parsed 53000000 read pairs
INFO: parsed 54000000 read pairs
INFO: parsed 55000000 read pairs
INFO: parsed 56000000 read pairs
INFO: parsed 57000000 read pairs
INFO: parsed 58000000 read pairs
INFO: parsed 59000000 read pairs
INFO: parsed 60000000 read pairs
INFO: parsed 61000000 read pairs
INFO: parsed 62000000 read pairs
INFO: parsed 63000000 read pairs
INFO: parsed 64000000 read pairs
INFO: parsed 65000000 read pairs
INFO: parsed 66000000 read pairs
INFO: parsed 67000000 read pairs
INFO: parsed 68000000 read pairs
INFO: parsed 69000000 read pairs
INFO: parsed 70000000 read pairs
INFO: parsed 71000000 read pairs
INFO: parsed 72000000 read pairs
INFO: parsed 73000000 read pairs
INFO: parsed 74000000 read pairs
INFO: parsed 75000000 read pairs
INFO: parsed 76000000 read pairs
INFO: parsed 77000000 read pairs
INFO: parsed 78000000 read pairs
INFO: parsed 79000000 read pairs
INFO: parsed 80000000 read pairs
INFO: parsed 81000000 read pairs
INFO: parsed 82000000 read pairs
INFO: parsed 83000000 read pairs
INFO: parsed 84000000 read pairs
INFO: parsed 85000000 read pairs
INFO: parsed 86000000 read pairs
INFO: parsed 87000000 read pairs
INFO: parsed 88000000 read pairs
INFO: parsed 89000000 read pairs
INFO: parsed 90000000 read pairs
INFO: parsed 91000000 read pairs
INFO: parsed 92000000 read pairs
INFO: parsed 93000000 read pairs
INFO: parsed 94000000 read pairs
INFO: parsed 95000000 read pairs
INFO: parsed 96000000 read pairs
INFO: parsed 97000000 read pairs
INFO: parsed 98000000 read pairs
INFO: parsed 99000000 read pairs
INFO: parsed 100000000 read pairs
INFO: parsed 101000000 read pairs
INFO: parsed 102000000 read pairs
INFO: parsed 103000000 read pairs
INFO: parsed 104000000 read pairs
INFO: parsed 105000000 read pairs
INFO: parsed 106000000 read pairs
INFO: parsed 107000000 read pairs
INFO: parsed 108000000 read pairs
INFO: parsed 109000000 read pairs
INFO: parsed 110000000 read pairs
INFO: parsed 111000000 read pairs
INFO: parsed 112000000 read pairs
INFO: parsed 113000000 read pairs
INFO: parsed 114000000 read pairs
INFO: parsed 115000000 read pairs
INFO: parsed 116000000 read pairs
INFO: parsed 117000000 read pairs
INFO: parsed 118000000 read pairs
INFO: parsed 119000000 read pairs
INFO: parsed 120000000 read pairs
INFO: parsed 121000000 read pairs
INFO: parsed 122000000 read pairs
INFO: parsed 123000000 read pairs
INFO: parsed 124000000 read pairs
INFO: parsed 125000000 read pairs
INFO: parsed 126000000 read pairs
INFO: parsed 127000000 read pairs
INFO: parsed 128000000 read pairs
INFO: parsed 129000000 read pairs
INFO: parsed 130000000 read pairs
INFO: parsed 131000000 read pairs
INFO: parsed 132000000 read pairs
INFO: parsed 133000000 read pairs
INFO: parsed 134000000 read pairs
INFO: parsed 135000000 read pairs
INFO: parsed 136000000 read pairs
INFO: parsed 137000000 read pairs
INFO: parsed 138000000 read pairs
INFO: parsed 139000000 read pairs
INFO: parsed 140000000 read pairs
INFO: parsed 141000000 read pairs
INFO: parsed 142000000 read pairs
INFO: parsed 143000000 read pairs
INFO: parsed 144000000 read pairs
INFO: parsed 145000000 read pairs
INFO: parsed 146000000 read pairs
INFO: parsed 147000000 read pairs
INFO: parsed 148000000 read pairs
INFO: parsed 149000000 read pairs
INFO: parsed 150000000 read pairs
INFO: parsed 151000000 read pairs
INFO: parsed 152000000 read pairs
INFO: parsed 153000000 read pairs
INFO: parsed 154000000 read pairs
INFO: parsed 155000000 read pairs
INFO: parsed 156000000 read pairs
INFO: parsed 157000000 read pairs
INFO: parsed 158000000 read pairs
INFO: parsed 159000000 read pairs
INFO: parsed 160000000 read pairs
INFO: parsed 161000000 read pairs
INFO: parsed 162000000 read pairs
INFO: parsed 163000000 read pairs
INFO: parsed 164000000 read pairs
INFO: parsed 165000000 read pairs
INFO: parsed 166000000 read pairs
INFO: parsed 167000000 read pairs
INFO: parsed 168000000 read pairs
INFO: parsed 169000000 read pairs
INFO: parsed 170000000 read pairs
INFO: parsed 171000000 read pairs
INFO: parsed 172000000 read pairs
INFO: parsed 173000000 read pairs
INFO: parsed 174000000 read pairs
INFO: parsed 175000000 read pairs
INFO: parsed 176000000 read pairs
INFO: parsed 177000000 read pairs
INFO: parsed 178000000 read pairs
INFO: parsed 179000000 read pairs
INFO: parsed 180000000 read pairs
INFO: parsed 181000000 read pairs
INFO: parsed 182000000 read pairs
INFO: parsed 183000000 read pairs
INFO: parsed 184000000 read pairs
INFO: parsed 185000000 read pairs
INFO: parsed 186000000 read pairs
INFO: parsed 187000000 read pairs
INFO: parsed 188000000 read pairs
INFO: parsed 189000000 read pairs
INFO: parsed 190000000 read pairs
INFO: parsed 191000000 read pairs
INFO: parsed 192000000 read pairs
INFO: parsed 193000000 read pairs
INFO: parsed 194000000 read pairs
INFO: parsed 195000000 read pairs
INFO: parsed 196000000 read pairs
INFO: parsed 197000000 read pairs
INFO: parsed 198000000 read pairs
INFO: parsed 199000000 read pairs
INFO: parsed 200000000 read pairs
INFO: parsed 201000000 read pairs
INFO: parsed 202000000 read pairs
INFO: parsed 203000000 read pairs
INFO: parsed 204000000 read pairs
INFO: parsed 205000000 read pairs
INFO: parsed 206000000 read pairs
INFO: parsed 207000000 read pairs
INFO: parsed 208000000 read pairs
INFO: parsed 209000000 read pairs
INFO: parsed 210000000 read pairs
INFO: parsed 211000000 read pairs
INFO: parsed 212000000 read pairs
INFO: parsed 213000000 read pairs
INFO: parsed 214000000 read pairs
INFO: parsed 215000000 read pairs
INFO: parsed 216000000 read pairs
INFO: parsed 217000000 read pairs
INFO: parsed 218000000 read pairs
INFO: parsed 219000000 read pairs
INFO: parsed 220000000 read pairs
INFO: parsed 221000000 read pairs
INFO: parsed 222000000 read pairs
INFO: parsed 223000000 read pairs
INFO: parsed 224000000 read pairs
INFO: parsed 225000000 read pairs
INFO: parsed 226000000 read pairs
INFO: parsed 227000000 read pairs
INFO: parsed 228000000 read pairs
INFO: parsed 229000000 read pairs
INFO: parsed 230000000 read pairs
INFO: parsed 231000000 read pairs
INFO: parsed 232000000 read pairs
INFO: parsed 233000000 read pairs
INFO: parsed 234000000 read pairs
INFO: parsed 235000000 read pairs
INFO: parsed 236000000 read pairs
INFO: parsed 237000000 read pairs
INFO: parsed 238000000 read pairs
INFO: parsed 239000000 read pairs
INFO: parsed 240000000 read pairs
INFO: parsed 241000000 read pairs
INFO: parsed 242000000 read pairs
INFO: parsed 243000000 read pairs
INFO: parsed 244000000 read pairs
INFO: parsed 245000000 read pairs
INFO: parsed 246000000 read pairs
INFO: parsed 247000000 read pairs
INFO: parsed 248000000 read pairs
INFO: parsed 249000000 read pairs
INFO: parsed 250000000 read pairs
INFO: parsed 251000000 read pairs
INFO: parsed 252000000 read pairs
INFO: parsed 253000000 read pairs
INFO: parsed 254000000 read pairs
INFO: parsed 255000000 read pairs
INFO: parsed 256000000 read pairs
INFO: parsed 257000000 read pairs
INFO: parsed 258000000 read pairs
INFO: parsed 259000000 read pairs
INFO: parsed 260000000 read pairs
INFO: parsed 261000000 read pairs
INFO: parsed 262000000 read pairs
INFO: parsed 263000000 read pairs
INFO: parsed 264000000 read pairs
INFO: parsed 265000000 read pairs
INFO: parsed 266000000 read pairs
INFO: parsed 267000000 read pairs
INFO: parsed 268000000 read pairs
INFO: parsed 269000000 read pairs
INFO: parsed 270000000 read pairs
INFO: parsed 271000000 read pairs
INFO: parsed 272000000 read pairs
INFO: parsed 273000000 read pairs
INFO: parsed 274000000 read pairs
INFO: parsed 275000000 read pairs
INFO: parsed 276000000 read pairs
INFO: parsed 277000000 read pairs
INFO: parsed 278000000 read pairs
INFO: parsed 279000000 read pairs
INFO: parsed 280000000 read pairs
INFO: parsed 281000000 read pairs
INFO: parsed 282000000 read pairs
INFO: parsed 283000000 read pairs
INFO: parsed 284000000 read pairs
INFO: parsed 285000000 read pairs
INFO: parsed 286000000 read pairs
INFO: parsed 287000000 read pairs
INFO: parsed 288000000 read pairs
INFO: parsed 289000000 read pairs
INFO: parsed 290000000 read pairs
INFO: parsed 291000000 read pairs
INFO: parsed 292000000 read pairs
INFO: parsed 293000000 read pairs
INFO: parsed 294000000 read pairs
INFO: parsed 295000000 read pairs
INFO: parsed 296000000 read pairs
INFO: parsed 297000000 read pairs
INFO: parsed 298000000 read pairs
INFO: parsed 299000000 read pairs
INFO: parsed 300000000 read pairs
INFO: parsed 301000000 read pairs
INFO: parsed 302000000 read pairs
INFO: parsed 303000000 read pairs
INFO: parsed 304000000 read pairs
INFO: parsed 305000000 read pairs
INFO: parsed 306000000 read pairs
INFO: parsed 307000000 read pairs
INFO: parsed 308000000 read pairs
INFO: parsed 309000000 read pairs
INFO: parsed 310000000 read pairs
INFO: parsed 311000000 read pairs
INFO: parsed 312000000 read pairs
INFO: parsed 313000000 read pairs
INFO: parsed 314000000 read pairs
INFO: parsed 315000000 read pairs
INFO: parsed 316000000 read pairs
INFO: parsed 317000000 read pairs
INFO: parsed 318000000 read pairs
2026-01-07 21:41:50.574 - INFO -  æ­¥éª¤2: æ’åº.mndæ–‡ä»¶|Step 2: Sorting .mnd file
2026-01-07 22:03:24.752 - INFO -  æ­¥éª¤3: ç”Ÿæˆ.assemblyæ–‡ä»¶|Step 3: Generate .assembly file
2026-01-07 22:03:24.783 - INFO - ç”Ÿæˆassemblyæ–‡ä»¶
2026-01-07 22:03:25.132 - INFO - å‘½ä»¤æ‰§è¡ŒæˆåŠŸ|Command executed successfully (è€—æ—¶: 0.35ç§’)
2026-01-07 22:03:25.132 - INFO -  æ­¥éª¤4: ç”Ÿæˆ.hicæ–‡ä»¶|Step 4: Generate .hic file
2026-01-07 22:03:25.132 - INFO - ç”Ÿæˆ.hicæ–‡ä»¶
2026-01-07 22:03:25.134 - ERROR - å‘½ä»¤æ‰§è¡Œå¤±è´¥|Command failed (è¿”å›ç : 127)
2026-01-07 22:03:25.134 - ERROR - å‘½ä»¤è¾“å‡º|Command Output:
bash: ~/software/3d-dna/visualize/run-asm-visualizer.sh: No such file or directory
2026-01-07 22:03:25.134 - WARNING -  Juiceboxæ–‡ä»¶ç”Ÿæˆå¤±è´¥ï¼Œä½†ç»§ç»­æ‰§è¡Œå…¶ä»–æ­¥éª¤|Juicebox file generation failed, but continuing with other steps
2026-01-07 22:03:25.134 - INFO -  HapHiC Pipelineå®Œæˆ|HapHiC Pipeline completed in 5284.56ç§’
2026-01-07 22:03:25.134 - INFO - æ£€æµ‹åˆ°çº é”™åçš„contigï¼Œéœ€è¦é‡æ–°æ¯”å¯¹Hi-Cæ•°æ®|Detected corrected contigs, need to realign Hi-C data
2026-01-07 22:03:25.134 - INFO - å¼€å§‹é‡æ–°æ¯”å¯¹Hi-Cæ•°æ®åˆ°çº é”™åçš„ç»„è£…|Starting Hi-C realignment to corrected assembly
2026-01-07 22:03:25.134 - INFO - ğŸ”— å¼€å§‹BWAæ¯”å¯¹|Starting BWA alignment (official method)
2026-01-07 22:03:25.134 - INFO -  ä½¿ç”¨çº é”™åé‡æ–°æ¯”å¯¹ç›®å½•|Using corrected realignment directory
2026-01-07 22:03:25.135 - INFO -  ä½¿ç”¨æä¾›çš„FASTQæ–‡ä»¶å¯¹|Using provided FASTQ pair: OV53_1-hic_R1.fastq.gz
2026-01-07 22:03:25.135 - INFO -  æ‰¾åˆ° 1 å¯¹FASTQæ–‡ä»¶|Found 1 FASTQ pairs
2026-01-07 22:03:25.135 - INFO - ğŸ”— åˆ›å»ºåŸºå› ç»„è½¯é“¾æ¥|Created assembly symlink: assembly.fa
2026-01-07 22:03:25.135 - INFO - ğŸ”— åˆ›å»ºFASTQè½¯é“¾æ¥|Created FASTQ symlinks: read1_1.fastq.gz, read2_1.fastq.gz
2026-01-07 22:03:25.135 - INFO -  åˆ›å»ºBWAç´¢å¼•|Creating BWA index: assembly.fa
2026-01-07 22:22:53.953 - INFO -  BWAç´¢å¼•åˆ›å»ºå®Œæˆ|BWA index created
2026-01-07 22:22:53.967 - INFO - ğŸ”— æ­¥éª¤1: BWAæ¯”å¯¹ + å»é‡ + åˆæ­¥è¿‡æ»¤ (ä½¿ç”¨ 64 çº¿ç¨‹)|Step 1: BWA alignment + deduplication + initial filtering (using 64 threads)
2026-01-07 22:22:53.967 - INFO -  åˆ›å»ºçº é”™åçš„BAMæ–‡ä»¶|Creating corrected BAM file
2026-01-07 22:22:53.967 - INFO -  æ‰§è¡ŒBWAæ¯”å¯¹ç®¡é“|Executing BWA alignment pipeline
2026-01-08 09:22:40.651 - INFO -  BWAæ¯”å¯¹å®Œæˆï¼Œç”Ÿæˆ HiC.corrected.bam
2026-01-08 09:22:40.652 - INFO -  BAMæ–‡ä»¶å¤§å°: 196406.10 MB
2026-01-08 09:22:40.652 - INFO -  æ­¥éª¤2: HapHiCè¿‡æ»¤|Step 2: HapHiC filtering
2026-01-08 09:22:40.652 - INFO -  åˆ›å»ºçº é”™åçš„è¿‡æ»¤BAMæ–‡ä»¶|Creating corrected filtered BAM file
2026-01-08 09:58:10.437 - INFO -  HapHiCè¿‡æ»¤å®Œæˆï¼Œç”Ÿæˆ HiC.corrected.filtered.bam
2026-01-08 09:58:10.459 - INFO -  è¿‡æ»¤åBAMæ–‡ä»¶å¤§å°: 66019.48 MB
2026-01-08 09:58:10.459 - INFO -  BWAæ¯”å¯¹å®Œæˆ|BWA alignment completed: HiC.corrected.filtered.bam
2026-01-08 09:58:10.497 - INFO - é‡æ–°è¿è¡ŒHapHiCåç»­æ­¥éª¤|Rerunning HapHiC subsequent steps
2026-01-08 09:58:10.497 - ERROR - HapHiCæµç¨‹æ‰§è¡Œå¤±è´¥|HapHiC pipeline execution failed: 'HapHiCPipeline' object has no attribute 'run_step'
