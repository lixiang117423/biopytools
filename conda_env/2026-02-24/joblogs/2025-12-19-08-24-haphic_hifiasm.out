[2025-12-19 08:24:45] ğŸ§¬ HapHiCå¤„ç†å™¨å·²åˆå§‹åŒ– | HapHiC processor initialized
[2025-12-19 08:24:45] âš™ï¸ é…ç½®å‚æ•° | Configuration Parameters:
[2025-12-19 08:24:45]   assembly_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/24.hifi_genome/hifiasm/OV53_1.primary.fasta
[2025-12-19 08:24:45]   hic_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/01.data/hic/OV53_1-hic_R1.fastq.gz
[2025-12-19 08:24:45]   hic_file_type: fastq
[2025-12-19 08:24:45]   nchrs: 12
[2025-12-19 08:24:45]   output_dir: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½
[2025-12-19 08:24:45]   prefix: OV53_1.primary
[2025-12-19 08:24:45]   threads: 64
[2025-12-19 08:24:45]   processes: 64
[2025-12-19 08:24:45]   quick_view: False
[2025-12-19 08:24:45]   restriction_sites: ['GATC']
[2025-12-19 08:24:45]   correct_nrounds: 2
[2025-12-19 08:24:45]   remove_allelic_links: None
[2025-12-19 08:24:45]   phasing_weight: 1.0
[2025-12-19 08:24:45]   gfa_files: None
[2025-12-19 08:24:45]   haphic_bin: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic
[2025-12-19 08:24:45]   bwa_bin: bwa
[2025-12-19 08:24:45]   samtools_bin: samtools
[2025-12-19 08:24:45] ğŸš€ å¼€å§‹HapHiCæµç¨‹ | Starting HapHiC pipeline
[2025-12-19 08:24:45] ğŸ” ç³»ç»Ÿé¢„æ£€æŸ¥ | System pre-flight checks
[2025-12-19 08:24:45] ğŸ” éªŒè¯è¾“å…¥æ–‡ä»¶ | Validating input files
[2025-12-19 08:24:48] ğŸ“Š åŸºå› ç»„åºåˆ—æ•°é‡ | Assembly sequence count: 1455
[2025-12-19 08:24:48] ğŸ“Š FASTQæ–‡ä»¶å¤§å° | FASTQ file sizes: R1 60.14 GB, R2 60.14 GB
[2025-12-19 08:24:48] âœ… è¾“å…¥æ–‡ä»¶éªŒè¯é€šè¿‡ | Input files validated
[2025-12-19 08:24:48] ğŸ–¥ï¸ æ£€æŸ¥ç³»ç»Ÿèµ„æº | Checking system resources
[2025-12-19 08:24:49] ğŸ’¾ å¯ç”¨å†…å­˜ | Available memory: 918.1 GB
[2025-12-19 08:24:49] ğŸ’¾ å¯ç”¨ç£ç›˜ç©ºé—´ | Available disk space: 2616817.9 GB
[2025-12-19 08:24:49] ğŸ–¥ï¸ CPUæ ¸å¿ƒæ•° | CPU cores: 88
[2025-12-19 08:24:50] âœ… é¢„æ£€æŸ¥é€šè¿‡ | Pre-flight checks passed
[2025-12-19 08:24:50] ğŸ” æ£€æŸ¥å·²å­˜åœ¨çš„æ¯”å¯¹ç»“æœ | Checking for existing alignment results
[2025-12-19 08:24:50] ğŸ“‚ è¾“å‡ºç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½
[2025-12-19 08:24:50] ğŸ“‚ æ¯”å¯¹ç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½/00.mapping
[2025-12-19 08:24:50] ğŸ“„ æ½œåœ¨BAMæ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½/00.mapping/HiC.bam
[2025-12-19 08:24:50] ğŸ“„ æ½œåœ¨è¿‡æ»¤BAMæ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½/00.mapping/HiC.filtered.bam
[2025-12-19 08:24:50] âœ… æ¯”å¯¹ç›®å½•å­˜åœ¨ | Alignment directory exists
[2025-12-19 08:24:50] ğŸ“‹ æ¯”å¯¹ç›®å½•å†…å®¹: ['assembly.fa.amb', 'assembly.fa.bwt', 'assembly.fa.ann', 'assembly.fa', 'assembly.fa.pac', 'read1_1.fastq.gz', 'HiC.sorted.bam', 'HiC.sorted.bam.bai', 'HiC.bam.bak', 'HiC.bam', 'assembly.fa.sa', 'read2_1.fastq.gz']
[2025-12-19 08:24:50] âœ… å‘ç°å·²å­˜åœ¨çš„BAMæ–‡ä»¶ï¼Œè·³è¿‡BWAæ¯”å¯¹æ­¥éª¤ | Found existing BAM file, skipping BWA alignment: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½/00.mapping/HiC.bam (93,572,708,225 bytes)
[2025-12-19 08:24:50] âœ… ä½¿ç”¨é‡æ–°æ’åºåçš„BAMæ–‡ä»¶ | Using sorted BAM file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½/00.mapping/HiC.sorted.bam
[2025-12-19 08:24:50] âœ… BAMç´¢å¼•å·²å­˜åœ¨ | BAM index already exists: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½/00.mapping/HiC.sorted.bam.bai
[2025-12-19 08:24:50] ğŸš€ å¼€å§‹HapHiCå®Œæ•´æµç¨‹ | Starting complete HapHiC pipeline
[2025-12-19 08:24:50] ğŸ“ åˆ›å»ºç›®å½•ç»“æ„ | Creating directory structure
[2025-12-19 08:24:50] âœ… ç›®å½•ç»“æ„åˆ›å»ºå®Œæˆ | Directory structure created
[2025-12-19 08:24:50] ğŸ” [æ­¥éª¤1] èšç±»åˆ†æ | [Step 1] Clustering analysis
[2025-12-19 08:24:50] ğŸš€ èšç±»åˆ†æ
[2025-12-19 08:25:20] âŒ å‘½ä»¤æ‰§è¡Œå¤±è´¥ | Command failed (è¿”å›ç : 1)
[2025-12-19 08:25:20] å‘½ä»¤è¾“å‡º | Command Output:
2025-12-19 08:25:09 <HapHiC_cluster.py> [run] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2025-12-19 08:25:09 <HapHiC_cluster.py> [run] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2025-12-19 08:25:09 <HapHiC_cluster.py> [run] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_cluster.py /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/24.hifi_genome/hifiasm/OV53_1.primary.fasta /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½/00.mapping/HiC.sorted.bam 12 --threads 64 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --Nx 80 --RE_site_cutoff 25 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000
2025-12-19 08:25:09 <HapHiC_cluster.py> [detect_format] The file for Hi-C read alignments is detected as being in BAM format
2025-12-19 08:25:09 <HapHiC_cluster.py> [parse_fasta] Parsing input FASTA file...
2025-12-19 08:25:20 <HapHiC_cluster.py> [determine_int_type] The longest and second longest contigs are 28218667 bp and 15710781 bp, respectively. The data types for contig positions and CLM distances are calculated to be int32 and int32, respectively.
2025-12-19 08:25:20 <HapHiC_cluster.py> [parse_bam_for_correction] Parsing input BAM file for contig correction...
2025-12-19 08:25:20 <HapHiC_cluster.py> [check_sorting_order] The sorting order of the BAM file is coordinate. It should be unsorted or name-sorted
Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_cluster.py", line 2971, in <module>
    main()
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_cluster.py", line 2967, in main
    run(args, 'HapHiC_cluster.log')
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_cluster.py", line 2801, in run
    ctg_cov_dict, ctg_link_pos_dict = parse_bam_for_correction(fa_dict, args)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_cluster.py", line 1379, in parse_bam_for_correction
    check_sorting_order(f)
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_cluster.py", line 1357, in check_sorting_order
    raise RuntimeError('The sorting order of the BAM file is {}. It should be unsorted or name-sorted'.format(hd_line['SO']))
RuntimeError: The sorting order of the BAM file is coordinate. It should be unsorted or name-sorted
Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic", line 117, in <module>
    subprocess.run(commands, check=True)
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/lib/python3.12/subprocess.py", line 571, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_cluster.py', '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/24.hifi_genome/hifiasm/OV53_1.primary.fasta', '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/29.çº¯hifiæ•°æ®ç»„è£…çš„åŸºå› ç»„è¿›è¡ŒæŒ‚è½½/00.mapping/HiC.sorted.bam', '12', '--threads', '64', '--min_inflation', '1.0', '--max_inflation', '3.0', '--inflation_step', '0.2', '--Nx', '80', '--RE_site_cutoff', '25', '--correct_nrounds', '2', '--correct_resolution', '500', '--median_cov_ratio', '0.2', '--region_len_ratio', '0.1', '--min_region_cutoff', '5000']' returned non-zero exit status 1.
[2025-12-19 08:25:20] ğŸ“Š å¤„ç†ç»Ÿè®¡ | Processing Statistics:
[2025-12-19 08:25:20]   â±ï¸ æ€»è€—æ—¶ | Total time: 35.04ç§’
[2025-12-19 08:25:20]   ğŸ“„ log_file: OV53_1.primary_haphic.log (17,431 bytes)
