2025-11-14 13:20:22,670 - INFO - ğŸš€ å¼€å§‹GATK Joint Genotypingæµç¨‹ | Starting GATK Joint Genotyping pipeline
2025-11-14 13:20:22,671 - INFO - ğŸ“‚ è¾“å…¥ç›®å½• | Input directory: /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/02.mapping/vcf
2025-11-14 13:20:22,671 - INFO - ğŸ§¬ å‚è€ƒåŸºå› ç»„ | Reference genome: /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/01.data/genome/Phytophthora_sojae_JS2.fa
2025-11-14 13:20:22,671 - INFO - ğŸ“ è¾“å‡ºç›®å½• | Output directory: /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/03.gatk_joint
2025-11-14 13:20:22,671 - INFO - ğŸ” æ£€æŸ¥ä¾èµ–è½¯ä»¶ | Checking dependencies
2025-11-14 13:20:25,199 - INFO - âœ… GATK å¯ç”¨ | available
2025-11-14 13:20:25,684 - INFO - âœ… BCFtools å¯ç”¨ | available
2025-11-14 13:20:25,684 - INFO - ================================================================================
2025-11-14 13:20:25,684 - INFO - æ­¥éª¤1: æ£€æµ‹è¾“å…¥æ–‡ä»¶ç±»å‹ | Step 1: Detect input file type
2025-11-14 13:20:25,684 - INFO - ================================================================================
2025-11-14 13:20:25,684 - INFO - ğŸ” æ£€æµ‹è¾“å…¥æ–‡ä»¶ç±»å‹ | Detecting input file type
2025-11-14 13:20:25,697 - INFO - âœ… æ£€æµ‹åˆ°GVCFæ–‡ä»¶ | Detected GVCF files: 420 files
2025-11-14 13:20:25,697 - INFO - ğŸ“Š å…±æ‰¾åˆ° 420 ä¸ªæ–‡ä»¶ | Total 420 files found
2025-11-14 13:20:25,698 - INFO - ğŸ“ åˆ›å»ºæ ·æœ¬æ˜ å°„æ–‡ä»¶ | Creating sample map file
2025-11-14 13:20:25,701 - INFO - âœ… æ ·æœ¬æ˜ å°„æ–‡ä»¶å·²åˆ›å»º | Sample map created: /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/03.gatk_joint/sample_map.txt
2025-11-14 13:20:25,701 - INFO - ================================================================================
2025-11-14 13:20:25,701 - INFO - æ­¥éª¤2: GenomicsDBå¯¼å…¥ | Step 2: GenomicsDB import
2025-11-14 13:20:25,701 - INFO - ================================================================================
2025-11-14 13:20:25,701 - INFO - ğŸ“¦ å¼€å§‹GenomicsDBå¯¼å…¥ | Starting GenomicsDB import
2025-11-14 13:20:25,701 - INFO - âš ï¸ æœªæŒ‡å®šåŒºé—´ï¼Œè‡ªåŠ¨ä»å‚è€ƒåŸºå› ç»„æå– | No intervals specified, extracting from reference
2025-11-14 13:20:25,701 - INFO - ğŸ“ å‚è€ƒåŸºå› ç»„ | Reference: /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/01.data/genome/Phytophthora_sojae_JS2.fa
2025-11-14 13:20:25,701 - INFO - ğŸ“ å­—å…¸æ–‡ä»¶è·¯å¾„ | Dict path: /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/01.data/genome/Phytophthora_sojae_JS2.dict
2025-11-14 13:20:25,701 - INFO - ğŸ“ ç´¢å¼•æ–‡ä»¶è·¯å¾„ | Fai path: /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/01.data/genome/Phytophthora_sojae_JS2.fa.fai
2025-11-14 13:20:25,746 - INFO - âœ… ä½¿ç”¨å­—å…¸æ–‡ä»¶ | Using dict file: /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/01.data/genome/Phytophthora_sojae_JS2.dict
2025-11-14 13:20:25,747 - INFO - âœ… ç”ŸæˆåŒºé—´æ–‡ä»¶ | Generated intervals: 12 chromosomes
2025-11-14 13:20:25,747 - INFO - ğŸ“„ åŒºé—´æ–‡ä»¶ä½ç½® | Intervals file: /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/03.gatk_joint/intervals.list
2025-11-14 13:20:25,747 - INFO - ğŸš€ æ‰§è¡Œæ­¥éª¤ | Executing step: GenomicsDBå¯¼å…¥ | GenomicsDB import
2025-11-14 13:20:25,747 - INFO - ğŸ’» å‘½ä»¤ | Command: gatk --java-options '-Xmx100g' GenomicsDBImport --genomicsdb-workspace-path /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/03.gatk_joint/genomicsdb_workspace --sample-name-map /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/03.gatk_joint/sample_map.txt --reader-threads 88 -L /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/03.gatk_joint/intervals.list
2025-11-14 13:20:25,747 - INFO - ğŸ“ å·¥ä½œç›®å½• | Working directory: /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/03.gatk_joint
2025-11-14 13:21:03,532 - ERROR - âŒ å‘½ä»¤æ‰§è¡Œå¤±è´¥ | Command execution failed: GenomicsDBå¯¼å…¥ | GenomicsDB import
2025-11-14 13:21:03,532 - ERROR - ğŸ”¢ é”™è¯¯ä»£ç  | Error code: 3
2025-11-14 13:21:03,532 - ERROR - ğŸ“› é”™è¯¯ä¿¡æ¯ | Error message: 13:20:27.141 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/share/org/YZWL/yzwl_lixg/miniforge3/envs/GATK_v.4.6.2.0/share/gatk4-4.6.2.0-0/gatk-package-4.6.2.0-local.jar!/com/intel/gkl/native/libgkl_compression.so
13:20:27.364 INFO  GenomicsDBImport - ------------------------------------------------------------
13:20:27.366 INFO  GenomicsDBImport - The Genome Analysis Toolkit (GATK) v4.6.2.0
13:20:27.366 INFO  GenomicsDBImport - For support and documentation go to https://software.broadinstitute.org/gatk/
13:20:27.366 INFO  GenomicsDBImport - Executing as yzwl_lixg@c01n0533 on Linux v4.18.0-513.5.1.el8_9.x86_64 amd64
13:20:27.366 INFO  GenomicsDBImport - Java runtime: OpenJDK 64-Bit Server VM v17.0.15-internal+0-adhoc..src
13:20:27.366 INFO  GenomicsDBImport - Start Date/Time: 2025å¹´11æœˆ14æ—¥ CST ä¸‹åˆ1:20:27
13:20:27.366 INFO  GenomicsDBImport - ------------------------------------------------------------
13:20:27.366 INFO  GenomicsDBImport - ------------------------------------------------------------
13:20:27.367 INFO  GenomicsDBImport - HTSJDK Version: 4.2.0
13:20:27.367 INFO  GenomicsDBImport - Picard Version: 3.4.0
13:20:27.367 INFO  GenomicsDBImport - Built for Spark Version: 3.5.0
13:20:27.368 INFO  GenomicsDBImport - HTSJDK Defaults.COMPRESSION_LEVEL : 2
13:20:27.369 INFO  GenomicsDBImport - HTSJDK Defaults.USE_ASYNC_IO_READ_FOR_SAMTOOLS : false
13:20:27.369 INFO  GenomicsDBImport - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_SAMTOOLS : true
13:20:27.369 INFO  GenomicsDBImport - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_TRIBBLE : false
13:20:27.369 INFO  GenomicsDBImport - Deflater: IntelDeflater
13:20:27.369 INFO  GenomicsDBImport - Inflater: IntelInflater
13:20:27.369 INFO  GenomicsDBImport - GCS max retries/reopens: 20
13:20:27.369 INFO  GenomicsDBImport - Requester pays: disabled
13:20:27.369 INFO  GenomicsDBImport - Initializing engine
13:20:27.567 INFO  IntervalArgumentCollection - Processing 85131815 bp from intervals
13:20:27.568 INFO  GenomicsDBImport - Done initializing engine
13:20:27.780 INFO  GenomicsDBLibLoader - GenomicsDB native library version : 1.5.5-addd795
13:20:27.810 INFO  GenomicsDBImport - Vid Map JSON file will be written to /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/03.gatk_joint/genomicsdb_workspace/vidmap.json
13:20:27.810 INFO  GenomicsDBImport - Callset Map JSON file will be written to /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/03.gatk_joint/genomicsdb_workspace/callset.json
13:20:27.810 INFO  GenomicsDBImport - Complete VCF Header will be written to /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/03.gatk_joint/genomicsdb_workspace/vcfheader.vcf
13:20:27.810 INFO  GenomicsDBImport - Importing to workspace - /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/03.gatk_joint/genomicsdb_workspace
13:20:27.810 WARN  GenomicsDBImport - GenomicsDBImport cannot use multiple VCF reader threads for initialization when the number of intervals is greater than 1. Falling back to serial VCF reader initialization.
13:21:03.293 INFO  GenomicsDBImport - Importing batch 1 with 420 samples
13:21:03.491 INFO  GenomicsDBImport - Shutting down engine
[2025å¹´11æœˆ14æ—¥ CST ä¸‹åˆ1:21:03] org.broadinstitute.hellbender.tools.genomicsdb.GenomicsDBImport done. Elapsed time: 0.61 minutes.
Runtime.totalMemory()=2046820352
htsjdk.samtools.SAMFormatException: Invalid GZIP header
	at htsjdk.samtools.util.BlockGunzipper.unzipBlock(BlockGunzipper.java:121)
	at htsjdk.samtools.util.BlockGunzipper.unzipBlock(BlockGunzipper.java:96)
	at htsjdk.samtools.util.BlockCompressedInputStream.inflateBlock(BlockCompressedInputStream.java:561)
	at htsjdk.samtools.util.BlockCompressedInputStream.processNextBlock(BlockCompressedInputStream.java:543)
	at htsjdk.samtools.util.BlockCompressedInputStream.nextBlock(BlockCompressedInputStream.java:479)
	at htsjdk.samtools.util.BlockCompressedInputStream.seek(BlockCompressedInputStream.java:391)
	at htsjdk.tribble.readers.TabixReader$IteratorImpl.next(TabixReader.java:427)
	at htsjdk.tribble.readers.TabixIteratorLineReader.readLine(TabixIteratorLineReader.java:46)
	at htsjdk.tribble.TabixFeatureReader$FeatureIterator.readNextRecord(TabixFeatureReader.java:170)
	at htsjdk.tribble.TabixFeatureReader$FeatureIterator.<init>(TabixFeatureReader.java:159)
	at htsjdk.tribble.TabixFeatureReader.query(TabixFeatureReader.java:133)
	at org.broadinstitute.hellbender.tools.genomicsdb.GenomicsDBImport$1.query(GenomicsDBImport.java:1016)
	at org.genomicsdb.importer.GenomicsDBImporter.<init>(GenomicsDBImporter.java:151)
	at org.genomicsdb.importer.GenomicsDBImporter.lambda$iterateOverChromosomeIntervals$4(GenomicsDBImporter.java:714)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1768)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Using GATK jar /share/org/YZWL/yzwl_lixg/miniforge3/envs/GATK_v.4.6.2.0/share/gatk4-4.6.2.0-0/gatk-package-4.6.2.0-local.jar
Running:
    java -Dsamjdk.use_async_io_read_samtools=false -Dsamjdk.use_async_io_write_samtools=true -Dsamjdk.use_async_io_write_tribble=false -Dsamjdk.compression_level=2 -Xmx100g -jar /share/org/YZWL/yzwl_lixg/miniforge3/envs/GATK_v.4.6.2.0/share/gatk4-4.6.2.0-0/gatk-package-4.6.2.0-local.jar GenomicsDBImport --genomicsdb-workspace-path /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/03.gatk_joint/genomicsdb_workspace --sample-name-map /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/03.gatk_joint/sample_map.txt --reader-threads 88 -L /share/org/YZWL/yzwl_lixg/project/19.å¤§è±†ç–«éœ‰èŒ/03.gatk_joint/intervals.list

2025-11-14 13:21:03,535 - ERROR - âŒ åˆ†ææµç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ„å¤–ç»ˆæ­¢ | Analysis pipeline terminated unexpectedly: âŒ GenomicsDBå¯¼å…¥å¤±è´¥ | GenomicsDB import failed
