ğŸ“ Log file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap2/logs/allhic_20251210_145452.log

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”§ Setting up environment
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-10 14:55:02] Checking required tools...
[2025-12-10 14:55:02] âœ… Environment ready
[2025-12-10 14:55:02] Working directory: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap2
[2025-12-10 14:55:02] Threads: 88
[2025-12-10 14:55:02] Memory: 800G
[2025-12-10 14:55:02] Chromosomes: 12
[2025-12-10 14:55:02] Enzyme: GATC
[2025-12-10 14:55:02] â±ï¸  Step completed in 10s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸš€ Starting ALLHiC Pipeline v4.1
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”— [Step 0] Preparing input data
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-10 14:55:02] âœ… Input files linked
[2025-12-10 14:55:02] â±ï¸  Step completed in 0s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ” [Step 1] Mapping Hi-C reads
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-10 14:55:02] Building BWA index...
[2025-12-10 14:55:02] â–¶ï¸  bwa index draft.asm.fasta
[bwa_index] Pack FASTA... 4.70 sec
[bwa_index] Construct BWT for the packed sequence...
[BWTIncCreate] textLength=2335407576, availableWord=176327648
[BWTIncConstructFromPacked] 10 iterations done. 99999992 characters processed.
[BWTIncConstructFromPacked] 20 iterations done. 199999992 characters processed.
[BWTIncConstructFromPacked] 30 iterations done. 299999992 characters processed.
[BWTIncConstructFromPacked] 40 iterations done. 399999992 characters processed.
[BWTIncConstructFromPacked] 50 iterations done. 499999992 characters processed.
[BWTIncConstructFromPacked] 60 iterations done. 599999992 characters processed.
[BWTIncConstructFromPacked] 70 iterations done. 699999992 characters processed.
[BWTIncConstructFromPacked] 80 iterations done. 799999992 characters processed.
[BWTIncConstructFromPacked] 90 iterations done. 899999992 characters processed.
[BWTIncConstructFromPacked] 100 iterations done. 999999992 characters processed.
[BWTIncConstructFromPacked] 110 iterations done. 1099999992 characters processed.
[BWTIncConstructFromPacked] 120 iterations done. 1199999992 characters processed.
[BWTIncConstructFromPacked] 130 iterations done. 1299999992 characters processed.
[BWTIncConstructFromPacked] 140 iterations done. 1399999992 characters processed.
[BWTIncConstructFromPacked] 150 iterations done. 1499999992 characters processed.
[BWTIncConstructFromPacked] 160 iterations done. 1599999992 characters processed.
[BWTIncConstructFromPacked] 170 iterations done. 1699018184 characters processed.
[BWTIncConstructFromPacked] 180 iterations done. 1788878600 characters processed.
[BWTIncConstructFromPacked] 190 iterations done. 1868742760 characters processed.
[BWTIncConstructFromPacked] 200 iterations done. 1939722280 characters processed.
[BWTIncConstructFromPacked] 210 iterations done. 2002805000 characters processed.
[BWTIncConstructFromPacked] 220 iterations done. 2058869064 characters processed.
[BWTIncConstructFromPacked] 230 iterations done. 2108694936 characters processed.
[BWTIncConstructFromPacked] 240 iterations done. 2152976296 characters processed.
[BWTIncConstructFromPacked] 250 iterations done. 2192329640 characters processed.
[BWTIncConstructFromPacked] 260 iterations done. 2227302952 characters processed.
[BWTIncConstructFromPacked] 270 iterations done. 2258383320 characters processed.
[BWTIncConstructFromPacked] 280 iterations done. 2286003576 characters processed.
[BWTIncConstructFromPacked] 290 iterations done. 2310548504 characters processed.
[BWTIncConstructFromPacked] 300 iterations done. 2332360088 characters processed.
[bwt_gen] Finished constructing BWT in 302 iterations.
[bwa_index] 646.15 seconds elapse.
[bwa_index] Update BWT... 4.40 sec
[bwa_index] Pack forward-only FASTA... 2.81 sec
[bwa_index] Construct SA from BWT and Occ... 285.62 sec
[main] Version: 0.7.19-r1273
[main] CMD: bwa index draft.asm.fasta
[main] Real time: 945.905 sec; CPU: 943.681 sec
[2025-12-10 15:10:48] Building samtools index...
[2025-12-10 15:10:48] â–¶ï¸  samtools faidx draft.asm.fasta
[2025-12-10 15:10:52] Running BWA MEM alignment...
[2025-12-10 15:10:52] â–¶ï¸  bwa mem -t 88 -5SP draft.asm.fasta reads_R1.fastq.gz reads_R2.fastq.gz 2>logs/bwa_mapping.log |              samtools view -@ 88 -hF 2316 -q 30 - |              samtools sort -@ 88 -n -o sample.clean.bam -
[bam_sort_core] merging from 4 files and 88 in-memory blocks...
[2025-12-10 23:30:42] âœ… Mapping completed
[2025-12-10 23:30:42] â±ï¸  Step completed in 8h 35m 40s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ§¬ [Step 1.5] Allele detection
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-10 23:30:42] â–¶ï¸  allhic extract sample.clean.bam draft.asm.fasta --RE GATC
[32m23:30:44 writeRE | NOTICE [0m RE counts in 972 contigs (total: 5973850, avg 1 per 195 bp) written to `sample.clean.counts_GATC.txt`
[32m23:30:44 extractContigLinks | NOTICE [0m Parse bamfile `sample.clean.bam`
[32m23:43:03 extractContigLinks | NOTICE [0m Extracted 942 intra-contig link groups (total = 43657032)
[32m23:48:10 extractContigLinks | NOTICE [0m Extracted 462775 inter-contig groups to `sample.clean.clm` (total = 1543990172, maxLinks = 427971, minLinks = 3)
[32m23:48:12 fitPowerLaw | NOTICE [0m Power law Y = 0.000243 * X ^ -0.7137
[32m23:48:12 writeDistribution | NOTICE [0m Link size distribution written to `sample.clean.distribution.txt`
[32m23:48:12 readClmLines | NOTICE [0m Parse clmfile `sample.clean.clm`
[32m23:49:12 calcInterContigs | NOTICE [0m Contig pair analyses written to `sample.clean.pairs.txt`
[32m23:49:12 Run | NOTICE [0m Success
[2025-12-10 23:49:13] â–¶ï¸  minimap2 -DP -k19 -w19 -m200 -t 88 draft.asm.fasta draft.asm.fasta 2>logs/minimap2.log > draft.asm.paf
[2025-12-11 00:01:52] â–¶ï¸  allhic alleles draft.asm.paf sample.clean.counts_GATC.txt > alleles.table
[32m00:01:52 ParseRecords | NOTICE [0m Parse paffile `draft.asm.paf`
[32m00:03:40 ReadCSVLines | NOTICE [0m Parse csvfile `sample.clean.counts_GATC.txt`
[32m00:03:40 Run | NOTICE [0m Success
[2025-12-11 00:03:41] âœ… Allele detection completed
[2025-12-11 00:03:41] â±ï¸  Step completed in 32m 59s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ‚ï¸  [Step 2] Pruning chimeric contigs
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 00:03:41] âš ï¸  No allele table found, using original BAM
[2025-12-11 00:03:41] âœ… Pruning completed
[2025-12-11 00:03:41] â±ï¸  Step completed in 0s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“¦ [Step 3] Partitioning contigs
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 00:03:41] â–¶ï¸  ALLHiC_partition -b prunning.bam -r draft.asm.fasta -e GATC -k 12
Extract function: calculate an empirical distribution of Hi-C link size based on intra-contig links
CMD: allhic extract prunning.bam draft.asm.fasta --RE GATC
[32m00:03:42 writeRE | NOTICE [0m RE counts in 972 contigs (total: 5973850, avg 1 per 195 bp) written to `prunning.counts_GATC.txt`
[32m00:03:42 extractContigLinks | NOTICE [0m Parse bamfile `prunning.bam`
[32m00:16:00 extractContigLinks | NOTICE [0m Extracted 942 intra-contig link groups (total = 43657032)
[32m00:21:09 extractContigLinks | NOTICE [0m Extracted 462775 inter-contig groups to `prunning.clm` (total = 1543990172, maxLinks = 427971, minLinks = 3)
[32m00:21:10 fitPowerLaw | NOTICE [0m Power law Y = 0.000243 * X ^ -0.7137
[32m00:21:10 writeDistribution | NOTICE [0m Link size distribution written to `prunning.distribution.txt`
[32m00:21:10 readClmLines | NOTICE [0m Parse clmfile `prunning.clm`
[32m00:22:10 calcInterContigs | NOTICE [0m Contig pair analyses written to `prunning.pairs.txt`
[32m00:22:10 Run | NOTICE [0m Success
Partition contigs based on prunning bam file
CMD: allhic partition prunning.counts_GATC.txt prunning.pairs.txt 12 --minREs 25
[32m00:22:10 ReadCSVLines | NOTICE [0m Parse csvfile `prunning.counts_GATC.txt`
[32m00:22:10 readRE | NOTICE [0m Loaded 972 contig RE lengths for normalization from `prunning.counts_GATC.txt`
[32m00:22:10 skipContigsWithFewREs | NOTICE [0m skipContigsWithFewREs with MinREs = 25 (RE = GATC)
[32m00:22:10 skipContigsWithFewREs | NOTICE [0m Marked 0 contigs (avg 0.0 RE sites, len 0) since they contain too few REs (MinREs = 25)
[32m00:22:10 ReadCSVLines | NOTICE [0m Parse csvfile `prunning.pairs.txt`
[32m00:22:11 skipRepeats | NOTICE [0m skipRepeats with multiplicity = 2
Contig #333 (h2tg000334c) has 6.1x the average number of Hi-C links -> MARKED REPETITIVE
Contig #709 (h2tg000710l) has 7.0x the average number of Hi-C links -> MARKED REPETITIVE
Contig #848 (h2tg000849l) has 9.3x the average number of Hi-C links -> MARKED REPETITIVE
Contig #935 (h2tg000936l) has 2.1x the average number of Hi-C links -> MARKED REPETITIVE
Contig #941 (h2tg000942l) has 2.3x the average number of Hi-C links -> MARKED REPETITIVE
Contig #942 (h2tg000943l) has 3.8x the average number of Hi-C links -> MARKED REPETITIVE
Contig #954 (h2tg000955l) has 2.4x the average number of Hi-C links -> MARKED REPETITIVE
Contig #968 (h2tg000969l) has 2.3x the average number of Hi-C links -> MARKED REPETITIVE
[32m00:22:11 skipRepeats | NOTICE [0m Marked 8 contigs (avg len 103017) as repetitive (MaxLinkDensity = 2)
[32m00:22:11 Cluster | NOTICE [0m Clustering starts with 972 (964 informative) contigs with target of 12 clusters
[32m00:22:11 Cluster | NOTICE [0m Merge #50: Clusters	178 + 827 -> 1021, Linkage = 2.982113e+07
[32m00:22:12 Cluster | NOTICE [0m Merge #100: Clusters	631 + 757 -> 1071, Linkage = 2.2516097e+07
[32m00:22:12 Cluster | NOTICE [0m Merge #150: Clusters	582 + 973 -> 1121, Linkage = 1.7550652e+07
[32m00:22:13 Cluster | NOTICE [0m Merge #200: Clusters	1012 + 1113 -> 1171, Linkage = 1.4722997e+07
[32m00:22:13 Cluster | NOTICE [0m Merge #250: Clusters	681 + 816 -> 1221, Linkage = 1.2797556e+07
[32m00:22:13 Cluster | NOTICE [0m Merge #300: Clusters	555 + 658 -> 1271, Linkage = 1.1259582e+07
[32m00:22:14 Cluster | NOTICE [0m Merge #350: Clusters	81 + 1016 -> 1321, Linkage = 1.01115885e+07
[32m00:22:14 Cluster | NOTICE [0m Merge #400: Clusters	864 + 1310 -> 1371, Linkage = 9.03676475e+06
[32m00:22:14 Cluster | NOTICE [0m Merge #450: Clusters	1174 + 1186 -> 1421, Linkage = 8.112113583333333e+06
[32m00:22:14 Cluster | NOTICE [0m Merge #500: Clusters	575 + 1374 -> 1471, Linkage = 7.272524e+06
[32m00:22:14 Cluster | NOTICE [0m Merge #550: Clusters	436 + 1319 -> 1521, Linkage = 6.4612385e+06
[32m00:22:14 Cluster | NOTICE [0m Merge #600: Clusters	75 + 1389 -> 1571, Linkage = 5.86892675e+06
[32m00:22:14 Cluster | NOTICE [0m Merge #650: Clusters	324 + 1212 -> 1621, Linkage = 5.140994333333333e+06
[32m00:22:14 Cluster | NOTICE [0m Merge #700: Clusters	1345 + 1552 -> 1671, Linkage = 4.418504875e+06
[32m00:22:14 Cluster | NOTICE [0m Merge #750: Clusters	1362 + 1433 -> 1721, Linkage = 3.852322375e+06
[32m00:22:14 Cluster | NOTICE [0m Merge #800: Clusters	1723 + 1737 -> 1771, Linkage = 3.175001e+06
[32m00:22:14 Cluster | NOTICE [0m Merge #850: Clusters	1666 + 1794 -> 1821, Linkage = 2.178611600877193e+06
[32m00:22:14 Cluster | NOTICE [0m Merge #900: Clusters	1778 + 1826 -> 1871, Linkage = 1.2360498014705882e+06
[32m00:22:14 Cluster | NOTICE [0m Merge #950: Clusters	1881 + 1882 -> 1921, Linkage = 632778.1446446446
[32m00:22:14 Cluster | NOTICE [0m 951 merges made so far; this leaves 12 clusters, and so we'r done!
[32m00:22:14 setClusters | NOTICE [0m setClusters summary (NonInformativeRatio = 3): nPassRatio = 2, nFailRatio = 6, nFailCluster=0
[32m00:22:14 printClusters | NOTICE [0m Write 12 partitions to `prunning.clusters.txt`
[32m00:22:14 writeRE | NOTICE [0m RE counts in 67 contigs (total: 639124, avg 1 per 227 bp) written to `prunning.counts_GATC.12g2.txt`
[32m00:22:14 writeRE | NOTICE [0m RE counts in 103 contigs (total: 482924, avg 1 per 197 bp) written to `prunning.counts_GATC.12g5.txt`
[32m00:22:14 writeRE | NOTICE [0m RE counts in 106 contigs (total: 436730, avg 1 per 194 bp) written to `prunning.counts_GATC.12g8.txt`
[32m00:22:14 writeRE | NOTICE [0m RE counts in 77 contigs (total: 420823, avg 1 per 189 bp) written to `prunning.counts_GATC.12g9.txt`
[32m00:22:14 writeRE | NOTICE [0m RE counts in 86 contigs (total: 385418, avg 1 per 183 bp) written to `prunning.counts_GATC.12g11.txt`
[32m00:22:14 writeRE | NOTICE [0m RE counts in 44 contigs (total: 137351, avg 1 per 206 bp) written to `prunning.counts_GATC.12g12.txt`
[32m00:22:14 writeRE | NOTICE [0m RE counts in 97 contigs (total: 1117583, avg 1 per 184 bp) written to `prunning.counts_GATC.12g1.txt`
[32m00:22:14 writeRE | NOTICE [0m RE counts in 121 contigs (total: 495430, avg 1 per 199 bp) written to `prunning.counts_GATC.12g3.txt`
[32m00:22:14 writeRE | NOTICE [0m RE counts in 44 contigs (total: 483154, avg 1 per 198 bp) written to `prunning.counts_GATC.12g4.txt`
[32m00:22:14 writeRE | NOTICE [0m RE counts in 91 contigs (total: 487608, avg 1 per 193 bp) written to `prunning.counts_GATC.12g6.txt`
[32m00:22:14 writeRE | NOTICE [0m RE counts in 26 contigs (total: 482448, avg 1 per 189 bp) written to `prunning.counts_GATC.12g7.txt`
[32m00:22:14 writeRE | NOTICE [0m RE counts in 103 contigs (total: 401526, avg 1 per 189 bp) written to `prunning.counts_GATC.12g10.txt`
[32m00:22:14 Run | NOTICE [0m Success
[2025-12-11 00:22:14] âœ… Partition completed
[2025-12-11 00:22:14] â±ï¸  Step completed in 18m 33s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ§¬ [Step 3.5] Extracting contact matrix
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 00:22:14] âœ… Found existing: sample.clean.clm
[2025-12-11 00:22:14] â±ï¸  Step completed in 0s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸš‘ [Step 4] Rescuing unplaced contigs
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 00:22:14] â–¶ï¸  ALLHiC_rescue -b sample.clean.bam -r draft.asm.fasta              -c prunning.clusters.txt -i sample.clean.counts_GATC.txt
Starting rescue ungrouped contigs
Reading contig length
Reading link signals ...
Reading sample.clean.bam
find ungrouped contigs ...
output HiC link signals ...
Output refined clusters 
Number of original contigs in group3: 121
Number of rescued contigs in group3: 2
Number of original contigs in group2: 67
Number of rescued contigs in group2: 0
Number of original contigs in group12: 44
Number of rescued contigs in group12: 0
Number of original contigs in group1: 97
Number of rescued contigs in group1: 2
Number of original contigs in group6: 91
Number of rescued contigs in group6: 0
Number of original contigs in group5: 103
Number of rescued contigs in group5: 2
Number of original contigs in group7: 26
Number of rescued contigs in group7: 0
Number of original contigs in group9: 77
Number of rescued contigs in group9: 0
Number of original contigs in group4: 44
Number of rescued contigs in group4: 0
Number of original contigs in group8: 106
Number of rescued contigs in group8: 0
Number of original contigs in group11: 86
Number of rescued contigs in group11: 0
Number of original contigs in group10: 103
Number of rescued contigs in group10: 0
[2025-12-11 01:04:08] âœ… Rescue completed
[2025-12-11 01:04:08] â±ï¸  Step completed in 41m 54s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš™ï¸  [Step 5] Optimizing contig order
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 01:04:08]   Processing: prunning.counts_GATC.12g10.txt -> group10.txt
[2025-12-11 01:04:08]   Processing: prunning.counts_GATC.12g11.txt -> group11.txt
[2025-12-11 01:04:08]   Processing: prunning.counts_GATC.12g12.txt -> group12.txt
[2025-12-11 01:04:08]   Processing: prunning.counts_GATC.12g1.txt -> group1.txt
[2025-12-11 01:04:08]   Processing: prunning.counts_GATC.12g2.txt -> group2.txt
[2025-12-11 01:04:08]   Processing: prunning.counts_GATC.12g3.txt -> group3.txt
[2025-12-11 01:04:08]   Processing: prunning.counts_GATC.12g4.txt -> group4.txt
[2025-12-11 01:04:08]   Processing: prunning.counts_GATC.12g5.txt -> group5.txt
[2025-12-11 01:04:08]   Processing: prunning.counts_GATC.12g6.txt -> group6.txt
[2025-12-11 01:04:08]   Processing: prunning.counts_GATC.12g7.txt -> group7.txt
[2025-12-11 01:04:08]   Processing: prunning.counts_GATC.12g8.txt -> group8.txt
[2025-12-11 01:04:08]   Processing: prunning.counts_GATC.12g9.txt -> group9.txt
[2025-12-11 01:04:08] Found 12 chromosome groups
[2025-12-11 01:04:08] Need to optimize 12 groups: 1 2 3 4 5 6 7 8 9 10 11 12
[2025-12-11 01:04:08] Running optimization in parallel (max 88 jobs)...
[2025-12-11 01:04:09] Using GNU Parallel for optimization
[01:04:09] Starting optimization for group7
[01:04:09] Starting optimization for group4
[01:04:09] Starting optimization for group5
[01:04:09] Starting optimization for group2
[01:04:09] Starting optimization for group3
[01:04:09] Starting optimization for group11
[01:04:09] Starting optimization for group8
[01:04:09] Starting optimization for group10
[01:04:09] Starting optimization for group9
[01:04:09] Starting optimization for group1
[01:04:09] Starting optimization for group6
[01:04:09] Starting optimization for group12
[01:05:20] âœ… Group 4 completed
[01:05:20] âœ… Group 12 completed
[01:05:22] âœ… Group 10 completed
[01:05:24] âœ… Group 11 completed
[01:05:24] âœ… Group 2 completed
[01:05:24] âœ… Group 9 completed
[01:05:25] âœ… Group 7 completed
[01:05:25] âœ… Group 8 completed
[01:05:25] âœ… Group 5 completed
[01:05:28] âœ… Group 1 completed
[01:05:29] âœ… Group 6 completed
[01:05:32] âœ… Group 3 completed
[2025-12-11 01:05:32] 
[2025-12-11 01:05:32] Checking optimization results...
[2025-12-11 01:05:32]   âœ… Group 1: success
[2025-12-11 01:05:32]   âœ… Group 2: success
[2025-12-11 01:05:32]   âœ… Group 3: success
[2025-12-11 01:05:32]   âœ… Group 4: success
[2025-12-11 01:05:32]   âœ… Group 5: success
[2025-12-11 01:05:32]   âœ… Group 6: success
[2025-12-11 01:05:32]   âœ… Group 7: success
[2025-12-11 01:05:32]   âœ… Group 8: success
[2025-12-11 01:05:32]   âœ… Group 9: success
[2025-12-11 01:05:32]   âœ… Group 10: success
[2025-12-11 01:05:32]   âœ… Group 11: success
[2025-12-11 01:05:32]   âœ… Group 12: success
[2025-12-11 01:05:32] 
[2025-12-11 01:05:32] Optimization summary: 12/12 groups succeeded
[2025-12-11 01:05:32] âœ… All groups optimized successfully
[2025-12-11 01:05:32] â±ï¸  Step completed in 1m 24s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ—ï¸  [Step 6] Building final assembly
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 01:05:32] â–¶ï¸  ALLHiC_build draft.asm.fasta
1. tour format to agp ...
Processing group1.tour ...
Processing group10.tour ...
Processing group11.tour ...
Processing group12.tour ...
Processing group2.tour ...
Processing group3.tour ...
Processing group4.tour ...
Processing group5.tour ...
Processing group6.tour ...
Processing group7.tour ...
Processing group8.tour ...
Processing group9.tour ...
[2025-12-11 01:05:37] âœ… Build completed
[2025-12-11 01:05:37] â±ï¸  Step completed in 5s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š [Step 7] Generating contact maps
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 01:05:40] â–¶ï¸  ALLHiC_plot -b sample.clean.bam -a groups.agp -l chrn.list              -m 50k -s 500k -o ./
/share/org/YZWL/yzwl_lixg/software/ALLHiC/bin/ALLHiC_plot:178: UserWarning: Attempting to set identical low and high xlims makes transformation singular; automatically expanding.
  hmap = ax.imshow(np.log2(sub_data[: plt_cnt, : plt_cnt]), interpolation='nearest', origin='lower', cmap=cmap, aspect='equal')
/share/org/YZWL/yzwl_lixg/software/ALLHiC/bin/ALLHiC_plot:178: UserWarning: Attempting to set identical low and high ylims makes transformation singular; automatically expanding.
  hmap = ax.imshow(np.log2(sub_data[: plt_cnt, : plt_cnt]), interpolation='nearest', origin='lower', cmap=cmap, aspect='equal')
[32m[01:05:50][0m Step1: Get chromosome length
[32m[01:05:50][0m Step2: Get signal matrix
[32m[01:49:07][0m Step3: Draw heatmap
[32m[01:49:07][0m Drawing with bin size 500k
[32m[01:49:14][0m Success
[2025-12-11 01:49:15] âœ… Plotting completed
[2025-12-11 01:49:15] â±ï¸  Step completed in 43m 38s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ¨ [Step 8] Generating JBAT files for manual curation
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 01:49:15] Converting AGP to Assembly format...
[2025-12-11 01:49:15] â–¶ï¸  python3 '/share/org/YZWL/yzwl_lixg/software/3d-dna/utils/agp2assembly.py' groups.agp 'jbat_results/out_JBAT.assembly'
[2025-12-11 01:49:15] Mapping reads to draft contigs for HiC generation...
[2025-12-11 01:49:15] Running BWA MEM pipeline (this may take a while)...
[2025-12-11 12:30:16] âœ… MND file generated successfully
[2025-12-11 12:30:16] Generating HIC file using Juicer Tools...
[2025-12-11 12:30:16] â–¶ï¸  java -Xmx800G -jar '/share/org/YZWL/yzwl_lixg/software/juicer/CPU/common/juicer_tools.jar' pre 'jbat_results/draft.mnd.sorted.txt' 'jbat_results/draft.hic' 'jbat_results/draft.chrom.sizes'
WARNING: sun.reflect.Reflection.getCallerClass is not supported. This will impact performance.
WARN [2025-12-11T12:30:17,877]  [Globals.java:138] [main]  Development mode is enabled
Using 1 CPU thread(s)
Not including fragment map
Start preprocess
Writing header
Writing body
java.io.IOException: Unexpected column count.  Check file format
	at juicebox.tools.utils.original.AsciiPairIterator.advance(AsciiPairIterator.java:167)
	at juicebox.tools.utils.original.AsciiPairIterator.<init>(AsciiPairIterator.java:74)
	at juicebox.tools.utils.original.Preprocessor.computeWholeGenomeMatrix(Preprocessor.java:565)
	at juicebox.tools.utils.original.Preprocessor.writeBody(Preprocessor.java:658)
	at juicebox.tools.utils.original.Preprocessor.preprocess(Preprocessor.java:425)
	at juicebox.tools.clt.old.PreProcessing.run(PreProcessing.java:139)
	at juicebox.tools.HiCTools.main(HiCTools.java:94)
java.lang.RuntimeException: No reads in Hi-C contact matrices. This could be because the MAPQ filter is set too high (-q) or because all reads map to the same fragment.
	at juicebox.tools.utils.original.MatrixZoomDataPP.mergeAndWriteBlocks(MatrixZoomDataPP.java:276)
	at juicebox.tools.utils.original.Preprocessor.writeMatrix(Preprocessor.java:970)
	at juicebox.tools.utils.original.Preprocessor.writeBody(Preprocessor.java:659)
	at juicebox.tools.utils.original.Preprocessor.preprocess(Preprocessor.java:425)
	at juicebox.tools.clt.old.PreProcessing.run(PreProcessing.java:139)
	at juicebox.tools.HiCTools.main(HiCTools.java:94)
[2025-12-11 12:30:18] âœ… HIC file generated successfully
[2025-12-11 12:30:18] ğŸ’¡ Tip: You can remove jbat_results/draft.mnd.sorted.txt (45G) to save space

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ‰ JBAT Files Ready for Manual Curation
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 12:30:18] 
[2025-12-11 12:30:18] ğŸ“‚ Location: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap2/jbat_results/
[2025-12-11 12:30:18] 
[2025-12-11 12:30:18] ğŸ“„ Files generated:
[2025-12-11 12:30:18]   1ï¸âƒ£  draft.hic           - Hi-C contact map (load this first in Juicebox)
[2025-12-11 12:30:18]   2ï¸âƒ£  out_JBAT.assembly   - Assembly structure file
[2025-12-11 12:30:18]   3ï¸âƒ£  draft.chrom.sizes   - Chromosome sizes
[2025-12-11 12:30:18] 
[2025-12-11 12:30:18] ğŸ”§ Instructions for Juicebox Assembly Tools (JBAT):
[2025-12-11 12:30:18]   1. Open Juicebox (https://aidenlab.org/juicebox/)
[2025-12-11 12:30:18]   2. Load draft.hic file
[2025-12-11 12:30:18]   3. Import assembly: Assembly â†’ Import Map Assembly â†’ out_JBAT.assembly
[2025-12-11 12:30:18]   4. Perform manual curation
[2025-12-11 12:30:18]   5. Export corrected assembly
[2025-12-11 12:30:18] 
[2025-12-11 12:30:18] â±ï¸  Step completed in 0s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ‰ Pipeline Completed in 21h 35m 26s
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 12:30:18] ğŸ“ Full log: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap2/logs/allhic_20251210_145452.log
