ğŸš€ ä½œä¸šå¼€å§‹: filter_vcf_soybean_1
â° å¼€å§‹æ—¶é—´: 2025-12-31 08:10:31
ğŸ“ æ‰§è¡Œå‘½ä»¤: biopytools filter-snp-indel -i 02.æŒ‰æŸ“è‰²ä½“åˆå¹¶VCFæ–‡ä»¶/Chr01.joint.merged.vcf.gz -o 03.æŒ‰æŸ“è‰²ä½“è¿‡æ»¤VCFæ–‡ä»¶/chr01
==========================================
[2025-12-31 08:10:31] INFO: ============================================================
[2025-12-31 08:10:31] INFO: Program: VCF SNP/INDEL Filtering
[2025-12-31 08:10:31] INFO: Version: 1.0.0
[2025-12-31 08:10:31] INFO: ============================================================
[2025-12-31 08:10:31] INFO: ============================================================
[2025-12-31 08:10:31] INFO: å¼€å§‹VCF SNP/INDELè¿‡æ»¤æµç¨‹ | Starting VCF SNP/INDEL Filtering Pipeline
[2025-12-31 08:10:31] INFO: ============================================================
[2025-12-31 08:10:31] INFO: è¾“å…¥VCFæ–‡ä»¶ | Input VCF file: /share/org/YZWL/yzwl_lixg/project/21.é‡ç”Ÿå¤§è±†ç¾¤ä½“/05.æ‰€æœ‰æ ·å“/02.æŒ‰æŸ“è‰²ä½“åˆå¹¶VCFæ–‡ä»¶/Chr01.joint.merged.vcf.gz
[2025-12-31 08:10:31] INFO: è¾“å‡ºç›®å½• | Output directory: /share/org/YZWL/yzwl_lixg/project/21.é‡ç”Ÿå¤§è±†ç¾¤ä½“/05.æ‰€æœ‰æ ·å“/03.æŒ‰æŸ“è‰²ä½“è¿‡æ»¤VCFæ–‡ä»¶/chr01
[2025-12-31 08:10:31] INFO: çº¿ç¨‹æ•° | Threads: 64
[2025-12-31 08:10:31] INFO: BCFtoolsè·¯å¾„ | BCFtools path: bcftools
[2025-12-31 08:10:31] INFO: ============================================================
[2025-12-31 08:10:31] INFO: æ£€æŸ¥ä¾èµ–è½¯ä»¶ | Checking dependencies
[2025-12-31 08:10:31] INFO: æ£€æŸ¥ä¾èµ–è½¯ä»¶ | Checking dependencies
[2025-12-31 08:10:32] INFO: BCFtools å¯ç”¨ | BCFtools available
[2025-12-31 08:10:32] INFO: ============================================================
[2025-12-31 08:10:32] INFO: æ­¥éª¤1: åˆ†ç¦»SNPå’ŒINDEL | Step 1: Separating SNPs and INDELs
[2025-12-31 08:10:32] INFO: ============================================================
[2025-12-31 08:10:32] INFO: æ‰§è¡Œæ­¥éª¤ | Executing step: æå–SNPå˜å¼‚ | Extracting SNP variants
[2025-12-31 08:10:32] INFO: å‘½ä»¤ | Command: bcftools view --types snps --threads 64 -Oz -o variation.raw.snp.vcf.gz /share/org/YZWL/yzwl_lixg/project/21.é‡ç”Ÿå¤§è±†ç¾¤ä½“/05.æ‰€æœ‰æ ·å“/02.æŒ‰æŸ“è‰²ä½“åˆå¹¶VCFæ–‡ä»¶/Chr01.joint.merged.vcf.gz
[2025-12-31 09:57:28] INFO: å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: æå–SNPå˜å¼‚ | Extracting SNP variants
[2025-12-31 09:57:28] INFO: æ‰§è¡Œæ­¥éª¤ | Executing step: æå–INDELå˜å¼‚ | Extracting INDEL variants
[2025-12-31 09:57:28] INFO: å‘½ä»¤ | Command: bcftools view --types indels --threads 64 -Oz -o variation.raw.indel.vcf.gz /share/org/YZWL/yzwl_lixg/project/21.é‡ç”Ÿå¤§è±†ç¾¤ä½“/05.æ‰€æœ‰æ ·å“/02.æŒ‰æŸ“è‰²ä½“åˆå¹¶VCFæ–‡ä»¶/Chr01.joint.merged.vcf.gz
[2025-12-31 11:12:12] INFO: å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: æå–INDELå˜å¼‚ | Extracting INDEL variants
[2025-12-31 11:12:12] INFO: åˆ›å»ºVCFç´¢å¼• | Creating VCF index
[2025-12-31 11:12:12] INFO: æ‰§è¡Œæ­¥éª¤ | Executing step: ç´¢å¼•æ–‡ä»¶ | Indexing variation.raw.snp.vcf.gz
[2025-12-31 11:12:12] INFO: å‘½ä»¤ | Command: bcftools index -f variation.raw.snp.vcf.gz
[2025-12-31 11:39:53] INFO: å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: ç´¢å¼•æ–‡ä»¶ | Indexing variation.raw.snp.vcf.gz
[2025-12-31 11:39:53] INFO: æ‰§è¡Œæ­¥éª¤ | Executing step: ç´¢å¼•æ–‡ä»¶ | Indexing variation.raw.indel.vcf.gz
[2025-12-31 11:39:53] INFO: å‘½ä»¤ | Command: bcftools index -f variation.raw.indel.vcf.gz
[2025-12-31 11:47:13] INFO: å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: ç´¢å¼•æ–‡ä»¶ | Indexing variation.raw.indel.vcf.gz
[2025-12-31 11:47:13] INFO: SNPå’ŒINDELåˆ†ç¦»å®Œæˆ | SNP and INDEL separation completed
[2025-12-31 11:47:13] INFO: ============================================================
[2025-12-31 11:47:13] INFO: æ­¥éª¤2a: è¿‡æ»¤SNP | Step 2a: Filtering SNPs
[2025-12-31 11:47:13] INFO: ============================================================
[2025-12-31 11:47:13] INFO: SNPè¿‡æ»¤æ¡ä»¶ | SNP filter criteria:
[2025-12-31 11:47:13] INFO:    â€¢ QUAL >= 30.0
[2025-12-31 11:47:13] INFO:    â€¢ INFO/DP >= 10
[2025-12-31 11:47:13] INFO:    â€¢ MQ >= 40.0
[2025-12-31 11:47:13] INFO:    â€¢ QD >= 2.0
[2025-12-31 11:47:13] INFO:    â€¢ FS <= 60.0
[2025-12-31 11:47:13] INFO:    â€¢ SOR <= 3.0
[2025-12-31 11:47:13] INFO:    â€¢ MQRankSum >= -12.5
[2025-12-31 11:47:13] INFO:    â€¢ ReadPosRankSum >= -8.0
[2025-12-31 11:47:13] INFO:    â€¢ MAF >= 0.05
[2025-12-31 11:47:13] INFO: æ‰§è¡Œæ­¥éª¤ | Executing step: åº”ç”¨SNPè¿‡æ»¤ | Applying SNP filters
[2025-12-31 11:47:13] INFO: å‘½ä»¤ | Command: bcftools view -i 'QUAL >= 30.0 && INFO/DP >= 10 && MQ >= 40.0 && QD >= 2.0 && FS <= 60.0 && SOR <= 3.0 && MQRankSum >= -12.5 && ReadPosRankSum >= -8.0 && MAF >= 0.05' --threads 64 -Oz -o variation.filtered.snp.vcf.gz variation.raw.snp.vcf.gz
[2025-12-31 12:45:04] INFO: å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: åº”ç”¨SNPè¿‡æ»¤ | Applying SNP filters
[2025-12-31 12:45:04] INFO: æ‰§è¡Œæ­¥éª¤ | Executing step: ç´¢å¼•è¿‡æ»¤åçš„SNPæ–‡ä»¶ | Indexing filtered SNP file
[2025-12-31 12:45:04] INFO: å‘½ä»¤ | Command: bcftools index -f variation.filtered.snp.vcf.gz
[2025-12-31 12:47:32] INFO: å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: ç´¢å¼•è¿‡æ»¤åçš„SNPæ–‡ä»¶ | Indexing filtered SNP file
[2025-12-31 12:47:32] INFO: SNPè¿‡æ»¤å®Œæˆ | SNP filtering completed
[2025-12-31 12:47:32] INFO: ============================================================
[2025-12-31 12:47:32] INFO: æ­¥éª¤2b: è¿‡æ»¤INDEL | Step 2b: Filtering INDELs
[2025-12-31 12:47:32] INFO: ============================================================
[2025-12-31 12:47:32] INFO: INDELè¿‡æ»¤æ¡ä»¶ | INDEL filter criteria:
[2025-12-31 12:47:32] INFO:    â€¢ QUAL >= 30.0
[2025-12-31 12:47:32] INFO:    â€¢ INFO/DP >= 10
[2025-12-31 12:47:32] INFO:    â€¢ MQ >= 40.0
[2025-12-31 12:47:32] INFO:    â€¢ QD >= 2.0
[2025-12-31 12:47:32] INFO:    â€¢ FS <= 200.0
[2025-12-31 12:47:32] INFO:    â€¢ SOR <= 10.0
[2025-12-31 12:47:32] INFO:    â€¢ ReadPosRankSum >= -20.0
[2025-12-31 12:47:32] INFO: æ‰§è¡Œæ­¥éª¤ | Executing step: åº”ç”¨INDELè¿‡æ»¤ | Applying INDEL filters
[2025-12-31 12:47:32] INFO: å‘½ä»¤ | Command: bcftools view -i 'QUAL >= 30.0 && INFO/DP >= 10 && MQ >= 40.0 && QD >= 2.0 && FS <= 200.0 && SOR <= 10.0 && ReadPosRankSum >= -20.0' --threads 64 -Oz -o variation.filtered.indel.vcf.gz variation.raw.indel.vcf.gz
[2025-12-31 13:08:21] INFO: å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: åº”ç”¨INDELè¿‡æ»¤ | Applying INDEL filters
[2025-12-31 13:08:21] INFO: æ‰§è¡Œæ­¥éª¤ | Executing step: ç´¢å¼•è¿‡æ»¤åçš„INDELæ–‡ä»¶ | Indexing filtered INDEL file
[2025-12-31 13:08:21] INFO: å‘½ä»¤ | Command: bcftools index -f variation.filtered.indel.vcf.gz
[2025-12-31 13:12:36] INFO: å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: ç´¢å¼•è¿‡æ»¤åçš„INDELæ–‡ä»¶ | Indexing filtered INDEL file
[2025-12-31 13:12:36] INFO: INDELè¿‡æ»¤å®Œæˆ | INDEL filtering completed
[2025-12-31 13:12:36] INFO: ============================================================
[2025-12-31 13:12:36] INFO: æ­¥éª¤2c: è¿‡æ»¤åŒç­‰ä½ä½ç‚¹SNP | Step 2c: Filtering biallelic SNPs
[2025-12-31 13:12:36] INFO: ============================================================
[2025-12-31 13:12:36] INFO: åŒç­‰ä½ä½ç‚¹è¿‡æ»¤æ¡ä»¶ | Biallelic filter criteria:
[2025-12-31 13:12:36] INFO:    â€¢ åŒç­‰ä½ä½ç‚¹ | Biallelic sites only (max 2 alleles)
[2025-12-31 13:12:36] INFO:    â€¢ MAF > 0.05
[2025-12-31 13:12:36] INFO: æ‰§è¡Œæ­¥éª¤ | Executing step: åº”ç”¨åŒç­‰ä½ä½ç‚¹è¿‡æ»¤ | Applying biallelic filters
[2025-12-31 13:12:36] INFO: å‘½ä»¤ | Command: bcftools view -m2 -M2 -v snps -i 'MAF > 0.05' --threads 64 -Oz -o variation.filtered.snp.biallelic.vcf.gz variation.filtered.snp.vcf.gz
[2025-12-31 13:19:07] INFO: å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: åº”ç”¨åŒç­‰ä½ä½ç‚¹è¿‡æ»¤ | Applying biallelic filters
[2025-12-31 13:19:07] INFO: æ‰§è¡Œæ­¥éª¤ | Executing step: ç´¢å¼•åŒç­‰ä½ä½ç‚¹SNPæ–‡ä»¶ | Indexing biallelic SNP file
[2025-12-31 13:19:07] INFO: å‘½ä»¤ | Command: bcftools index -f variation.filtered.snp.biallelic.vcf.gz
[2025-12-31 13:20:20] INFO: å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: ç´¢å¼•åŒç­‰ä½ä½ç‚¹SNPæ–‡ä»¶ | Indexing biallelic SNP file
[2025-12-31 13:20:20] INFO: åŒç­‰ä½ä½ç‚¹SNPè¿‡æ»¤å®Œæˆ | Biallelic SNP filtering completed
[2025-12-31 13:20:20] INFO: ============================================================
[2025-12-31 13:20:20] INFO: æ­¥éª¤3: åˆå¹¶è¿‡æ»¤åçš„å˜å¼‚ | Step 3: Merging filtered variants
[2025-12-31 13:20:20] INFO: ============================================================
[2025-12-31 13:20:20] INFO: ä½¿ç”¨åŒç­‰ä½ä½ç‚¹è¿‡æ»¤åçš„SNP | Using biallelic-filtered SNPs
[2025-12-31 13:20:20] INFO: æ‰§è¡Œæ­¥éª¤ | Executing step: åˆå¹¶SNPå’ŒINDEL | Merging SNPs and INDELs
[2025-12-31 13:20:20] INFO: å‘½ä»¤ | Command: bcftools concat -a -D --threads 64 -Oz -o variation.filtered.merged.unsorted.vcf.gz variation.filtered.snp.biallelic.vcf.gz variation.filtered.indel.vcf.gz
[2025-12-31 13:42:10] INFO: å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: åˆå¹¶SNPå’ŒINDEL | Merging SNPs and INDELs
[2025-12-31 13:42:10] INFO: æ‰§è¡Œæ­¥éª¤ | Executing step: æŒ‰ä½ç½®æ’åº | Sorting by position
[2025-12-31 13:42:10] INFO: å‘½ä»¤ | Command: bcftools sort -Oz -o variation.filtered.merged.vcf.gz variation.filtered.merged.unsorted.vcf.gz
[2025-12-31 15:14:02] INFO: å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: æŒ‰ä½ç½®æ’åº | Sorting by position
[2025-12-31 15:14:02] INFO: æ¸…ç†ä¸´æ—¶æ–‡ä»¶ | Cleaning up temporary file: 03.æŒ‰æŸ“è‰²ä½“è¿‡æ»¤VCFæ–‡ä»¶/chr01/variation.filtered.merged.unsorted.vcf.gz
[2025-12-31 15:14:02] INFO: ä¸´æ—¶æ–‡ä»¶å·²åˆ é™¤ | Temporary file deleted.
[2025-12-31 15:14:02] INFO: æ‰§è¡Œæ­¥éª¤ | Executing step: ç´¢å¼•åˆå¹¶æ–‡ä»¶ | Indexing merged file
[2025-12-31 15:14:02] INFO: å‘½ä»¤ | Command: bcftools index -f variation.filtered.merged.vcf.gz
[2025-12-31 15:19:26] INFO: å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: ç´¢å¼•åˆå¹¶æ–‡ä»¶ | Indexing merged file
[2025-12-31 15:19:26] INFO: å˜å¼‚åˆå¹¶å®Œæˆ | Variant merging completed
[2025-12-31 15:19:26] INFO: ============================================================
[2025-12-31 15:19:26] INFO: æ­¥éª¤4: ç”Ÿæˆç»Ÿè®¡æŠ¥å‘Š | Step 4: Generating statistics report
[2025-12-31 15:19:26] INFO: ============================================================
[2025-12-31 18:24:10] INFO: ============================================================
[2025-12-31 18:24:10] INFO: è¿‡æ»¤ç»Ÿè®¡ | Filtering Statistics
[2025-12-31 18:24:10] INFO: ============================================================
[2025-12-31 18:24:10] INFO: åŸå§‹SNP | Raw SNPs: 10,417,270
[2025-12-31 18:24:10] INFO: è¿‡æ»¤åSNP | Filtered SNPs: 705,940
[2025-12-31 18:24:10] INFO: åŸå§‹INDEL | Raw INDELs: 2,357,546
[2025-12-31 18:24:10] INFO: è¿‡æ»¤åINDEL | Filtered INDELs: 1,234,334
[2025-12-31 18:24:10] INFO: åˆå¹¶åå˜å¼‚ | Merged variants: 1,672,542
[2025-12-31 18:24:10] INFO: åŒç­‰ä½ä½ç‚¹SNP | Biallelic SNPs: 438,208
[2025-12-31 18:24:10] INFO: SNPä¿ç•™ç‡ | SNP retention rate: 6.78%
[2025-12-31 18:24:10] INFO: åŒç­‰ä½ä½ç‚¹ä¿ç•™ç‡ | Biallelic retention rate: 62.07%
[2025-12-31 18:24:10] INFO: INDELä¿ç•™ç‡ | INDEL retention rate: 52.36%
[2025-12-31 18:24:10] INFO: ç»Ÿè®¡æŠ¥å‘Šå·²ä¿å­˜ | Statistics report saved: 03.æŒ‰æŸ“è‰²ä½“è¿‡æ»¤VCFæ–‡ä»¶/chr01/filtering_statistics.txt
[2025-12-31 18:24:10] INFO: ============================================================
[2025-12-31 18:24:10] INFO: VCFè¿‡æ»¤æµç¨‹æˆåŠŸå®Œæˆ | VCF Filtering Pipeline Completed Successfully!
[2025-12-31 18:24:10] INFO: ============================================================
[2025-12-31 18:24:10] INFO: ç»“æœä¿å­˜åœ¨ | Results saved in: /share/org/YZWL/yzwl_lixg/project/21.é‡ç”Ÿå¤§è±†ç¾¤ä½“/05.æ‰€æœ‰æ ·å“/03.æŒ‰æŸ“è‰²ä½“è¿‡æ»¤VCFæ–‡ä»¶/chr01
[2025-12-31 18:24:10] INFO: ============================================================

[2025-12-31 18:24:10] INFO: ============================================================
[2025-12-31 18:24:10] INFO: Pipeline Summary
[2025-12-31 18:24:10] INFO: ============================================================
[2025-12-31 18:24:10] INFO: Total runtime: 36819.29 seconds
[2025-12-31 18:24:10] INFO: Output directory: 03.æŒ‰æŸ“è‰²ä½“è¿‡æ»¤VCFæ–‡ä»¶/chr01
[2025-12-31 18:24:10] INFO: Pipeline completed successfully
==========================================
â° ç»“æŸæ—¶é—´: 2025-12-31 18:24:11
âœ… ä½œä¸šæˆåŠŸ: filter_vcf_soybean_1
