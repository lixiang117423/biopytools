ğŸ“ Log file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/logs/allhic_20251217_145920.log

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”§ Setting up environment
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-17 14:59:28] Working directory: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1
[2025-12-17 14:59:28] Threads: 88
[2025-12-17 14:59:28] â±ï¸  Step completed in 8s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸš€ Starting ALLHiC Pipeline v5.4 (Asmkit)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“‚ [Step 0] Preparing input data (00_data)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-17 14:59:28] Building BWA index...
[2025-12-17 14:59:28] â–¶ï¸  bwa index draft.asm.fasta
[bwa_index] Pack FASTA... 5.37 sec
[bwa_index] Construct BWT for the packed sequence...
[BWTIncCreate] textLength=2685873988, availableWord=200987748
[BWTIncConstructFromPacked] 10 iterations done. 99999988 characters processed.
[BWTIncConstructFromPacked] 20 iterations done. 199999988 characters processed.
[BWTIncConstructFromPacked] 30 iterations done. 299999988 characters processed.
[BWTIncConstructFromPacked] 40 iterations done. 399999988 characters processed.
[BWTIncConstructFromPacked] 50 iterations done. 499999988 characters processed.
[BWTIncConstructFromPacked] 60 iterations done. 599999988 characters processed.
[BWTIncConstructFromPacked] 70 iterations done. 699999988 characters processed.
[BWTIncConstructFromPacked] 80 iterations done. 799999988 characters processed.
[BWTIncConstructFromPacked] 90 iterations done. 899999988 characters processed.
[BWTIncConstructFromPacked] 100 iterations done. 999999988 characters processed.
[BWTIncConstructFromPacked] 110 iterations done. 1099999988 characters processed.
[BWTIncConstructFromPacked] 120 iterations done. 1199999988 characters processed.
[BWTIncConstructFromPacked] 130 iterations done. 1299999988 characters processed.
[BWTIncConstructFromPacked] 140 iterations done. 1399999988 characters processed.
[BWTIncConstructFromPacked] 150 iterations done. 1499999988 characters processed.
[BWTIncConstructFromPacked] 160 iterations done. 1599999988 characters processed.
[BWTIncConstructFromPacked] 170 iterations done. 1699999988 characters processed.
[BWTIncConstructFromPacked] 180 iterations done. 1799999988 characters processed.
[BWTIncConstructFromPacked] 190 iterations done. 1899999988 characters processed.
[BWTIncConstructFromPacked] 200 iterations done. 1999999988 characters processed.
[BWTIncConstructFromPacked] 210 iterations done. 2095332436 characters processed.
[BWTIncConstructFromPacked] 220 iterations done. 2180106868 characters processed.
[BWTIncConstructFromPacked] 230 iterations done. 2255450596 characters processed.
[BWTIncConstructFromPacked] 240 iterations done. 2322412308 characters processed.
[BWTIncConstructFromPacked] 250 iterations done. 2381924036 characters processed.
[BWTIncConstructFromPacked] 260 iterations done. 2434814196 characters processed.
[BWTIncConstructFromPacked] 270 iterations done. 2481819076 characters processed.
[BWTIncConstructFromPacked] 280 iterations done. 2523593124 characters processed.
[BWTIncConstructFromPacked] 290 iterations done. 2560717956 characters processed.
[BWTIncConstructFromPacked] 300 iterations done. 2593710580 characters processed.
[BWTIncConstructFromPacked] 310 iterations done. 2623030484 characters processed.
[BWTIncConstructFromPacked] 320 iterations done. 2649086036 characters processed.
[BWTIncConstructFromPacked] 330 iterations done. 2672240260 characters processed.
[bwt_gen] Finished constructing BWT in 337 iterations.
[bwa_index] 741.94 seconds elapse.
[bwa_index] Update BWT... 5.06 sec
[bwa_index] Pack forward-only FASTA... 3.19 sec
[bwa_index] Construct SA from BWT and Occ... 324.77 sec
[main] Version: 0.7.19-r1273
[main] CMD: bwa index draft.asm.fasta
[main] Real time: 1082.734 sec; CPU: 1080.341 sec
[2025-12-17 15:17:31] Building samtools index...
[2025-12-17 15:17:31] â–¶ï¸  samtools faidx draft.asm.fasta
[2025-12-17 15:17:35] âœ… Data preparation completed
[2025-12-17 15:17:35] â±ï¸  Step completed in 18m 7s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ” [Step 1] Mapping Hi-C reads (01_mapping)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-17 15:17:35] â–¶ï¸  bwa mem -t 88 -5SPM draft.asm.fasta reads_R1.fastq.gz reads_R2.fastq.gz 2>bwa_mapping.log |              samtools view -@ 88 -hF 2316 -q 1 - |              samtools sort -@ 88 -n -o sample.clean.bam -
[bam_sort_core] merging from 6 files and 88 in-memory blocks...
[2025-12-17 23:47:16] âœ… Mapping completed
[2025-12-17 23:47:16] â±ï¸  Step completed in 8h 29m 41s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ§¬ [Step 1.5] Allele detection (02_allele_table)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-17 23:47:16] â–¶ï¸  allhic extract sample.clean.bam draft.asm.fasta --RE GATC
[32m23:47:17 writeRE | NOTICE [0m RE counts in 1282 contigs (total: 6849666, avg 1 per 196 bp) written to `sample.clean.counts_GATC.txt`
[32m23:47:17 extractContigLinks | NOTICE [0m Parse bamfile `sample.clean.bam`
[32m00:05:49 extractContigLinks | NOTICE [0m Extracted 1142 intra-contig link groups (total = 67108665)
[32m00:13:55 extractContigLinks | NOTICE [0m Extracted 750885 inter-contig groups to `sample.clean.clm` (total = 2430022552, maxLinks = 598005, minLinks = 3)
[32m00:13:57 fitPowerLaw | NOTICE [0m Power law Y = 0.00034 * X ^ -0.7157
[32m00:13:57 writeDistribution | NOTICE [0m Link size distribution written to `sample.clean.distribution.txt`
[32m00:13:57 readClmLines | NOTICE [0m Parse clmfile `sample.clean.clm`
[32m00:15:33 calcInterContigs | NOTICE [0m Contig pair analyses written to `sample.clean.pairs.txt`
[32m00:15:33 Run | NOTICE [0m Success
[2025-12-18 00:15:33] â–¶ï¸  minimap2 -DP -k19 -w19 -m200 -t 88 draft.asm.fasta draft.asm.fasta 2>minimap2.log > draft.asm.paf
[2025-12-18 00:30:08] â–¶ï¸  allhic alleles draft.asm.paf sample.clean.counts_GATC.txt > alleles.table
[32m00:30:08 ParseRecords | NOTICE [0m Parse paffile `draft.asm.paf`
[32m00:32:27 ReadCSVLines | NOTICE [0m Parse csvfile `sample.clean.counts_GATC.txt`
[32m00:32:27 Run | NOTICE [0m Success
[2025-12-18 00:32:28] âœ… Allele detection completed
[2025-12-18 00:32:28] â±ï¸  Step completed in 45m 12s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ‚ï¸  [Step 2] Pruning chimeric contigs (03_pruning)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-18 00:32:28] â–¶ï¸  ALLHiC_prune -i alleles.table -b sample.clean.bam -r draft.asm.fasta
Removing 0 reads
[2025-12-18 09:34:49] âœ… Pruning completed
[2025-12-18 09:34:49] â±ï¸  Step completed in 9h 2m 21s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“¦ [Step 3] Partitioning contigs (04_partition)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-18 09:34:50] â–¶ï¸  ALLHiC_partition -b prunning.bam -r draft.asm.fasta -e GATC -k 12
Extract function: calculate an empirical distribution of Hi-C link size based on intra-contig links
CMD: allhic extract prunning.bam draft.asm.fasta --RE GATC
[32m09:34:51 writeRE | NOTICE [0m RE counts in 1282 contigs (total: 6849666, avg 1 per 196 bp) written to `prunning.counts_GATC.txt`
[32m09:34:51 extractContigLinks | NOTICE [0m Parse bamfile `prunning.bam`
[32m09:53:38 extractContigLinks | NOTICE [0m Extracted 1142 intra-contig link groups (total = 67108665)
[32m10:01:44 extractContigLinks | NOTICE [0m Extracted 750885 inter-contig groups to `prunning.clm` (total = 2430022552, maxLinks = 598005, minLinks = 3)
[32m10:01:46 fitPowerLaw | NOTICE [0m Power law Y = 0.00034 * X ^ -0.7157
[32m10:01:46 writeDistribution | NOTICE [0m Link size distribution written to `prunning.distribution.txt`
[32m10:01:46 readClmLines | NOTICE [0m Parse clmfile `prunning.clm`
[32m10:03:19 calcInterContigs | NOTICE [0m Contig pair analyses written to `prunning.pairs.txt`
[32m10:03:19 Run | NOTICE [0m Success
Partition contigs based on prunning bam file
CMD: allhic partition prunning.counts_GATC.txt prunning.pairs.txt 12 --minREs 25
[32m10:03:20 ReadCSVLines | NOTICE [0m Parse csvfile `prunning.counts_GATC.txt`
[32m10:03:20 readRE | NOTICE [0m Loaded 1282 contig RE lengths for normalization from `prunning.counts_GATC.txt`
[32m10:03:20 skipContigsWithFewREs | NOTICE [0m skipContigsWithFewREs with MinREs = 25 (RE = GATC)
[32m10:03:20 skipContigsWithFewREs | NOTICE [0m Marked 0 contigs (avg 0.0 RE sites, len 0) since they contain too few REs (MinREs = 25)
[32m10:03:20 ReadCSVLines | NOTICE [0m Parse csvfile `prunning.pairs.txt`
[32m10:03:21 skipRepeats | NOTICE [0m skipRepeats with multiplicity = 2
Contig #846 (h1tg000847l) has 6.0x the average number of Hi-C links -> MARKED REPETITIVE
Contig #849 (h1tg000850l) has 2.5x the average number of Hi-C links -> MARKED REPETITIVE
Contig #972 (h1tg000973l) has 38.0x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1019 (h1tg001020l) has 30.6x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1023 (h1tg001024l) has 53.7x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1024 (h1tg001025l) has 4.9x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1076 (h1tg001077l) has 2.3x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1086 (h1tg001087l) has 5.3x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1087 (h1tg001088l) has 14.7x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1208 (h1tg001209l) has 11.4x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1211 (h1tg001212l) has 7.9x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1214 (h1tg001215l) has 17.0x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1215 (h1tg001216l) has 10.6x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1220 (h1tg001221l) has 13.7x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1221 (h1tg001222l) has 2.1x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1222 (h1tg001223l) has 29.8x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1226 (h1tg001227l) has 7.3x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1227 (h1tg001228l) has 15.0x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1228 (h1tg001229l) has 6.3x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1229 (h1tg001230l) has 4.4x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1233 (h1tg001234l) has 2.3x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1235 (h1tg001236l) has 4.2x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1259 (h1tg001260l) has 3.0x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1261 (h1tg001262l) has 23.0x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1275 (h1tg001276l) has 16.8x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1277 (h1tg001278l) has 2.9x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1279 (h1tg001280l) has 15.6x the average number of Hi-C links -> MARKED REPETITIVE
[32m10:03:21 skipRepeats | NOTICE [0m Marked 27 contigs (avg len 47475) as repetitive (MaxLinkDensity = 2)
[32m10:03:21 Cluster | NOTICE [0m Clustering starts with 1282 (1255 informative) contigs with target of 12 clusters
[32m10:03:22 Cluster | NOTICE [0m Merge #50: Clusters	646 + 1304 -> 1331, Linkage = 6.20661085e+07
[32m10:03:22 Cluster | NOTICE [0m Merge #100: Clusters	219 + 445 -> 1381, Linkage = 4.5725784e+07
[32m10:03:23 Cluster | NOTICE [0m Merge #150: Clusters	45 + 161 -> 1431, Linkage = 3.4896755e+07
[32m10:03:24 Cluster | NOTICE [0m Merge #200: Clusters	322 + 500 -> 1481, Linkage = 3.0180149e+07
[32m10:03:25 Cluster | NOTICE [0m Merge #250: Clusters	414 + 990 -> 1531, Linkage = 2.6078751e+07
[32m10:03:25 Cluster | NOTICE [0m Merge #300: Clusters	822 + 1523 -> 1581, Linkage = 2.36711305e+07
[32m10:03:26 Cluster | NOTICE [0m Merge #350: Clusters	1012 + 1272 -> 1631, Linkage = 2.1297451e+07
[32m10:03:26 Cluster | NOTICE [0m Merge #400: Clusters	107 + 123 -> 1681, Linkage = 1.9416432e+07
[32m10:03:27 Cluster | NOTICE [0m Merge #450: Clusters	103 + 125 -> 1731, Linkage = 1.7445414e+07
[32m10:03:27 Cluster | NOTICE [0m Merge #500: Clusters	67 + 1553 -> 1781, Linkage = 1.57133355e+07
[32m10:03:27 Cluster | NOTICE [0m Merge #550: Clusters	15 + 1567 -> 1831, Linkage = 1.44576235e+07
[32m10:03:28 Cluster | NOTICE [0m Merge #600: Clusters	370 + 432 -> 1881, Linkage = 1.3045777e+07
[32m10:03:28 Cluster | NOTICE [0m Merge #650: Clusters	213 + 1774 -> 1931, Linkage = 1.1690613666666666e+07
[32m10:03:28 Cluster | NOTICE [0m Merge #700: Clusters	201 + 289 -> 1981, Linkage = 1.053766e+07
[32m10:03:28 Cluster | NOTICE [0m Merge #750: Clusters	1384 + 1915 -> 2031, Linkage = 9.266096125e+06
[32m10:03:28 Cluster | NOTICE [0m Merge #800: Clusters	1850 + 1956 -> 2081, Linkage = 8.478039e+06
[32m10:03:28 Cluster | NOTICE [0m Merge #850: Clusters	1782 + 1975 -> 2131, Linkage = 7.438458625e+06
[32m10:03:28 Cluster | NOTICE [0m Merge #900: Clusters	604 + 2131 -> 2181, Linkage = 6.4336566e+06
[32m10:03:28 Cluster | NOTICE [0m Merge #950: Clusters	2120 + 2134 -> 2231, Linkage = 5.324001680555556e+06
[32m10:03:28 Cluster | NOTICE [0m Merge #1000: Clusters	82 + 2169 -> 2281, Linkage = 4.038271714285714e+06
[32m10:03:28 Cluster | NOTICE [0m Merge #1050: Clusters	1194 + 2309 -> 2331, Linkage = 2.8595253333333335e+06
[32m10:03:28 Cluster | NOTICE [0m Merge #1100: Clusters	1057 + 2258 -> 2381, Linkage = 2.0585295e+06
[32m10:03:28 Cluster | NOTICE [0m Merge #1150: Clusters	1047 + 2338 -> 2431, Linkage = 1.326695e+06
[32m10:03:28 Cluster | NOTICE [0m Merge #1200: Clusters	949 + 2467 -> 2481, Linkage = 940299.5285714286
[32m10:03:28 Cluster | NOTICE [0m 1241 merges made so far; this leaves 12 clusters, and so we'r done!
[32m10:03:28 setClusters | NOTICE [0m setClusters summary (NonInformativeRatio = 3): nPassRatio = 7, nFailRatio = 20, nFailCluster=0
[32m10:03:28 printClusters | NOTICE [0m Write 12 partitions to `prunning.clusters.txt`
[32m10:03:28 writeRE | NOTICE [0m RE counts in 191 contigs (total: 1402819, avg 1 per 215 bp) written to `prunning.counts_GATC.12g1.txt`
[32m10:03:28 writeRE | NOTICE [0m RE counts in 143 contigs (total: 968265, avg 1 per 183 bp) written to `prunning.counts_GATC.12g2.txt`
[32m10:03:28 writeRE | NOTICE [0m RE counts in 107 contigs (total: 559540, avg 1 per 193 bp) written to `prunning.counts_GATC.12g6.txt`
[32m10:03:28 writeRE | NOTICE [0m RE counts in 120 contigs (total: 495462, avg 1 per 198 bp) written to `prunning.counts_GATC.12g8.txt`
[32m10:03:28 writeRE | NOTICE [0m RE counts in 110 contigs (total: 498571, avg 1 per 186 bp) written to `prunning.counts_GATC.12g9.txt`
[32m10:03:28 writeRE | NOTICE [0m RE counts in 31 contigs (total: 351901, avg 1 per 194 bp) written to `prunning.counts_GATC.12g10.txt`
[32m10:03:28 writeRE | NOTICE [0m RE counts in 19 contigs (total: 2129, avg 1 per 371 bp) written to `prunning.counts_GATC.12g11.txt`
[32m10:03:28 writeRE | NOTICE [0m RE counts in 6 contigs (total: 553, avg 1 per 414 bp) written to `prunning.counts_GATC.12g12.txt`
[32m10:03:28 writeRE | NOTICE [0m RE counts in 150 contigs (total: 850428, avg 1 per 186 bp) written to `prunning.counts_GATC.12g3.txt`
[32m10:03:28 writeRE | NOTICE [0m RE counts in 136 contigs (total: 587209, avg 1 per 195 bp) written to `prunning.counts_GATC.12g4.txt`
[32m10:03:28 writeRE | NOTICE [0m RE counts in 137 contigs (total: 565457, avg 1 per 196 bp) written to `prunning.counts_GATC.12g5.txt`
[32m10:03:28 writeRE | NOTICE [0m RE counts in 110 contigs (total: 563661, avg 1 per 192 bp) written to `prunning.counts_GATC.12g7.txt`
[32m10:03:28 Run | NOTICE [0m Success
[2025-12-18 10:03:28] âœ… Partition completed
[2025-12-18 10:03:28] â±ï¸  Step completed in 28m 39s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ§¬ [Step 3.5] Extracting contact matrix (05_extract_matrix)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-18 10:03:28] â–¶ï¸  allhic extract sample.clean.bam draft.asm.fasta --RE GATC
[32m10:03:30 writeRE | NOTICE [0m RE counts in 1282 contigs (total: 6849666, avg 1 per 196 bp) written to `sample.clean.counts_GATC.txt`
[32m10:03:30 extractContigLinks | NOTICE [0m Parse bamfile `sample.clean.bam`
[32m10:22:17 extractContigLinks | NOTICE [0m Extracted 1142 intra-contig link groups (total = 67108665)
[32m10:30:21 extractContigLinks | NOTICE [0m Extracted 750885 inter-contig groups to `sample.clean.clm` (total = 2430022552, maxLinks = 598005, minLinks = 3)
[32m10:30:24 fitPowerLaw | NOTICE [0m Power law Y = 0.00034 * X ^ -0.7157
[32m10:30:24 writeDistribution | NOTICE [0m Link size distribution written to `sample.clean.distribution.txt`
[32m10:30:24 readClmLines | NOTICE [0m Parse clmfile `sample.clean.clm`
[32m10:31:57 calcInterContigs | NOTICE [0m Contig pair analyses written to `sample.clean.pairs.txt`
[32m10:31:57 Run | NOTICE [0m Success
[2025-12-18 10:31:57] âœ… Extract completed
[2025-12-18 10:31:57] â±ï¸  Step completed in 28m 29s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸš‘ [Step 4] Rescuing unplaced contigs (06_rescue)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-18 10:31:57] â–¶ï¸  ALLHiC_rescue -b sample.clean.bam -r draft.asm.fasta              -c prunning.clusters.txt -i sample.clean.counts_GATC.txt
Starting rescue ungrouped contigs
Reading contig length
Reading link signals ...
Reading sample.clean.bam
find ungrouped contigs ...
output HiC link signals ...
Output refined clusters 
Number of original contigs in group7: 110
Number of rescued contigs in group7: 0
Number of original contigs in group2: 143
Number of rescued contigs in group2: 0
Number of original contigs in group4: 136
Number of rescued contigs in group4: 0
Number of original contigs in group8: 120
Number of rescued contigs in group8: 1
Number of original contigs in group11: 19
Number of rescued contigs in group11: 14
Number of original contigs in group1: 191
Number of rescued contigs in group1: 3
Number of original contigs in group6: 107
Number of rescued contigs in group6: 0
Number of original contigs in group10: 31
Number of rescued contigs in group10: 0
Number of original contigs in group9: 110
Number of rescued contigs in group9: 0
Number of original contigs in group5: 137
Number of rescued contigs in group5: 0
Number of original contigs in group12: 6
Number of rescued contigs in group12: 3
Number of original contigs in group3: 150
Number of rescued contigs in group3: 1
[2025-12-18 11:34:58] âœ… Rescue completed
[2025-12-18 11:34:58] â±ï¸  Step completed in 1h 3m 1s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš™ï¸  [Step 5] Optimizing contig order (07_optimize)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-18 11:34:58]   Processing: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/04_partition/prunning.counts_GATC.12g10.txt -> group10.txt
[2025-12-18 11:34:58]   Processing: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/04_partition/prunning.counts_GATC.12g11.txt -> group11.txt
[2025-12-18 11:34:58]   Processing: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/04_partition/prunning.counts_GATC.12g12.txt -> group12.txt
[2025-12-18 11:34:58]   Processing: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/04_partition/prunning.counts_GATC.12g1.txt -> group1.txt
[2025-12-18 11:34:58]   Processing: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/04_partition/prunning.counts_GATC.12g2.txt -> group2.txt
[2025-12-18 11:34:58]   Processing: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/04_partition/prunning.counts_GATC.12g3.txt -> group3.txt
[2025-12-18 11:34:58]   Processing: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/04_partition/prunning.counts_GATC.12g4.txt -> group4.txt
[2025-12-18 11:34:58]   Processing: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/04_partition/prunning.counts_GATC.12g5.txt -> group5.txt
[2025-12-18 11:34:58]   Processing: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/04_partition/prunning.counts_GATC.12g6.txt -> group6.txt
[2025-12-18 11:34:58]   Processing: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/04_partition/prunning.counts_GATC.12g7.txt -> group7.txt
[2025-12-18 11:34:58]   Processing: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/04_partition/prunning.counts_GATC.12g8.txt -> group8.txt
[2025-12-18 11:34:58]   Processing: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/04_partition/prunning.counts_GATC.12g9.txt -> group9.txt
[2025-12-18 11:34:58] Need to optimize 12 groups: 1 2 3 4 5 6 7 8 9 10 11 12
[2025-12-18 11:34:58] Using GNU Parallel for optimization
[2025-12-18 11:37:00] âœ… Optimization completed
[2025-12-18 11:37:00] â±ï¸  Step completed in 2m 2s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ—ï¸  [Step 6] Building final assembly (08_build)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-18 11:37:00] â–¶ï¸  ALLHiC_build draft.asm.fasta
1. tour format to agp ...
Processing group1.tour ...
Processing group10.tour ...
Processing group11.tour ...
Processing group12.tour ...
Processing group2.tour ...
Processing group3.tour ...
Processing group4.tour ...
Processing group5.tour ...
Processing group6.tour ...
Processing group7.tour ...
Processing group8.tour ...
Processing group9.tour ...
[2025-12-18 11:37:09] âœ… Build completed
[2025-12-18 11:37:09] â±ï¸  Step completed in 9s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š [Step 7] Generating contact maps (09_plot)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-18 11:37:09] â–¶ï¸  ALLHiC_plot -b sample.clean.bam -a groups.agp -l chrn.list              -m 50k -s 500k -o ./
/share/org/YZWL/yzwl_lixg/software/ALLHiC/bin/ALLHiC_plot:178: UserWarning: Attempting to set identical low and high xlims makes transformation singular; automatically expanding.
  hmap = ax.imshow(np.log2(sub_data[: plt_cnt, : plt_cnt]), interpolation='nearest', origin='lower', cmap=cmap, aspect='equal')
/share/org/YZWL/yzwl_lixg/software/ALLHiC/bin/ALLHiC_plot:178: UserWarning: Attempting to set identical low and high ylims makes transformation singular; automatically expanding.
  hmap = ax.imshow(np.log2(sub_data[: plt_cnt, : plt_cnt]), interpolation='nearest', origin='lower', cmap=cmap, aspect='equal')
[32m[11:37:20][0m Step1: Get chromosome length
[32m[11:37:20][0m Step2: Get signal matrix
[32m[12:43:10][0m Step3: Draw heatmap
[32m[12:43:10][0m Drawing with bin size 500k
[32m[12:43:21][0m Success
[2025-12-18 12:43:22] âœ… Plotting completed
[2025-12-18 12:43:22] â±ï¸  Step completed in 1h 6m 13s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ¯ [Step 8] Generating JBAT files with asmkit (10_jbat_asmkit)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-18 12:43:22] ğŸ“Œ Strategy: Using ALLHiC results (sample.clean.bam + groups.agp)
[2025-12-18 12:43:22] Linking input files...
[2025-12-18 12:43:22] âœ… Input files prepared
[2025-12-18 12:43:22] âœ… Found asmkit: /share/org/YZWL/yzwl_lixg/software/asmkit/asmkit
[2025-12-18 12:43:22] 
[2025-12-18 12:43:22] â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-18 12:43:22] Step 8.1: Generating links file from BAM...
[2025-12-18 12:43:22] â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-18 12:43:22] Running: /share/org/YZWL/yzwl_lixg/software/asmkit/asmkit bam2links sample.clean.bam out.links
2025/12/18 12:43:22 Start processing bam ...
2025/12/18 13:05:55 Done.
[2025-12-18 13:06:19] âœ… Generated out.links successfully (1114366865 lines, 65G)
[2025-12-18 13:06:19]    Time: 22m 33s
[2025-12-18 13:06:19] 
[2025-12-18 13:06:19] â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-18 13:06:19] Step 8.2: Generating assembly file from AGP...
[2025-12-18 13:06:19] â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-18 13:06:19] Running: /share/org/YZWL/yzwl_lixg/software/asmkit/asmkit agp2assembly groups.agp groups.assembly
2025/12/18 13:06:19 Loading agpfile `groups.agp`.
2025/12/18 13:06:19 Done.
[2025-12-18 13:06:19] âœ… Generated groups.assembly successfully
[2025-12-18 13:06:19]    Time: 0s
[2025-12-18 13:06:19] 
[2025-12-18 13:06:19] â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-18 13:06:19] Step 8.3: Generating .hic file using visualizer...
[2025-12-18 13:06:19] â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-18 13:06:19] Running: bash /share/org/YZWL/yzwl_lixg/software/3d-dna/visualize/run-assembly-visualizer.sh groups.assembly out.links
...Remapping contact data from the original contig set to assembly
...Building track files
...Building the hic file
Not including fragment map
Start preprocess
Writing header
Writing body
..
Writing footer

Finished preprocess
HiC file version: 8

Calculating norms for zoom BP_2500000
Calculating norms for zoom BP_1000000
Calculating norms for zoom BP_500000
Calculating norms for zoom BP_250000
Calculating norms for zoom BP_100000
Calculating norms for zoom BP_50000
Calculating norms for zoom BP_25000
Calculating norms for zoom BP_10000
Calculating norms for zoom BP_5000
Calculating norms for zoom BP_1000
Writing expected
Writing norms
Finished writing norms
[2025-12-19 10:19:24] âœ… Generated groups.hic successfully (4.3G)
[2025-12-19 10:19:24]    Time: 21h 13m 5s
[2025-12-19 10:19:24] 
[2025-12-19 10:19:24] â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-19 10:19:24] ğŸ“¦ JBAT Generation Complete!
[2025-12-19 10:19:24] â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-19 10:19:24] Output: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/10_jbat_asmkit/
   -rw-r--r-- 1 yzwl_lixg yzwl_lixg  37K 12æœˆ 18 13:06 groups.assembly
   -rw-r--r-- 1 yzwl_lixg yzwl_lixg 4.3G 12æœˆ 19 10:19 groups.hic
   -rw-r--r-- 1 yzwl_lixg yzwl_lixg  65G 12æœˆ 18 13:05 out.links
[2025-12-19 10:19:24] 
[2025-12-19 10:19:24] ğŸ’¡ Next Steps (Manual Curation):
[2025-12-19 10:19:24]    1. Download 'groups.assembly' and 'groups.hic' (if generated)
[2025-12-19 10:19:24]    2. Load into Juicebox Assembly Tools
[2025-12-19 10:19:24]    3. Edit and save as 'reviewed.assembly'
[2025-12-19 10:19:24] â±ï¸  Step completed in 21h 36m 2s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ‰ Pipeline Completed in 43h 20m 4s
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-19 10:19:24] 
[2025-12-19 10:19:24] ğŸ“‚ Output Summary:
   ğŸ“‚ /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/00_data/
   ğŸ“‚ /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/01_mapping/
   ğŸ“‚ /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/02_allele_table/
   ğŸ“‚ /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/03_pruning/
   ğŸ“‚ /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/04_partition/
   ğŸ“‚ /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/05_extract_matrix/
   ğŸ“‚ /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/06_rescue/
   ğŸ“‚ /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/07_optimize/
   ğŸ“‚ /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/08_build/
   ğŸ“‚ /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/09_plot/
   ğŸ“‚ /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/10_jbat_asmkit/
   ğŸ“‚ /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/logs/
[2025-12-19 10:19:24] 
[2025-12-19 10:19:24] ğŸ“ Full log: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/hap1/logs/allhic_20251217_145920.log
