[2025-12-18 13:10:35] ğŸ§¬ HapHiCå¤„ç†å™¨å·²åˆå§‹åŒ– | HapHiC processor initialized
[2025-12-18 13:10:35] âš™ï¸ é…ç½®å‚æ•° | Configuration Parameters:
[2025-12-18 13:10:35]   assembly_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/02.assembly/OV53_1/02.fasta/OV53_1.primary.fa
[2025-12-18 13:10:35]   hic_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/01.data/hic/OV53_1-hic_R1.fastq.gz
[2025-12-18 13:10:35]   hic_file_type: fastq
[2025-12-18 13:10:35]   nchrs: 12
[2025-12-18 13:10:35]   output_dir: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/pipeline
[2025-12-18 13:10:35]   prefix: OV53_1.primary
[2025-12-18 13:10:35]   threads: 64
[2025-12-18 13:10:35]   processes: 64
[2025-12-18 13:10:35]   quick_view: False
[2025-12-18 13:10:35]   restriction_sites: ['GATC']
[2025-12-18 13:10:35]   correct_nrounds: 2
[2025-12-18 13:10:35]   remove_allelic_links: None
[2025-12-18 13:10:35]   phasing_weight: 1.0
[2025-12-18 13:10:35]   gfa_files: None
[2025-12-18 13:10:35]   haphic_bin: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic
[2025-12-18 13:10:35]   bwa_bin: bwa
[2025-12-18 13:10:35]   samtools_bin: samtools
[2025-12-18 13:10:35] ğŸš€ å¼€å§‹HapHiCæµç¨‹ | Starting HapHiC pipeline
[2025-12-18 13:10:35] ğŸ” ç³»ç»Ÿé¢„æ£€æŸ¥ | System pre-flight checks
[2025-12-18 13:10:35] ğŸ” éªŒè¯è¾“å…¥æ–‡ä»¶ | Validating input files
[2025-12-18 13:10:36] ğŸ“Š åŸºå› ç»„åºåˆ—æ•°é‡ | Assembly sequence count: 1211
[2025-12-18 13:10:36] ğŸ“Š FASTQæ–‡ä»¶å¤§å° | FASTQ file sizes: R1 60.14 GB, R2 60.14 GB
[2025-12-18 13:10:36] âœ… è¾“å…¥æ–‡ä»¶éªŒè¯é€šè¿‡ | Input files validated
[2025-12-18 13:10:36] ğŸ–¥ï¸ æ£€æŸ¥ç³»ç»Ÿèµ„æº | Checking system resources
[2025-12-18 13:10:36] ğŸ’¾ å¯ç”¨å†…å­˜ | Available memory: 912.2 GB
[2025-12-18 13:10:36] ğŸ’¾ å¯ç”¨ç£ç›˜ç©ºé—´ | Available disk space: 2564419.2 GB
[2025-12-18 13:10:36] ğŸ–¥ï¸ CPUæ ¸å¿ƒæ•° | CPU cores: 88
[2025-12-18 13:10:36] âœ… é¢„æ£€æŸ¥é€šè¿‡ | Pre-flight checks passed
[2025-12-18 13:10:36] ğŸ”— æ‰§è¡ŒBWAæ¯”å¯¹ | Executing BWA alignment
[2025-12-18 13:10:36] ğŸ”— å¼€å§‹BWAæ¯”å¯¹ | Starting BWA alignment (official method)
[2025-12-18 13:10:36] ğŸ“„ ä½¿ç”¨æä¾›çš„FASTQæ–‡ä»¶å¯¹ | Using provided FASTQ pair: OV53_1-hic_R1.fastq.gz
[2025-12-18 13:10:36] ğŸ“„ æ‰¾åˆ° 1 å¯¹FASTQæ–‡ä»¶ | Found 1 FASTQ pairs
[2025-12-18 13:10:36] ğŸ”— åˆ›å»ºåŸºå› ç»„è½¯é“¾æ¥ | Created assembly symlink: assembly.fa
[2025-12-18 13:10:36] ğŸ”— åˆ›å»ºFASTQè½¯é“¾æ¥ | Created FASTQ symlinks: read1_1.fastq.gz, read2_1.fastq.gz
[2025-12-18 13:10:36] ğŸ“ åˆ›å»ºBWAç´¢å¼• | Creating BWA index: assembly.fa
[2025-12-18 13:31:31] âœ… BWAç´¢å¼•åˆ›å»ºå®Œæˆ | BWA index created
[2025-12-18 13:31:31] ğŸ”— æ­¥éª¤1: BWAæ¯”å¯¹ + å»é‡ + åˆæ­¥è¿‡æ»¤ | Step 1: BWA alignment + deduplication + initial filtering
[2025-12-18 22:19:08] âœ… BWAæ¯”å¯¹å®Œæˆï¼Œç”Ÿæˆ HiC.bam
[2025-12-18 22:19:08] ğŸ“Š BAMæ–‡ä»¶å¤§å°: 87253.33 MB
[2025-12-18 22:19:08] ğŸ” æ­¥éª¤2: HapHiCè¿‡æ»¤ | Step 2: HapHiC filtering
[2025-12-18 22:19:09] âŒ HapHiCè¿‡æ»¤å¤±è´¥: [Errno 2] No such file or directory: '/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/HapHiC/utils/filter_bam'
[2025-12-18 22:19:09] âš ï¸ ä½¿ç”¨åŸå§‹BAMæ–‡ä»¶ç»§ç»­ | Continuing with original BAM file
[2025-12-18 22:19:09] ğŸ“ åˆ›å»ºBAMç´¢å¼• | Creating BAM index: HiC.bam
[2025-12-18 22:19:09] âš ï¸ BAMç´¢å¼•åˆ›å»ºå¤±è´¥ | BAM index creation failed: [E::hts_idx_push] Unsorted positions on sequence #9: 1903634 followed by 1899581
[E::sam_index] Read 'E250159834L1C001R00300000965' with ref_name='ptg000009l', ref_length=3347581, flags=129, pos=1899581 cannot be indexed
samtools index: failed to create index for "HiC.bam"

[2025-12-18 22:19:09] âœ… BWAæ¯”å¯¹å®Œæˆ | BWA alignment completed: HiC.bam
[2025-12-18 22:19:09] ğŸš€ å¼€å§‹HapHiCå®Œæ•´æµç¨‹ | Starting complete HapHiC pipeline
[2025-12-18 22:19:09] ğŸ“ åˆ›å»ºç›®å½•ç»“æ„ | Creating directory structure
[2025-12-18 22:19:09] âœ… ç›®å½•ç»“æ„åˆ›å»ºå®Œæˆ | Directory structure created
[2025-12-18 22:19:09] ğŸ” [æ­¥éª¤1] èšç±»åˆ†æ | [Step 1] Clustering analysis
[2025-12-18 22:19:09] ğŸš€ èšç±»åˆ†æ
[2025-12-18 22:19:41] âŒ å‘½ä»¤æ‰§è¡Œå¤±è´¥ | Command failed (è¿”å›ç : 1)
[2025-12-18 22:19:41] é”™è¯¯ä¿¡æ¯ | Error: usage: haphic cluster [-h] [--aln_format {pairs,bam,auto,bgzipped_pairs}] [--RE RE] [--quick_view] [--gfa GFA] [--ul UL]
                      [--correct_nrounds CORRECT_NROUNDS] [--correct_resolution CORRECT_RESOLUTION] [--median_cov_ratio MEDIAN_COV_RATIO]
                      [--region_len_ratio REGION_LEN_RATIO] [--min_region_cutoff MIN_REGION_CUTOFF] [--Nx NX] [--RE_site_cutoff RE_SITE_CUTOFF]
                      [--density_lower DENSITY_LOWER] [--density_upper DENSITY_UPPER] [--read_depth_upper READ_DEPTH_UPPER] [--topN TOPN]
                      [--rank_sum_hard_cutoff RANK_SUM_HARD_CUTOFF] [--rank_sum_upper RANK_SUM_UPPER]
                      [--remove_allelic_links REMOVE_ALLELIC_LINKS] [--concordance_ratio_cutoff CONCORDANCE_RATIO_CUTOFF] [--nwindows NWINDOWS]
                      [--remove_concentrated_links] [--max_read_pairs MAX_READ_PAIRS] [--min_read_pairs MIN_READ_PAIRS]
                      [--phasing_weight PHASING_WEIGHT] [--min_ul_mapq MIN_UL_MAPQ] [--min_ul_alignment_length MIN_UL_ALIGNMENT_LENGTH]
                      [--max_distance_to_end MAX_DISTANCE_TO_END] [--max_overlap_ratio MAX_OVERLAP_RATIO] [--max_gap_len MAX_GAP_LEN]
                      [--min_ul_support MIN_UL_SUPPORT] [--bin_size BIN_SIZE] [--flank FLANK] [--normalize_by_nlinks] [--expansion EXPANSION]
                      [--min_inflation MIN_INFLATION] [--max_inflation MAX_INFLATION] [--inflation_step INFLATION_STEP] [--max_iter MAX_ITER]
                      [--pruning PRUNING] [--skip_clustering] [--threads THREADS] [--dense_matrix] [--verbose]
                      fasta alignments nchrs
haphic cluster: error: unrecognized arguments: --min_group_len 0 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --correct_min_coverage 10.0
Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic", line 117, in <module>
    subprocess.run(commands, check=True)
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/lib/python3.12/subprocess.py", line 571, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_cluster.py', '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/02.assembly/OV53_1/02.fasta/OV53_1.primary.fa', '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/pipeline/00.mapping/HiC.bam', '12', '--threads', '64', '--min_inflation', '1.0', '--max_inflation', '3.0', '--inflation_step', '0.2', '--Nx', '80', '--min_group_len', '0', '--min_RE_sites', '25', '--min_links', '25', '--min_link_density', '0.0001', '--correct_nrounds', '2', '--correct_min_coverage', '10.0']' returned non-zero exit status 2.

[2025-12-18 22:19:41] ğŸ“Š å¤„ç†ç»Ÿè®¡ | Processing Statistics:
[2025-12-18 22:19:41]   â±ï¸ æ€»è€—æ—¶ | Total time: 32946.13ç§’
[2025-12-18 22:19:41] ğŸ’¥ HapHiCæµç¨‹æ‰§è¡Œå¤±è´¥ | HapHiC pipeline execution failed: stat: path should be string, bytes, os.PathLike or integer, not NoneType
âŒ HapHiC scaffoldingå¤±è´¥!
Job 68572373 stderr output:

