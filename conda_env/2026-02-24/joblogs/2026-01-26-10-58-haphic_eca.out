2026-01-26 10:58:57.757 - INFO - HapHiC处理器已初始化|HapHiC processor initialized
2026-01-26 10:58:57.757 - INFO - 配置参数|Configuration Parameters:
2026-01-26 10:58:57.757 - INFO -   assembly_file: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/03.hicanu/EcA/02.fasta/EcA.contigs.fasta
2026-01-26 10:58:57.757 - INFO -   hic_file: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/01.data/clean/EcA_1.clean.fq.gz
2026-01-26 10:58:57.757 - INFO -   hic_file_type: fastq
2026-01-26 10:58:57.757 - INFO -   nchrs: 12
2026-01-26 10:58:57.757 - INFO -   output_dir: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据
2026-01-26 10:58:57.757 - INFO -   prefix: EcA.contigs
2026-01-26 10:58:57.757 - INFO -   threads: 64
2026-01-26 10:58:57.757 - INFO -   processes: 8
2026-01-26 10:58:57.757 - INFO -   quick_view: False
2026-01-26 10:58:57.757 - INFO -   restriction_sites: ['GATC']
2026-01-26 10:58:57.757 - INFO -   correct_nrounds: 2
2026-01-26 10:58:57.757 - INFO -   remove_allelic_links: None
2026-01-26 10:58:57.758 - INFO -   phasing_weight: 1.0
2026-01-26 10:58:57.758 - INFO -   gfa_files: None
2026-01-26 10:58:57.758 - INFO -   haphic_bin: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic
2026-01-26 10:58:57.758 - INFO -   bwa_bin: bwa
2026-01-26 10:58:57.758 - INFO -   samtools_bin: samtools
2026-01-26 10:58:57.758 - INFO - 开始HapHiC流程|Starting HapHiC pipeline
2026-01-26 10:58:57.758 - INFO - 系统预检查|System pre-flight checks
2026-01-26 10:58:57.758 - INFO - 验证输入文件|Validating input files
2026-01-26 10:58:58.229 - INFO - 基因组序列数量|Assembly sequence count: 670
2026-01-26 10:58:58.229 - INFO - FASTQ文件大小|FASTQ file sizes: R1 0.16 GB, R2 0.17 GB
2026-01-26 10:58:58.229 - INFO - 输入文件验证通过|Input files validated
2026-01-26 10:58:58.229 - INFO - 检查系统资源|Checking system resources
2026-01-26 10:58:58.965 - INFO - 可用内存|Available memory: 455.0 GB
2026-01-26 10:58:58.965 - INFO - 可用磁盘空间|Available disk space: 3918726.0 GB
2026-01-26 10:58:58.965 - INFO - CPU核心数|CPU cores: 88
2026-01-26 10:59:03.912 - INFO - 预检查通过|Pre-flight checks passed
2026-01-26 10:59:03.912 - INFO - 检查已存在的比对结果|Checking for existing alignment results
2026-01-26 10:59:03.912 - INFO - 输出目录: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据
2026-01-26 10:59:03.912 - INFO - 比对目录: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/00.mapping
2026-01-26 10:59:03.912 - INFO - 潜在BAM文件: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/00.mapping/HiC.bam
2026-01-26 10:59:03.912 - INFO - 潜在过滤BAM文件: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/00.mapping/HiC.filtered.bam
2026-01-26 10:59:03.912 - INFO - 比对目录不存在|Alignment directory does not exist
2026-01-26 10:59:03.912 - INFO - 执行BWA比对|Executing BWA alignment
2026-01-26 10:59:03.912 - INFO -  开始BWA比对|Starting BWA alignment (official method)
2026-01-26 10:59:03.913 - INFO -  使用提供的FASTQ文件对|Using provided FASTQ pair: EcA_1.clean.fq.gz
2026-01-26 10:59:03.913 - INFO -  找到 1 对FASTQ文件|Found 1 FASTQ pairs
2026-01-26 10:59:03.913 - INFO -  创建基因组软链接|Created assembly symlink: assembly.fa
2026-01-26 10:59:03.913 - INFO -  创建FASTQ软链接|Created FASTQ symlinks: read1_1.fastq.gz, read2_1.fastq.gz
2026-01-26 10:59:03.914 - INFO -  创建BWA索引|Creating BWA index: assembly.fa
2026-01-26 11:01:19.291 - INFO -  BWA索引创建完成|BWA index created
2026-01-26 11:01:19.291 - INFO -  步骤1: BWA比对 + 去重 + 初步过滤 (使用 64 线程)|Step 1: BWA alignment + deduplication + initial filtering (using 64 threads)
2026-01-26 11:01:19.297 - INFO -  执行BWA比对管道|Executing BWA alignment pipeline
2026-01-26 11:02:36.002 - INFO -  BWA比对完成，生成 HiC.bam
2026-01-26 11:02:36.002 - INFO -  BAM文件大小: 505.12 MB
2026-01-26 11:02:36.002 - INFO -  步骤2: HapHiC过滤|Step 2: HapHiC filtering
2026-01-26 11:02:45.524 - INFO -  HapHiC过滤完成，生成 HiC.filtered.bam
2026-01-26 11:02:45.524 - INFO -  过滤后BAM文件大小: 335.14 MB
2026-01-26 11:02:45.524 - INFO -  BWA比对完成|BWA alignment completed: HiC.filtered.bam
2026-01-26 11:02:45.524 - INFO -  开始HapHiC Pipeline流程|Starting HapHiC Pipeline
2026-01-26 11:02:45.524 - INFO -  设置目录结构|Setting up directory structure
2026-01-26 11:02:45.525 - INFO -  目录结构设置完成|Directory structure setup complete
2026-01-26 11:02:45.525 - INFO -  检查HapHiC Pipeline完成状态|Checking HapHiC Pipeline completion status
2026-01-26 11:02:45.525 - INFO -  Cluster步骤未完成|Cluster step not completed
2026-01-26 11:02:45.525 - INFO -    期待文件: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/01.cluster/corrected_asm.fa, /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/01.cluster/paired_links.clm
2026-01-26 11:02:45.525 - INFO -  Reassign步骤未完成|Reassign step not completed
2026-01-26 11:02:45.525 - INFO -    期待文件: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/02.reassign/final_groups/final_clusters.txt
2026-01-26 11:02:45.525 - INFO -  Sort步骤未完成|Sort step not completed
2026-01-26 11:02:45.525 - INFO -    期待文件: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/03.sort/*.tour (0 files)
2026-01-26 11:02:45.525 - INFO -  Build步骤未完成|Build step not completed
2026-01-26 11:02:45.525 - INFO -    期待文件: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/04.build/EcA.contigs.fa, /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/04.build/EcA.contigs.agp
2026-01-26 11:02:45.525 - INFO -  运行HapHiC Pipeline|Running HapHiC Pipeline
2026-01-26 11:02:45.525 - INFO -  HapHiC将处理已存在的目录|HapHiC will handle existing directories
2026-01-26 11:02:45.525 - INFO -  自动优化分辨率: 500bp (基于覆盖率10.0)
2026-01-26 11:02:45.525 - INFO -  启用组装校正，使用分辨率: 500bp (内存优化)
2026-01-26 11:02:45.525 - INFO -  工作目录: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据
2026-01-26 11:02:45.525 - INFO - HapHiC Pipeline
2026-01-26 11:04:27.094 - INFO - 命令执行成功|Command executed successfully (耗时: 101.57秒)
2026-01-26 11:04:27.094 - INFO - 命令输出|Command Output:
2026-01-26 11:03:46 <HapHiC_pipeline.py> [main] Pipeline started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-26 11:03:46 <HapHiC_pipeline.py> [main] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-26 11:03:46 <HapHiC_pipeline.py> [main] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/03.hicanu/EcA/02.fasta/EcA.contigs.fasta /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/00.mapping/HiC.filtered.bam 12 --aln_format bam --outdir /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据 --RE GATC --steps 1,2,3,4 --threads 64 --processes 8 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000 --Nx 80 --RE_site_cutoff 25 --density_lower 0.2X --density_upper 1.9X --read_depth_upper 1.5X --topN 10 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --expansion 2 --max_iter 200 --pruning 0.0001 --min_group_len 0 --max_ctg_len 10000 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --min_density_ratio 4 --ambiguous_cutoff 0.6 --reassign_nrounds 5 --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --Ns 100 --max_width 60 --prefix EcA.contigs
2026-01-26 11:03:46 <HapHiC_pipeline.py> [main] The directory /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据 already exists
2026-01-26 11:03:46 <HapHiC_pipeline.py> [haphic_cluster] Step1: Execute preprocessing and Markov clustering for contigs...
2026-01-26 11:03:46 <HapHiC_cluster.py> [run] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-26 11:03:46 <HapHiC_cluster.py> [run] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-26 11:03:46 <HapHiC_cluster.py> [run] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/03.hicanu/EcA/02.fasta/EcA.contigs.fasta /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/00.mapping/HiC.filtered.bam 12 --aln_format bam --outdir /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据 --RE GATC --steps 1,2,3,4 --threads 64 --processes 8 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000 --Nx 80 --RE_site_cutoff 25 --density_lower 0.2X --density_upper 1.9X --read_depth_upper 1.5X --topN 10 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --expansion 2 --max_iter 200 --pruning 0.0001 --min_group_len 0 --max_ctg_len 10000 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --min_density_ratio 4 --ambiguous_cutoff 0.6 --reassign_nrounds 5 --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --Ns 100 --max_width 60 --prefix EcA.contigs
2026-01-26 11:03:46 <HapHiC_cluster.py> [parse_fasta] Parsing input FASTA file...
2026-01-26 11:03:48 <HapHiC_cluster.py> [determine_int_type] The longest and second longest contigs are 26226239 bp and 22067089 bp, respectively. The data types for contig positions and CLM distances are calculated to be int32 and int32, respectively.
2026-01-26 11:03:48 <HapHiC_cluster.py> [parse_bam_for_correction] Parsing input BAM file for contig correction...
2026-01-26 11:03:48 <HapHiC_cluster.py> [check_sorting_order] The sorting order of the BAM file is unsorted
2026-01-26 11:03:55 <HapHiC_cluster.py> [correct_assembly] Performing assembly correction...
2026-01-26 11:03:56 <HapHiC_cluster.py> [correct_assembly] Correction round 1, breakpoints are detected in 0 contig(s)
2026-01-26 11:03:56 <HapHiC_cluster.py> [correct_assembly] Generating corrected assembly file...
2026-01-26 11:03:56 <HapHiC_cluster.py> [correct_assembly] No corrected contigs were found. Simply create a symbolic link of the input assembly
2026-01-26 11:03:56 <HapHiC_cluster.py> [stat_fragments] Making some statistics of fragments (contigs / bins)
2026-01-26 11:03:56 <HapHiC_cluster.py> [stat_fragments] bin_size is calculated to be 581932 bp
2026-01-26 11:03:56 <HapHiC_cluster.py> [parse_alignments] Parsing input alignments...
2026-01-26 11:03:56 <HapHiC_cluster.py> [check_sorting_order] The sorting order of the BAM file is unsorted
2026-01-26 11:04:03 <HapHiC_cluster.py> [output_pickle] Writing HT_link_dict to HT_links.pkl...
2026-01-26 11:04:03 <HapHiC_cluster.py> [output_clm] Writing clm_dict to paired_links.clm...
2026-01-26 11:04:04 <HapHiC_cluster.py> [filter_fragments] Filtering fragments...
2026-01-26 11:04:04 <HapHiC_cluster.py> [filter_fragments] [Nx filtering] 289 fragments kept
2026-01-26 11:04:04 <HapHiC_cluster.py> [filter_fragments] [RE sites filtering] 0 fragments removed, 289 fragments kept
2026-01-26 11:04:04 <HapHiC_cluster.py> [filter_fragments] [link density filtering] Parameter --density_lower 0.2X is set to "multiple" mode and equivalent to 0.09342560553633218 in "fraction" mode
2026-01-26 11:04:04 <HapHiC_cluster.py> [filter_fragments] [link density filtering] Parameter --density_upper 1.9X is set to "multiple" mode and equivalent to 1.0 in "fraction" mode
2026-01-26 11:04:04 <HapHiC_cluster.py> [filter_fragments] [link density filtering] 27 fragments removed, 262 fragments kept
2026-01-26 11:04:04 <HapHiC_cluster.py> [filter_fragments] [rank sum filtering] Q1=245.0, median=277.5, Q3=315.75, IQR=Q3-Q1=70.75
2026-01-26 11:04:04 <HapHiC_cluster.py> [filter_fragments] [rank sum filtering] Parameter --rank_sum_upper 1.5X is set to "multiple" mode and equivalent to 0.9236641221374046 in "fraction" mode
2026-01-26 11:04:04 <HapHiC_cluster.py> [filter_fragments] [rank sum filtering] 20 fragments removed, 242 fragments kept
2026-01-26 11:04:04 <HapHiC_cluster.py> [output_pickle] Writing full_link_dict to full_links.pkl...
2026-01-26 11:04:04 <HapHiC_cluster.py> [run] Hi-C linking matrix was constructed in 17.702115535736084s
2026-01-26 11:04:04 <HapHiC_cluster.py> [run_mcl_clustering] Performing Markov clustering...
2026-01-26 11:04:04 <HapHiC_cluster.py> [mcl] The matrix has converged after 6 rounds of iterations (expansion: 2, inflation: 1.0, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:04:04 <HapHiC_cluster.py> [mcl] The matrix has converged after 47 rounds of iterations (expansion: 2, inflation: 1.2, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:04:04 <HapHiC_cluster.py> [mcl] The matrix has converged after 25 rounds of iterations (expansion: 2, inflation: 1.4, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:04:05 <HapHiC_cluster.py> [mcl] The matrix has converged after 17 rounds of iterations (expansion: 2, inflation: 1.6, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:04:05 <HapHiC_cluster.py> [mcl] The matrix has converged after 19 rounds of iterations (expansion: 2, inflation: 1.8, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:04:05 <HapHiC_cluster.py> [mcl] The matrix has converged after 15 rounds of iterations (expansion: 2, inflation: 2.0, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:04:05 <HapHiC_cluster.py> [mcl] The matrix has converged after 11 rounds of iterations (expansion: 2, inflation: 2.2, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:04:05 <HapHiC_cluster.py> [mcl] The matrix has converged after 12 rounds of iterations (expansion: 2, inflation: 2.4, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:04:05 <HapHiC_cluster.py> [mcl] The matrix has converged after 10 rounds of iterations (expansion: 2, inflation: 2.6, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:04:05 <HapHiC_cluster.py> [mcl] The matrix has converged after 11 rounds of iterations (expansion: 2, inflation: 2.8, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:04:05 <HapHiC_cluster.py> [mcl] The matrix has converged after 9 rounds of iterations (expansion: 2, inflation: 3.0, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:04:05 <HapHiC_cluster.py> [recommend_inflation] The length ratio (0.75) might be too strict, trying a lower one...
2026-01-26 11:04:05 <HapHiC_cluster.py> [recommend_inflation] You could try inflation from 2.8 (length ratio = 0.7)
2026-01-26 11:04:05 <HapHiC_cluster.py> [run] 11 round(s) of Markov clustering finished in 1.0092809200286865s, average 0.09175281091169878s per round
2026-01-26 11:04:05 <HapHiC_cluster.py> [output_statistics] Making some statistics for the next HapHiC reassignment step...
2026-01-26 11:04:22 <HapHiC_cluster.py> [run] Program finished in 35.28957438468933s
2026-01-26 11:04:22 <HapHiC_pipeline.py> [haphic_reassign] Step2: Reassign and rescue contigs...
2026-01-26 11:04:22 <HapHiC_reassign.py> [run] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-26 11:04:22 <HapHiC_reassign.py> [run] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-26 11:04:22 <HapHiC_reassign.py> [run] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/03.hicanu/EcA/02.fasta/EcA.contigs.fasta /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/00.mapping/HiC.filtered.bam 12 --aln_format bam --outdir /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据 --RE GATC --steps 1,2,3,4 --threads 64 --processes 8 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000 --Nx 80 --RE_site_cutoff 25 --density_lower 0.2X --density_upper 1.9X --read_depth_upper 1.5X --topN 10 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --expansion 2 --max_iter 200 --pruning 0.0001 --min_group_len 0 --max_ctg_len 10000 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --min_density_ratio 4 --ambiguous_cutoff 0.6 --reassign_nrounds 5 --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --Ns 100 --max_width 60 --prefix EcA.contigs
2026-01-26 11:04:22 <HapHiC_cluster.py> [parse_fasta] Parsing input FASTA file...
2026-01-26 11:04:23 <HapHiC_cluster.py> [determine_int_type] The longest and second longest contigs are 26226239 bp and 22067089 bp, respectively. The data types for contig positions and CLM distances are calculated to be int32 and int32, respectively.
2026-01-26 11:04:23 <HapHiC_reassign.py> [parse_pickle] Parsing input pickle file...
2026-01-26 11:04:23 <HapHiC_reassign.py> [parse_clusters] Parsing .clusters.txt file...
2026-01-26 11:04:23 <HapHiC_reassign.py> [run] File parsing and data preparation finished in 1.2359468936920166s
2026-01-26 11:04:23 <HapHiC_reassign.py> [run_reassignment] Performing reassignment...
2026-01-26 11:04:23 <HapHiC_reassign.py> [run_reassignment] [result::round1] Total: 670, consistent: 1, rescued: 0, reassigned: 4, not rescued: 665
2026-01-26 11:04:23 <HapHiC_reassign.py> [run_reassignment] Performing reassignment...
2026-01-26 11:04:23 <HapHiC_reassign.py> [run_reassignment] [result::round2] Total: 670, consistent: 5, rescued: 1, reassigned: 1, not rescued: 663
2026-01-26 11:04:23 <HapHiC_reassign.py> [run_reassignment] Performing reassignment...
2026-01-26 11:04:23 <HapHiC_reassign.py> [run_reassignment] [result::round3] Total: 670, consistent: 7, rescued: 0, reassigned: 0, not rescued: 663
2026-01-26 11:04:23 <HapHiC_reassign.py> [run] [result::round3] Result has converged after 2 rounds of reassignment, break
2026-01-26 11:04:23 <HapHiC_reassign.py> [run_reassignment] Performing additional round of rescue...
2026-01-26 11:04:23 <HapHiC_reassign.py> [run_reassignment] [result::additional_rescue] Total: 670, consistent: 16, rescued: 0, reassigned: 0, not rescued: 654
2026-01-26 11:04:23 <HapHiC_reassign.py> [run] 3 round(s) of reassignment finished in 0.0033533573150634766s, average 0.0011177857716878254s per round
2026-01-26 11:04:23 <HapHiC_reassign.py> [run] Parameter --nclusters (12) is greater than the number of clusters (9) after reassignment, try higher inflations
2026-01-26 11:04:23 <HapHiC_reassign.py> [split_clm_file] Splitting clm file into subfiles by group...
2026-01-26 11:04:23 <HapHiC_reassign.py> [run] Program finished in 1.3527178764343262s
2026-01-26 11:04:23 <HapHiC_pipeline.py> [haphic_sort] Step3: Order and orient contigs within each group...
2026-01-26 11:04:24 <HapHiC_sort.py> [run] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-26 11:04:24 <HapHiC_sort.py> [run] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-26 11:04:24 <HapHiC_sort.py> [run] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_sort.py /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/01.cluster/corrected_asm.fa /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/01.cluster/HT_links.pkl /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/02.reassign/split_clms /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/02.reassign/final_groups/group5_22067089bp.txt /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/02.reassign/final_groups/group9_3555710bp.txt /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/02.reassign/final_groups/group2_23245717bp.txt /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/02.reassign/final_groups/group8_17501797bp.txt /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/02.reassign/final_groups/group4_22089089bp.txt /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/02.reassign/final_groups/group6_21754172bp.txt /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/02.reassign/final_groups/group3_22264182bp.txt /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/02.reassign/final_groups/group7_18722031bp.txt /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/02.reassign/final_groups/group1_26226239bp.txt --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --processes 8 --flanking_region 0 --density_cal_method multiplication --confidence_cutoff 1
2026-01-26 11:04:24 <HapHiC_sort.py> [run] Checking the path of ALLHiC...
2026-01-26 11:04:24 <HapHiC_sort.py> [run] ALLHiC has been found in /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts
2026-01-26 11:04:24 <HapHiC_sort.py> [parse_fasta] Parsing fasta file...
2026-01-26 11:04:24 <HapHiC_sort.py> [run] Loading input pickle file...
2026-01-26 11:04:24 <HapHiC_sort.py> [run] Parsing group files and clm files...
2026-01-26 11:04:24 <HapHiC_sort.py> [run] Program will be executed in multiprocessing mode (processes=8)
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group5_22067089bp] Performing fast sorting...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group5_22067089bp] Checking the content of input group file...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group5_22067089bp] Only 1 contig in the group file, neither ordering nor orientation is required
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group9_3555710bp] Performing fast sorting...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group9_3555710bp] Checking the content of input group file...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group9_3555710bp] Only 1 contig in the group file, neither ordering nor orientation is required
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group2_23245717bp] Performing fast sorting...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group2_23245717bp] Checking the content of input group file...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group8_17501797bp] Performing fast sorting...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group8_17501797bp] Checking the content of input group file...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group4_22089089bp] Performing fast sorting...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group2_23245717bp] Starting fast sorting iterations...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group8_17501797bp] Only 1 contig in the group file, neither ordering nor orientation is required
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group4_22089089bp] Checking the content of input group file...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group6_21754172bp] Performing fast sorting...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group4_22089089bp] Starting fast sorting iterations...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group3_22264182bp] Performing fast sorting...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group1_26226239bp] Performing fast sorting...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group7_18722031bp] Performing fast sorting...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group6_21754172bp] Checking the content of input group file...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group1_26226239bp] Checking the content of input group file...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group3_22264182bp] Checking the content of input group file...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group7_18722031bp] Checking the content of input group file...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group1_26226239bp] Only 1 contig in the group file, neither ordering nor orientation is required
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group6_21754172bp] Starting fast sorting iterations...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group3_22264182bp] Starting fast sorting iterations...
2026-01-26 11:04:24 <HapHiC_sort.py> [fast_sort] [group7_18722031bp] Starting fast sorting iterations...
2026-01-26 11:04:24 <HapHiC_sort.py> [run] Program finished in 0.6727461814880371s
2026-01-26 11:04:25 <HapHiC_pipeline.py> [haphic_build] Step4: Build final scaffolds (pseudomolecules)...
2026-01-26 11:04:25 <HapHiC_build.py> [run] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-26 11:04:25 <HapHiC_build.py> [run] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-26 11:04:25 <HapHiC_build.py> [run] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/03.hicanu/EcA/02.fasta/EcA.contigs.fasta /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/00.mapping/HiC.filtered.bam 12 --aln_format bam --outdir /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据 --RE GATC --steps 1,2,3,4 --threads 64 --processes 8 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000 --Nx 80 --RE_site_cutoff 25 --density_lower 0.2X --density_upper 1.9X --read_depth_upper 1.5X --topN 10 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --expansion 2 --max_iter 200 --pruning 0.0001 --min_group_len 0 --max_ctg_len 10000 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --min_density_ratio 4 --ambiguous_cutoff 0.6 --reassign_nrounds 5 --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --Ns 100 --max_width 60 --prefix EcA.contigs
2026-01-26 11:04:25 <HapHiC_cluster.py> [parse_fasta] Parsing input FASTA file...
2026-01-26 11:04:26 <HapHiC_build.py> [parse_tours] Parsing tour files...
2026-01-26 11:04:26 <HapHiC_build.py> [build_final_scaffolds] Building final scaffolds...
2026-01-26 11:04:26 <HapHiC_build.py> [run] Program finished in 1.8455190658569336s
2026-01-26 11:04:26 <HapHiC_pipeline.py> [main] HapHiC pipeline finished in 40.05682921409607s
2026-01-26 11:04:27.094 - INFO -  验证Pipeline输出|Verifying pipeline output
2026-01-26 11:04:27.094 - WARNING -  corrected_asm不存在: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/EcA.contigs_corrected.asm.fa
2026-01-26 11:04:27.094 - INFO -  scaffolds_agp: EcA.contigs.agp (31,363 bytes)
2026-01-26 11:04:27.094 - INFO -  scaffolds_raw_agp: EcA.contigs.raw.agp (31,363 bytes)
2026-01-26 11:04:27.094 - INFO -  scaffolds_fasta: EcA.contigs.fa (212,997,004 bytes)
2026-01-26 11:04:27.094 - WARNING -  juicebox_script不存在: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/04.build/EcA.contigs_juicebox.sh
2026-01-26 11:04:27.094 - WARNING -  contact_map不存在: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/EcA.contigs_contact_map.pdf
2026-01-26 11:04:27.094 - WARNING -  hic_file不存在: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/06.juicebox/EcA.contigs.hic
2026-01-26 11:04:27.094 - WARNING -  assembly_file不存在: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/06.juicebox/EcA.contigs.assembly
2026-01-26 11:04:27.095 - INFO -  log_file: EcA.contigs_haphic.log (29,519 bytes)
2026-01-26 11:04:27.095 - INFO -  可视化生成已禁用|Visualization generation disabled
2026-01-26 11:04:27.095 - INFO -  生成Juicebox文件|Generating Juicebox files
2026-01-26 11:04:27.095 - INFO -  步骤1: 生成.mnd文件|Step 1: Generating .mnd file
2026-01-26 11:04:27.095 - INFO - 生成.mnd文件
2026-01-26 11:04:32.529 - INFO - 命令执行成功|Command executed successfully (耗时: 5.43秒)
2026-01-26 11:04:32.529 - INFO - 命令输出|Command Output:
INFO: converting bam to juicer on /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/00.mapping/HiC.filtered.bam
INFO: detected bam filetype
INFO: reading file "/share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/00.mapping/HiC.filtered.bam"
INFO: parsed 1000000 read pairs
2026-01-26 11:04:32.529 - INFO -  步骤2: 排序.mnd文件|Step 2: Sorting .mnd file
2026-01-26 11:04:38.547 - INFO -  步骤3: 生成.assembly文件|Step 3: Generating .assembly file
2026-01-26 11:04:38.547 - INFO - 生成.assembly文件
2026-01-26 11:04:38.626 - INFO - 命令执行成功|Command executed successfully (耗时: 0.08秒)
2026-01-26 11:04:38.627 - INFO -  步骤4: 生成.hic文件|Step 4: Generating .hic file
2026-01-26 11:04:38.627 - INFO -  工作目录|Working directory: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/06.juicebox
2026-01-26 11:04:38.627 - INFO -  Assembly文件|Assembly file: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/06.juicebox/EcA.contigs.assembly
2026-01-26 11:04:38.627 - INFO -  排序后的mnd文件|Sorted mnd file: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/06.juicebox/out.sorted.links.mnd
2026-01-26 11:04:38.627 - INFO -  预期输出.hic文件|Expected .hic file: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/06.juicebox/EcA.contigs.hic
2026-01-26 11:04:38.627 - INFO -  执行命令|Command: bash /share/org/YZWL/yzwl_lixg/software/3d-dna/visualize/run-assembly-visualizer.sh -p false /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/06.juicebox/EcA.contigs.assembly /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/06.juicebox/out.sorted.links.mnd
2026-01-26 11:04:38.627 - INFO -  切换到目录|Changed to directory: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/06.juicebox
2026-01-26 11:04:38.627 - INFO -  开始运行run-assembly-visualizer.sh脚本|Starting run-assembly-visualizer.sh script
2026-01-26 11:04:55.496 - INFO -  脚本执行完成|Script execution completed with return code: 1
2026-01-26 11:04:55.496 - INFO -  检查.hic文件生成状态|Checking .hic file generation status
2026-01-26 11:04:55.496 - INFO -  当前目录内容|Current directory contents:
2026-01-26 11:04:55.525 - INFO -    -rw-r--r-- 1 yzwl_lixg 31542 18M 1月  26 11:04 EcA.contigs.hic
2026-01-26 11:04:55.525 - INFO -  检查可能的.hic文件名|Checking possible .hic filenames:
2026-01-26 11:04:55.526 - INFO -    1. 相对路径(相对名)|Relative filename: EcA.contigs.hic
2026-01-26 11:04:55.526 - INFO -    2. 绝对路径|Absolute path: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/06.juicebox/EcA.contigs.hic
2026-01-26 11:04:55.526 - INFO -    3. assembly.hic|assembly.hic
2026-01-26 11:04:55.526 - INFO -    4. 最终目标|Target: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/06.juicebox/EcA.contigs.hic
2026-01-26 11:04:55.526 - INFO -  文件存在状态|File existence status:
2026-01-26 11:04:55.526 - INFO -    EcA.contigs.hic: True
2026-01-26 11:04:55.526 - INFO -    /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/06.juicebox/EcA.contigs.hic: True
2026-01-26 11:04:55.526 - INFO -    assembly.hic: False
2026-01-26 11:04:55.526 - INFO -    /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/06.juicebox/EcA.contigs.hic: True
2026-01-26 11:04:55.526 - WARNING -  asm-visualizer返回码非0，但.hic文件已生成|asm-visualizer returned non-zero code, but .hic file exists
2026-01-26 11:04:55.526 - WARNING -  返回码|Return code: 1
2026-01-26 11:04:55.526 - INFO -  标准输出完整内容|Full Stdout:
2026-01-26 11:04:55.526 - INFO -    :) -p flag was triggered. Running with GNU Parallel support parameter set to false.
2026-01-26 11:04:55.526 - INFO -    ...Remapping contact data from the original contig set to assembly
2026-01-26 11:04:55.526 - INFO -    ...Building track files
2026-01-26 11:04:55.526 - INFO -    ...Building the hic file
2026-01-26 11:04:55.526 - INFO -    Not including fragment map
2026-01-26 11:04:55.526 - INFO -    Start preprocess
2026-01-26 11:04:55.526 - INFO -    Writing header
2026-01-26 11:04:55.526 - INFO -    Writing body
2026-01-26 11:04:55.526 - INFO -    ..
2026-01-26 11:04:55.526 - INFO -    Writing footer
2026-01-26 11:04:55.526 - INFO -    
2026-01-26 11:04:55.526 - INFO -    Finished preprocess
2026-01-26 11:04:55.526 - INFO -    HiC file version: 8
2026-01-26 11:04:55.526 - INFO -    
2026-01-26 11:04:55.526 - INFO -    Calculating norms for zoom BP_2500000
2026-01-26 11:04:55.526 - INFO -    Calculating norms for zoom BP_1000000
2026-01-26 11:04:55.526 - INFO -    Calculating norms for zoom BP_500000
2026-01-26 11:04:55.526 - INFO -    Calculating norms for zoom BP_250000
2026-01-26 11:04:55.526 - INFO -    Calculating norms for zoom BP_100000
2026-01-26 11:04:55.526 - INFO -    Calculating norms for zoom BP_50000
2026-01-26 11:04:55.526 - INFO -    Calculating norms for zoom BP_25000
2026-01-26 11:04:55.526 - INFO -    Calculating norms for zoom BP_10000
2026-01-26 11:04:55.526 - INFO -    Calculating norms for zoom BP_5000
2026-01-26 11:04:55.526 - INFO -    Calculating norms for zoom BP_1000
2026-01-26 11:04:55.526 - INFO -    Writing expected
2026-01-26 11:04:55.526 - INFO -    Writing norms
2026-01-26 11:04:55.526 - INFO -    Finished writing norms
2026-01-26 11:04:55.526 - INFO -    
2026-01-26 11:04:55.526 - INFO -  查找生成的.hic文件|Looking for generated .hic file: EcA.contigs.hic
2026-01-26 11:04:55.527 - INFO -  .hic文件已在正确位置|.hic file already at correct location: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/06.juicebox/EcA.contigs.hic
2026-01-26 11:04:55.527 - INFO -  .hic文件处理成功|.hic file processing successful: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/06.juicebox/EcA.contigs.hic
2026-01-26 11:04:55.527 - INFO -  验证Juicebox文件|Verifying Juicebox files
2026-01-26 11:04:55.527 - INFO -  Juicebox文件生成成功|Juicebox files generated successfully
2026-01-26 11:04:55.527 - INFO -   .hic文件大小: 17.48 MB
2026-01-26 11:04:55.527 - INFO -   .assembly文件大小: 17.52 KB
2026-01-26 11:04:55.527 - INFO -   文件位置: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/06.juicebox
2026-01-26 11:04:55.527 - INFO -  HapHiC Pipeline完成|HapHiC Pipeline completed in 130.00秒
2026-01-26 11:04:55.527 - INFO - 检测到纠错后的contig，需要重新比对Hi-C数据|Detected corrected contigs, need to realign Hi-C data
2026-01-26 11:04:55.557 - INFO - 创建纠错流程目录|Creating corrected workflow directory: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic
2026-01-26 11:04:55.557 - INFO - 开始重新比对Hi-C数据到纠错后的组装|Starting Hi-C realignment to corrected assembly
2026-01-26 11:04:55.557 - INFO -  开始BWA比对|Starting BWA alignment (official method)
2026-01-26 11:04:55.557 - INFO -  使用纠错后重新比对目录|Using corrected realignment directory
2026-01-26 11:04:55.558 - INFO -  使用提供的FASTQ文件对|Using provided FASTQ pair: EcA_1.clean.fq.gz
2026-01-26 11:04:55.558 - INFO -  找到 1 对FASTQ文件|Found 1 FASTQ pairs
2026-01-26 11:04:55.558 - INFO -  创建基因组软链接|Created assembly symlink: assembly.fa
2026-01-26 11:04:55.558 - INFO -  创建FASTQ软链接|Created FASTQ symlinks: read1_1.fastq.gz, read2_1.fastq.gz
2026-01-26 11:04:55.558 - INFO -  创建BWA索引|Creating BWA index: assembly.fa
2026-01-26 11:07:05.607 - INFO -  BWA索引创建完成|BWA index created
2026-01-26 11:07:05.608 - INFO -  步骤1: BWA比对 + 去重 + 初步过滤 (使用 64 线程)|Step 1: BWA alignment + deduplication + initial filtering (using 64 threads)
2026-01-26 11:07:05.608 - INFO -  创建纠错后的BAM文件|Creating corrected BAM file
2026-01-26 11:07:05.608 - INFO -  执行BWA比对管道|Executing BWA alignment pipeline
2026-01-26 11:08:12.650 - INFO -  BWA比对完成，生成 HiC.corrected.bam
2026-01-26 11:08:12.652 - INFO -  BAM文件大小: 505.12 MB
2026-01-26 11:08:12.652 - INFO -  步骤2: HapHiC过滤|Step 2: HapHiC filtering
2026-01-26 11:08:12.652 - INFO -  创建纠错后的过滤BAM文件|Creating corrected filtered BAM file
2026-01-26 11:08:23.682 - INFO -  HapHiC过滤完成，生成 HiC.corrected.filtered.bam
2026-01-26 11:08:23.683 - INFO -  过滤后BAM文件大小: 335.14 MB
2026-01-26 11:08:23.683 - INFO -  BWA比对完成|BWA alignment completed: HiC.corrected.filtered.bam
2026-01-26 11:08:23.683 - INFO - 开始针对纠错后contig的完整HapHiC流程|Starting complete HapHiC workflow for corrected contigs
2026-01-26 11:08:23.683 - INFO -  开始HapHiC Pipeline流程|Starting HapHiC Pipeline
2026-01-26 11:08:23.683 - INFO -  设置目录结构|Setting up directory structure
2026-01-26 11:08:23.684 - INFO -  目录结构设置完成|Directory structure setup complete
2026-01-26 11:08:23.684 - INFO -  检查HapHiC Pipeline完成状态|Checking HapHiC Pipeline completion status
2026-01-26 11:08:23.684 - INFO -  Cluster步骤未完成|Cluster step not completed
2026-01-26 11:08:23.684 - INFO -    期待文件: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/01.cluster/corrected_asm.fa, /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/01.cluster/paired_links.clm
2026-01-26 11:08:23.684 - INFO -  Reassign步骤未完成|Reassign step not completed
2026-01-26 11:08:23.684 - INFO -    期待文件: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/02.reassign/final_groups/final_clusters.txt
2026-01-26 11:08:23.684 - INFO -  Sort步骤未完成|Sort step not completed
2026-01-26 11:08:23.684 - INFO -    期待文件: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/03.sort/*.tour (0 files)
2026-01-26 11:08:23.684 - INFO -  Build步骤未完成|Build step not completed
2026-01-26 11:08:23.684 - INFO -    期待文件: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/04.build/EcA.contigs_corrected.fa, /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/04.build/EcA.contigs_corrected.agp
2026-01-26 11:08:23.684 - INFO -  运行HapHiC Pipeline|Running HapHiC Pipeline
2026-01-26 11:08:23.684 - INFO -  HapHiC将处理已存在的目录|HapHiC will handle existing directories
2026-01-26 11:08:23.684 - INFO -  自动优化分辨率: 500bp (基于覆盖率10.0)
2026-01-26 11:08:23.684 - INFO -  启用组装校正，使用分辨率: 500bp (内存优化)
2026-01-26 11:08:23.685 - INFO -  工作目录: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic
2026-01-26 11:08:23.685 - INFO - HapHiC Pipeline
2026-01-26 11:08:53.462 - INFO - 命令执行成功|Command executed successfully (耗时: 29.78秒)
2026-01-26 11:08:53.462 - INFO - 命令输出|Command Output:
2026-01-26 11:08:24 <HapHiC_pipeline.py> [main] Pipeline started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-26 11:08:24 <HapHiC_pipeline.py> [main] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-26 11:08:24 <HapHiC_pipeline.py> [main] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/01.cluster/corrected_asm.fa /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/00.mapping_corrected/HiC.corrected.filtered.bam 12 --aln_format bam --outdir /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic --RE GATC --steps 1,2,3,4 --threads 64 --processes 8 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000 --Nx 80 --RE_site_cutoff 25 --density_lower 0.2X --density_upper 1.9X --read_depth_upper 1.5X --topN 10 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --expansion 2 --max_iter 200 --pruning 0.0001 --min_group_len 0 --max_ctg_len 10000 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --min_density_ratio 4 --ambiguous_cutoff 0.6 --reassign_nrounds 5 --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --Ns 100 --max_width 60 --prefix EcA.contigs_corrected
2026-01-26 11:08:24 <HapHiC_pipeline.py> [main] The directory /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic already exists
2026-01-26 11:08:24 <HapHiC_pipeline.py> [haphic_cluster] Step1: Execute preprocessing and Markov clustering for contigs...
2026-01-26 11:08:24 <HapHiC_cluster.py> [run] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-26 11:08:24 <HapHiC_cluster.py> [run] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-26 11:08:24 <HapHiC_cluster.py> [run] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/01.cluster/corrected_asm.fa /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/00.mapping_corrected/HiC.corrected.filtered.bam 12 --aln_format bam --outdir /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic --RE GATC --steps 1,2,3,4 --threads 64 --processes 8 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000 --Nx 80 --RE_site_cutoff 25 --density_lower 0.2X --density_upper 1.9X --read_depth_upper 1.5X --topN 10 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --expansion 2 --max_iter 200 --pruning 0.0001 --min_group_len 0 --max_ctg_len 10000 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --min_density_ratio 4 --ambiguous_cutoff 0.6 --reassign_nrounds 5 --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --Ns 100 --max_width 60 --prefix EcA.contigs_corrected
2026-01-26 11:08:24 <HapHiC_cluster.py> [parse_fasta] Parsing input FASTA file...
2026-01-26 11:08:25 <HapHiC_cluster.py> [determine_int_type] The longest and second longest contigs are 26226239 bp and 22067089 bp, respectively. The data types for contig positions and CLM distances are calculated to be int32 and int32, respectively.
2026-01-26 11:08:25 <HapHiC_cluster.py> [parse_bam_for_correction] Parsing input BAM file for contig correction...
2026-01-26 11:08:25 <HapHiC_cluster.py> [check_sorting_order] The sorting order of the BAM file is unsorted
2026-01-26 11:08:32 <HapHiC_cluster.py> [correct_assembly] Performing assembly correction...
2026-01-26 11:08:33 <HapHiC_cluster.py> [correct_assembly] Correction round 1, breakpoints are detected in 0 contig(s)
2026-01-26 11:08:33 <HapHiC_cluster.py> [correct_assembly] Generating corrected assembly file...
2026-01-26 11:08:33 <HapHiC_cluster.py> [correct_assembly] No corrected contigs were found. Simply create a symbolic link of the input assembly
2026-01-26 11:08:33 <HapHiC_cluster.py> [stat_fragments] Making some statistics of fragments (contigs / bins)
2026-01-26 11:08:33 <HapHiC_cluster.py> [stat_fragments] bin_size is calculated to be 581932 bp
2026-01-26 11:08:34 <HapHiC_cluster.py> [parse_alignments] Parsing input alignments...
2026-01-26 11:08:34 <HapHiC_cluster.py> [check_sorting_order] The sorting order of the BAM file is unsorted
2026-01-26 11:08:41 <HapHiC_cluster.py> [output_pickle] Writing HT_link_dict to HT_links.pkl...
2026-01-26 11:08:41 <HapHiC_cluster.py> [output_clm] Writing clm_dict to paired_links.clm...
2026-01-26 11:08:42 <HapHiC_cluster.py> [filter_fragments] Filtering fragments...
2026-01-26 11:08:42 <HapHiC_cluster.py> [filter_fragments] [Nx filtering] 289 fragments kept
2026-01-26 11:08:42 <HapHiC_cluster.py> [filter_fragments] [RE sites filtering] 0 fragments removed, 289 fragments kept
2026-01-26 11:08:42 <HapHiC_cluster.py> [filter_fragments] [link density filtering] Parameter --density_lower 0.2X is set to "multiple" mode and equivalent to 0.09342560553633218 in "fraction" mode
2026-01-26 11:08:42 <HapHiC_cluster.py> [filter_fragments] [link density filtering] Parameter --density_upper 1.9X is set to "multiple" mode and equivalent to 1.0 in "fraction" mode
2026-01-26 11:08:42 <HapHiC_cluster.py> [filter_fragments] [link density filtering] 27 fragments removed, 262 fragments kept
2026-01-26 11:08:42 <HapHiC_cluster.py> [filter_fragments] [rank sum filtering] Q1=245.0, median=277.5, Q3=315.75, IQR=Q3-Q1=70.75
2026-01-26 11:08:42 <HapHiC_cluster.py> [filter_fragments] [rank sum filtering] Parameter --rank_sum_upper 1.5X is set to "multiple" mode and equivalent to 0.9236641221374046 in "fraction" mode
2026-01-26 11:08:42 <HapHiC_cluster.py> [filter_fragments] [rank sum filtering] 20 fragments removed, 242 fragments kept
2026-01-26 11:08:42 <HapHiC_cluster.py> [output_pickle] Writing full_link_dict to full_links.pkl...
2026-01-26 11:08:42 <HapHiC_cluster.py> [run] Hi-C linking matrix was constructed in 17.636205196380615s
2026-01-26 11:08:42 <HapHiC_cluster.py> [run_mcl_clustering] Performing Markov clustering...
2026-01-26 11:08:42 <HapHiC_cluster.py> [mcl] The matrix has converged after 6 rounds of iterations (expansion: 2, inflation: 1.0, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:08:42 <HapHiC_cluster.py> [mcl] The matrix has converged after 47 rounds of iterations (expansion: 2, inflation: 1.2, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:08:42 <HapHiC_cluster.py> [mcl] The matrix has converged after 25 rounds of iterations (expansion: 2, inflation: 1.4, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:08:43 <HapHiC_cluster.py> [mcl] The matrix has converged after 17 rounds of iterations (expansion: 2, inflation: 1.6, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:08:43 <HapHiC_cluster.py> [mcl] The matrix has converged after 19 rounds of iterations (expansion: 2, inflation: 1.8, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:08:43 <HapHiC_cluster.py> [mcl] The matrix has converged after 15 rounds of iterations (expansion: 2, inflation: 2.0, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:08:43 <HapHiC_cluster.py> [mcl] The matrix has converged after 11 rounds of iterations (expansion: 2, inflation: 2.2, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:08:43 <HapHiC_cluster.py> [mcl] The matrix has converged after 12 rounds of iterations (expansion: 2, inflation: 2.4, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:08:43 <HapHiC_cluster.py> [mcl] The matrix has converged after 10 rounds of iterations (expansion: 2, inflation: 2.6, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:08:43 <HapHiC_cluster.py> [mcl] The matrix has converged after 11 rounds of iterations (expansion: 2, inflation: 2.8, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:08:43 <HapHiC_cluster.py> [mcl] The matrix has converged after 9 rounds of iterations (expansion: 2, inflation: 3.0, maximum iterations: 200, pruning threshold: 0.0001)
2026-01-26 11:08:43 <HapHiC_cluster.py> [recommend_inflation] The length ratio (0.75) might be too strict, trying a lower one...
2026-01-26 11:08:43 <HapHiC_cluster.py> [recommend_inflation] You could try inflation from 2.8 (length ratio = 0.7)
2026-01-26 11:08:43 <HapHiC_cluster.py> [run] 11 round(s) of Markov clustering finished in 1.4486544132232666s, average 0.1316958557475697s per round
2026-01-26 11:08:43 <HapHiC_cluster.py> [output_statistics] Making some statistics for the next HapHiC reassignment step...
2026-01-26 11:08:48 <HapHiC_cluster.py> [run] Program finished in 23.913419008255005s
2026-01-26 11:08:48 <HapHiC_pipeline.py> [haphic_reassign] Step2: Reassign and rescue contigs...
2026-01-26 11:08:48 <HapHiC_reassign.py> [run] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-26 11:08:48 <HapHiC_reassign.py> [run] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-26 11:08:48 <HapHiC_reassign.py> [run] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/01.cluster/corrected_asm.fa /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/00.mapping_corrected/HiC.corrected.filtered.bam 12 --aln_format bam --outdir /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic --RE GATC --steps 1,2,3,4 --threads 64 --processes 8 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000 --Nx 80 --RE_site_cutoff 25 --density_lower 0.2X --density_upper 1.9X --read_depth_upper 1.5X --topN 10 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --expansion 2 --max_iter 200 --pruning 0.0001 --min_group_len 0 --max_ctg_len 10000 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --min_density_ratio 4 --ambiguous_cutoff 0.6 --reassign_nrounds 5 --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --Ns 100 --max_width 60 --prefix EcA.contigs_corrected
2026-01-26 11:08:48 <HapHiC_cluster.py> [parse_fasta] Parsing input FASTA file...
2026-01-26 11:08:49 <HapHiC_cluster.py> [determine_int_type] The longest and second longest contigs are 26226239 bp and 22067089 bp, respectively. The data types for contig positions and CLM distances are calculated to be int32 and int32, respectively.
2026-01-26 11:08:49 <HapHiC_reassign.py> [parse_pickle] Parsing input pickle file...
2026-01-26 11:08:49 <HapHiC_reassign.py> [parse_clusters] Parsing .clusters.txt file...
2026-01-26 11:08:49 <HapHiC_reassign.py> [run] File parsing and data preparation finished in 1.1233344078063965s
2026-01-26 11:08:49 <HapHiC_reassign.py> [run_reassignment] Performing reassignment...
2026-01-26 11:08:49 <HapHiC_reassign.py> [run_reassignment] [result::round1] Total: 670, consistent: 1, rescued: 0, reassigned: 4, not rescued: 665
2026-01-26 11:08:49 <HapHiC_reassign.py> [run_reassignment] Performing reassignment...
2026-01-26 11:08:49 <HapHiC_reassign.py> [run_reassignment] [result::round2] Total: 670, consistent: 5, rescued: 1, reassigned: 1, not rescued: 663
2026-01-26 11:08:49 <HapHiC_reassign.py> [run_reassignment] Performing reassignment...
2026-01-26 11:08:49 <HapHiC_reassign.py> [run_reassignment] [result::round3] Total: 670, consistent: 7, rescued: 0, reassigned: 0, not rescued: 663
2026-01-26 11:08:49 <HapHiC_reassign.py> [run] [result::round3] Result has converged after 2 rounds of reassignment, break
2026-01-26 11:08:49 <HapHiC_reassign.py> [run_reassignment] Performing additional round of rescue...
2026-01-26 11:08:49 <HapHiC_reassign.py> [run_reassignment] [result::additional_rescue] Total: 670, consistent: 16, rescued: 0, reassigned: 0, not rescued: 654
2026-01-26 11:08:49 <HapHiC_reassign.py> [run] 3 round(s) of reassignment finished in 0.005234241485595703s, average 0.0017447471618652344s per round
2026-01-26 11:08:49 <HapHiC_reassign.py> [run] Parameter --nclusters (12) is greater than the number of clusters (9) after reassignment, try higher inflations
2026-01-26 11:08:49 <HapHiC_reassign.py> [split_clm_file] Splitting clm file into subfiles by group...
2026-01-26 11:08:49 <HapHiC_reassign.py> [run] Program finished in 1.2432422637939453s
2026-01-26 11:08:49 <HapHiC_pipeline.py> [haphic_sort] Step3: Order and orient contigs within each group...
2026-01-26 11:08:50 <HapHiC_sort.py> [run] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-26 11:08:50 <HapHiC_sort.py> [run] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-26 11:08:50 <HapHiC_sort.py> [run] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_sort.py /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/01.cluster/corrected_asm.fa /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/01.cluster/HT_links.pkl /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/02.reassign/split_clms /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/02.reassign/final_groups/group5_22067089bp.txt /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/02.reassign/final_groups/group9_3555710bp.txt /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/02.reassign/final_groups/group2_23245717bp.txt /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/02.reassign/final_groups/group8_17501797bp.txt /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/02.reassign/final_groups/group4_22089089bp.txt /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/02.reassign/final_groups/group6_21754172bp.txt /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/02.reassign/final_groups/group3_22264182bp.txt /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/02.reassign/final_groups/group7_18722031bp.txt /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/02.reassign/final_groups/group1_26226239bp.txt --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --processes 8 --flanking_region 0 --density_cal_method multiplication --confidence_cutoff 1
2026-01-26 11:08:50 <HapHiC_sort.py> [run] Checking the path of ALLHiC...
2026-01-26 11:08:50 <HapHiC_sort.py> [run] ALLHiC has been found in /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts
2026-01-26 11:08:50 <HapHiC_sort.py> [parse_fasta] Parsing fasta file...
2026-01-26 11:08:50 <HapHiC_sort.py> [run] Loading input pickle file...
2026-01-26 11:08:50 <HapHiC_sort.py> [run] Parsing group files and clm files...
2026-01-26 11:08:50 <HapHiC_sort.py> [run] Program will be executed in multiprocessing mode (processes=8)
2026-01-26 11:08:50 <HapHiC_sort.py> [fast_sort] [group5_22067089bp] Performing fast sorting...
2026-01-26 11:08:50 <HapHiC_sort.py> [fast_sort] [group5_22067089bp] Checking the content of input group file...
2026-01-26 11:08:50 <HapHiC_sort.py> [fast_sort] [group5_22067089bp] Only 1 contig in the group file, neither ordering nor orientation is required
2026-01-26 11:08:50 <HapHiC_sort.py> [fast_sort] [group9_3555710bp] Performing fast sorting...
2026-01-26 11:08:50 <HapHiC_sort.py> [fast_sort] [group9_3555710bp] Checking the content of input group file...
2026-01-26 11:08:50 <HapHiC_sort.py> [fast_sort] [group9_3555710bp] Only 1 contig in the group file, neither ordering nor orientation is required
2026-01-26 11:08:50 <HapHiC_sort.py> [fast_sort] [group2_23245717bp] Performing fast sorting...
2026-01-26 11:08:50 <HapHiC_sort.py> [fast_sort] [group2_23245717bp] Checking the content of input group file...
2026-01-26 11:08:50 <HapHiC_sort.py> [fast_sort] [group2_23245717bp] Starting fast sorting iterations...
2026-01-26 11:08:50 <HapHiC_sort.py> [fast_sort] [group8_17501797bp] Performing fast sorting...
2026-01-26 11:08:50 <HapHiC_sort.py> [fast_sort] [group4_22089089bp] Performing fast sorting...
2026-01-26 11:08:51 <HapHiC_sort.py> [fast_sort] [group8_17501797bp] Checking the content of input group file...
2026-01-26 11:08:50 <HapHiC_sort.py> [fast_sort] [group6_21754172bp] Performing fast sorting...
2026-01-26 11:08:51 <HapHiC_sort.py> [fast_sort] [group4_22089089bp] Checking the content of input group file...
2026-01-26 11:08:50 <HapHiC_sort.py> [fast_sort] [group3_22264182bp] Performing fast sorting...
2026-01-26 11:08:50 <HapHiC_sort.py> [fast_sort] [group7_18722031bp] Performing fast sorting...
2026-01-26 11:08:50 <HapHiC_sort.py> [fast_sort] [group1_26226239bp] Performing fast sorting...
2026-01-26 11:08:51 <HapHiC_sort.py> [fast_sort] [group8_17501797bp] Only 1 contig in the group file, neither ordering nor orientation is required
2026-01-26 11:08:51 <HapHiC_sort.py> [fast_sort] [group6_21754172bp] Checking the content of input group file...
2026-01-26 11:08:51 <HapHiC_sort.py> [fast_sort] [group3_22264182bp] Checking the content of input group file...
2026-01-26 11:08:51 <HapHiC_sort.py> [fast_sort] [group1_26226239bp] Checking the content of input group file...
2026-01-26 11:08:51 <HapHiC_sort.py> [fast_sort] [group7_18722031bp] Checking the content of input group file...
2026-01-26 11:08:51 <HapHiC_sort.py> [fast_sort] [group4_22089089bp] Starting fast sorting iterations...
2026-01-26 11:08:51 <HapHiC_sort.py> [fast_sort] [group6_21754172bp] Starting fast sorting iterations...
2026-01-26 11:08:51 <HapHiC_sort.py> [fast_sort] [group1_26226239bp] Only 1 contig in the group file, neither ordering nor orientation is required
2026-01-26 11:08:51 <HapHiC_sort.py> [fast_sort] [group3_22264182bp] Starting fast sorting iterations...
2026-01-26 11:08:51 <HapHiC_sort.py> [fast_sort] [group7_18722031bp] Starting fast sorting iterations...
2026-01-26 11:08:51 <HapHiC_sort.py> [run] Program finished in 0.7866451740264893s
2026-01-26 11:08:51 <HapHiC_pipeline.py> [haphic_build] Step4: Build final scaffolds (pseudomolecules)...
2026-01-26 11:08:51 <HapHiC_build.py> [run] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-26 11:08:51 <HapHiC_build.py> [run] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-26 11:08:51 <HapHiC_build.py> [run] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/01.cluster/corrected_asm.fa /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/00.mapping_corrected/HiC.corrected.filtered.bam 12 --aln_format bam --outdir /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic --RE GATC --steps 1,2,3,4 --threads 64 --processes 8 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000 --Nx 80 --RE_site_cutoff 25 --density_lower 0.2X --density_upper 1.9X --read_depth_upper 1.5X --topN 10 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --expansion 2 --max_iter 200 --pruning 0.0001 --min_group_len 0 --max_ctg_len 10000 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --min_density_ratio 4 --ambiguous_cutoff 0.6 --reassign_nrounds 5 --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --Ns 100 --max_width 60 --prefix EcA.contigs_corrected
2026-01-26 11:08:51 <HapHiC_cluster.py> [parse_fasta] Parsing input FASTA file...
2026-01-26 11:08:52 <HapHiC_build.py> [parse_tours] Parsing tour files...
2026-01-26 11:08:52 <HapHiC_build.py> [build_final_scaffolds] Building final scaffolds...
2026-01-26 11:08:53 <HapHiC_build.py> [run] Program finished in 1.8847310543060303s
2026-01-26 11:08:53 <HapHiC_pipeline.py> [main] HapHiC pipeline finished in 28.67789316177368s
2026-01-26 11:08:53.463 - INFO -  验证Pipeline输出|Verifying pipeline output
2026-01-26 11:08:53.463 - WARNING -  corrected_asm不存在: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/EcA.contigs_corrected_corrected.asm.fa
2026-01-26 11:08:53.463 - INFO -  scaffolds_agp: EcA.contigs_corrected.agp (31,363 bytes)
2026-01-26 11:08:53.463 - INFO -  scaffolds_raw_agp: EcA.contigs_corrected.raw.agp (31,363 bytes)
2026-01-26 11:08:53.463 - INFO -  scaffolds_fasta: EcA.contigs_corrected.fa (212,997,004 bytes)
2026-01-26 11:08:53.463 - WARNING -  juicebox_script不存在: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/04.build/EcA.contigs_corrected_juicebox.sh
2026-01-26 11:08:53.463 - WARNING -  contact_map不存在: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/EcA.contigs_corrected_contact_map.pdf
2026-01-26 11:08:53.463 - WARNING -  hic_file不存在: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/06.juicebox/EcA.contigs_corrected.hic
2026-01-26 11:08:53.463 - WARNING -  assembly_file不存在: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/06.juicebox/EcA.contigs_corrected.assembly
2026-01-26 11:08:53.463 - INFO -  log_file: EcA.contigs_haphic.log (66,189 bytes)
2026-01-26 11:08:53.463 - INFO -  可视化生成已禁用|Visualization generation disabled
2026-01-26 11:08:53.463 - INFO -  生成Juicebox文件|Generating Juicebox files
2026-01-26 11:08:53.463 - INFO -  步骤1: 生成.mnd文件|Step 1: Generating .mnd file
2026-01-26 11:08:53.463 - INFO - 生成.mnd文件
2026-01-26 11:08:59.136 - INFO - 命令执行成功|Command executed successfully (耗时: 5.67秒)
2026-01-26 11:08:59.136 - INFO - 命令输出|Command Output:
INFO: converting bam to juicer on /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/00.mapping_corrected/HiC.corrected.filtered.bam
INFO: detected bam filetype
INFO: reading file "/share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/00.mapping_corrected/HiC.corrected.filtered.bam"
INFO: parsed 1000000 read pairs
2026-01-26 11:08:59.136 - INFO -  步骤2: 排序.mnd文件|Step 2: Sorting .mnd file
2026-01-26 11:09:05.232 - INFO -  步骤3: 生成.assembly文件|Step 3: Generating .assembly file
2026-01-26 11:09:05.232 - INFO - 生成.assembly文件
2026-01-26 11:09:05.250 - INFO - 命令执行成功|Command executed successfully (耗时: 0.02秒)
2026-01-26 11:09:05.250 - INFO -  步骤4: 生成.hic文件|Step 4: Generating .hic file
2026-01-26 11:09:05.250 - INFO -  工作目录|Working directory: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/06.juicebox
2026-01-26 11:09:05.250 - INFO -  Assembly文件|Assembly file: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/06.juicebox/EcA.contigs_corrected.assembly
2026-01-26 11:09:05.250 - INFO -  排序后的mnd文件|Sorted mnd file: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/06.juicebox/out.sorted.links.mnd
2026-01-26 11:09:05.250 - INFO -  预期输出.hic文件|Expected .hic file: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/06.juicebox/EcA.contigs_corrected.hic
2026-01-26 11:09:05.250 - INFO -  执行命令|Command: bash /share/org/YZWL/yzwl_lixg/software/3d-dna/visualize/run-assembly-visualizer.sh -p false /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/06.juicebox/EcA.contigs_corrected.assembly /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/06.juicebox/out.sorted.links.mnd
2026-01-26 11:09:05.250 - INFO -  切换到目录|Changed to directory: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/06.juicebox
2026-01-26 11:09:05.250 - INFO -  开始运行run-assembly-visualizer.sh脚本|Starting run-assembly-visualizer.sh script
2026-01-26 11:09:22.028 - INFO -  脚本执行完成|Script execution completed with return code: 1
2026-01-26 11:09:22.028 - INFO -  检查.hic文件生成状态|Checking .hic file generation status
2026-01-26 11:09:22.028 - INFO -  当前目录内容|Current directory contents:
2026-01-26 11:09:22.037 - INFO -    -rw-r--r-- 1 yzwl_lixg 31542 18M 1月  26 11:09 EcA.contigs_corrected.hic
2026-01-26 11:09:22.037 - INFO -  检查可能的.hic文件名|Checking possible .hic filenames:
2026-01-26 11:09:22.037 - INFO -    1. 相对路径(相对名)|Relative filename: EcA.contigs_corrected.hic
2026-01-26 11:09:22.037 - INFO -    2. 绝对路径|Absolute path: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/06.juicebox/EcA.contigs_corrected.hic
2026-01-26 11:09:22.037 - INFO -    3. assembly.hic|assembly.hic
2026-01-26 11:09:22.037 - INFO -    4. 最终目标|Target: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/06.juicebox/EcA.contigs_corrected.hic
2026-01-26 11:09:22.037 - INFO -  文件存在状态|File existence status:
2026-01-26 11:09:22.037 - INFO -    EcA.contigs_corrected.hic: True
2026-01-26 11:09:22.037 - INFO -    /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/06.juicebox/EcA.contigs_corrected.hic: True
2026-01-26 11:09:22.037 - INFO -    assembly.hic: False
2026-01-26 11:09:22.037 - INFO -    /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/06.juicebox/EcA.contigs_corrected.hic: True
2026-01-26 11:09:22.037 - WARNING -  asm-visualizer返回码非0，但.hic文件已生成|asm-visualizer returned non-zero code, but .hic file exists
2026-01-26 11:09:22.037 - WARNING -  返回码|Return code: 1
2026-01-26 11:09:22.037 - INFO -  标准输出完整内容|Full Stdout:
2026-01-26 11:09:22.037 - INFO -    :) -p flag was triggered. Running with GNU Parallel support parameter set to false.
2026-01-26 11:09:22.037 - INFO -    ...Remapping contact data from the original contig set to assembly
2026-01-26 11:09:22.037 - INFO -    ...Building track files
2026-01-26 11:09:22.037 - INFO -    ...Building the hic file
2026-01-26 11:09:22.037 - INFO -    Not including fragment map
2026-01-26 11:09:22.037 - INFO -    Start preprocess
2026-01-26 11:09:22.037 - INFO -    Writing header
2026-01-26 11:09:22.037 - INFO -    Writing body
2026-01-26 11:09:22.037 - INFO -    ..
2026-01-26 11:09:22.037 - INFO -    Writing footer
2026-01-26 11:09:22.037 - INFO -    
2026-01-26 11:09:22.037 - INFO -    Finished preprocess
2026-01-26 11:09:22.037 - INFO -    HiC file version: 8
2026-01-26 11:09:22.037 - INFO -    
2026-01-26 11:09:22.038 - INFO -    Calculating norms for zoom BP_2500000
2026-01-26 11:09:22.038 - INFO -    Calculating norms for zoom BP_1000000
2026-01-26 11:09:22.038 - INFO -    Calculating norms for zoom BP_500000
2026-01-26 11:09:22.038 - INFO -    Calculating norms for zoom BP_250000
2026-01-26 11:09:22.038 - INFO -    Calculating norms for zoom BP_100000
2026-01-26 11:09:22.038 - INFO -    Calculating norms for zoom BP_50000
2026-01-26 11:09:22.038 - INFO -    Calculating norms for zoom BP_25000
2026-01-26 11:09:22.038 - INFO -    Calculating norms for zoom BP_10000
2026-01-26 11:09:22.038 - INFO -    Calculating norms for zoom BP_5000
2026-01-26 11:09:22.038 - INFO -    Calculating norms for zoom BP_1000
2026-01-26 11:09:22.038 - INFO -    Writing expected
2026-01-26 11:09:22.038 - INFO -    Writing norms
2026-01-26 11:09:22.038 - INFO -    Finished writing norms
2026-01-26 11:09:22.038 - INFO -    
2026-01-26 11:09:22.038 - INFO -  查找生成的.hic文件|Looking for generated .hic file: EcA.contigs_corrected.hic
2026-01-26 11:09:22.038 - INFO -  .hic文件已在正确位置|.hic file already at correct location: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/06.juicebox/EcA.contigs_corrected.hic
2026-01-26 11:09:22.038 - INFO -  .hic文件处理成功|.hic file processing successful: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/06.juicebox/EcA.contigs_corrected.hic
2026-01-26 11:09:22.038 - INFO -  验证Juicebox文件|Verifying Juicebox files
2026-01-26 11:09:22.038 - INFO -  Juicebox文件生成成功|Juicebox files generated successfully
2026-01-26 11:09:22.038 - INFO -   .hic文件大小: 17.48 MB
2026-01-26 11:09:22.038 - INFO -   .assembly文件大小: 17.52 KB
2026-01-26 11:09:22.038 - INFO -   文件位置: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/07.corrected_contig_haphic/06.juicebox
2026-01-26 11:09:22.038 - INFO -  HapHiC Pipeline完成|HapHiC Pipeline completed in 58.35秒
2026-01-26 11:09:22.038 - INFO - 纠错后contig的HapHiC流程完成|Corrected contigs HapHiC workflow completed
2026-01-26 11:09:22.038 - INFO - 后处理和验证|Post-processing and validation
2026-01-26 11:09:22.038 - INFO - 验证输出文件|Validating output files
2026-01-26 11:09:22.038 - INFO - scaffolds_fa: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/04.build/EcA.contigs.fa (212,997,004 bytes)
2026-01-26 11:09:22.038 - INFO - scaffolds_agp: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/04.build/EcA.contigs.agp (31,363 bytes)
2026-01-26 11:09:22.038 - INFO - scaffolds_raw_agp: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/04.build/EcA.contigs.raw.agp (31,363 bytes)
2026-01-26 11:09:22.475 - INFO - 输出统计|Output Statistics:
2026-01-26 11:09:22.475 - INFO -   scaffold_count: 663
2026-01-26 11:09:22.475 - INFO -   scaffolds_agp_size: 31363
2026-01-26 11:09:22.475 - INFO -   scaffolds_raw_agp_size: 31363
2026-01-26 11:09:22.475 - INFO -   scaffolds_fasta_size: 212997004
2026-01-26 11:09:22.475 - INFO -   hic_file_size: 18325079
2026-01-26 11:09:22.475 - INFO -   assembly_file_size: 17942
2026-01-26 11:09:22.475 - INFO -   log_file_size: 75902
2026-01-26 11:09:22.486 - INFO - 报告已生成: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/11.EcA基因组组装/04.hic小试数据/EcA.contigs_haphic_report.txt
2026-01-26 11:09:22.486 - INFO - 处理统计|Processing Statistics:
2026-01-26 11:09:22.486 - INFO -   总耗时|Total time: 624.73秒
2026-01-26 11:09:22.486 - INFO -   scaffolds_agp: EcA.contigs.agp (31,363 bytes)
2026-01-26 11:09:22.486 - INFO -   scaffolds_raw_agp: EcA.contigs.raw.agp (31,363 bytes)
2026-01-26 11:09:22.486 - INFO -   scaffolds_fasta: EcA.contigs.fa (212,997,004 bytes)
2026-01-26 11:09:22.486 - INFO -   hic_file: EcA.contigs.hic (18,325,079 bytes)
2026-01-26 11:09:22.486 - INFO -   assembly_file: EcA.contigs.assembly (17,942 bytes)
2026-01-26 11:09:22.486 - INFO -   log_file: EcA.contigs_haphic.log (77,121 bytes)
HapHiC scaffolding完成|HapHiC scaffolding completed!
