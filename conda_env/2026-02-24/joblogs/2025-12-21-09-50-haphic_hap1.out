[2025-12-21 09:50:11] ğŸ§¬ HapHiCå¤„ç†å™¨å·²åˆå§‹åŒ– | HapHiC processor initialized
[2025-12-21 09:50:11] âš™ï¸ é…ç½®å‚æ•° | Configuration Parameters:
[2025-12-21 09:50:11]   assembly_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/02.assembly/OV53_1/02.fasta/OV53_1.hap1.primary.fa
[2025-12-21 09:50:11]   hic_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/01.data/hic/OV53_1-hic_R1.fastq.gz
[2025-12-21 09:50:11]   hic_file_type: fastq
[2025-12-21 09:50:11]   nchrs: 12
[2025-12-21 09:50:11]   output_dir: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/hap1
[2025-12-21 09:50:11]   prefix: OV53_1.hap1.primary
[2025-12-21 09:50:11]   threads: 64
[2025-12-21 09:50:11]   processes: 8
[2025-12-21 09:50:11]   quick_view: False
[2025-12-21 09:50:11]   restriction_sites: ['GATC']
[2025-12-21 09:50:11]   correct_nrounds: 2
[2025-12-21 09:50:11]   remove_allelic_links: None
[2025-12-21 09:50:11]   phasing_weight: 1.0
[2025-12-21 09:50:11]   gfa_files: None
[2025-12-21 09:50:11]   haphic_bin: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic
[2025-12-21 09:50:11]   bwa_bin: bwa
[2025-12-21 09:50:11]   samtools_bin: samtools
[2025-12-21 09:50:11] ğŸš€ å¼€å§‹HapHiCæµç¨‹ | Starting HapHiC pipeline
[2025-12-21 09:50:11] ğŸ” ç³»ç»Ÿé¢„æ£€æŸ¥ | System pre-flight checks
[2025-12-21 09:50:11] ğŸ” éªŒè¯è¾“å…¥æ–‡ä»¶ | Validating input files
[2025-12-21 09:50:12] ğŸ“Š åŸºå› ç»„åºåˆ—æ•°é‡ | Assembly sequence count: 1282
[2025-12-21 09:50:12] ğŸ“Š FASTQæ–‡ä»¶å¤§å° | FASTQ file sizes: R1 60.14 GB, R2 58.01 GB
[2025-12-21 09:50:12] âœ… è¾“å…¥æ–‡ä»¶éªŒè¯é€šè¿‡ | Input files validated
[2025-12-21 09:50:12] ğŸ–¥ï¸ æ£€æŸ¥ç³»ç»Ÿèµ„æº | Checking system resources
[2025-12-21 09:50:13] ğŸ’¾ å¯ç”¨å†…å­˜ | Available memory: 919.9 GB
[2025-12-21 09:50:13] ğŸ’¾ å¯ç”¨ç£ç›˜ç©ºé—´ | Available disk space: 2195252.8 GB
[2025-12-21 09:50:13] ğŸ–¥ï¸ CPUæ ¸å¿ƒæ•° | CPU cores: 88
[2025-12-21 09:50:13] âœ… é¢„æ£€æŸ¥é€šè¿‡ | Pre-flight checks passed
[2025-12-21 09:50:13] ğŸ” æ£€æŸ¥å·²å­˜åœ¨çš„æ¯”å¯¹ç»“æœ | Checking for existing alignment results
[2025-12-21 09:50:13] ğŸ“‚ è¾“å‡ºç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/hap1
[2025-12-21 09:50:13] ğŸ“‚ æ¯”å¯¹ç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/hap1/00.mapping
[2025-12-21 09:50:13] ğŸ“„ æ½œåœ¨BAMæ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/hap1/00.mapping/HiC.bam
[2025-12-21 09:50:13] ğŸ“„ æ½œåœ¨è¿‡æ»¤BAMæ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/hap1/00.mapping/HiC.filtered.bam
[2025-12-21 09:50:13] âœ… æ¯”å¯¹ç›®å½•å­˜åœ¨ | Alignment directory exists
[2025-12-21 09:50:13] ğŸ“‹ æ¯”å¯¹ç›®å½•å†…å®¹: ['assembly.fa.amb', 'assembly.fa.bwt', 'assembly.fa.ann', 'assembly.fa', 'HiC.filtered.bam', 'assembly.fa.pac', 'read1_1.fastq.gz', 'HiC.bam', 'assembly.fa.sa', 'read2_1.fastq.gz']
[2025-12-21 09:50:13] âœ… å‘ç°å·²å­˜åœ¨çš„è¿‡æ»¤BAMæ–‡ä»¶ï¼Œè·³è¿‡BWAæ¯”å¯¹æ­¥éª¤ | Found existing filtered BAM file, skipping BWA alignment: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/hap1/00.mapping/HiC.filtered.bam (69,225,553,169 bytes)
[2025-12-21 09:50:13] âœ… ä½¿ç”¨æŒ‰read nameæ’åºçš„è¿‡æ»¤BAMæ–‡ä»¶ä»¥æ»¡è¶³HapHiCè¦æ±‚ | Using read name-sorted filtered BAM file to meet HapHiC requirements
[2025-12-21 09:50:13] ğŸš€ å¼€å§‹HapHiC Pipelineæµç¨‹ | Starting HapHiC Pipeline
[2025-12-21 09:50:13] ğŸ“ è®¾ç½®ç›®å½•ç»“æ„ | Setting up directory structure
[2025-12-21 09:50:13] âœ… ç›®å½•ç»“æ„è®¾ç½®å®Œæˆ | Directory structure setup complete
[2025-12-21 09:50:13] ğŸ” æ£€æŸ¥HapHiC Pipelineå®ŒæˆçŠ¶æ€ | Checking HapHiC Pipeline completion status
[2025-12-21 09:50:13] âœ… Clusteræ­¥éª¤å·²å®Œæˆ | Cluster step completed
[2025-12-21 09:50:13] âœ… Reassignæ­¥éª¤å·²å®Œæˆ | Reassign step completed
[2025-12-21 09:50:13] âœ… Sortæ­¥éª¤å·²å®Œæˆ | Sort step completed
[2025-12-21 09:50:13] âœ… Buildæ­¥éª¤å·²å®Œæˆ | Build step completed
[2025-12-21 09:50:13] âœ… HapHiC Pipelineå·²å®Œæˆï¼Œè·³è¿‡æ‰§è¡Œ | HapHiC Pipeline already completed, skipping execution
[2025-12-21 09:50:13] ğŸ“Š å¯è§†åŒ–ç”Ÿæˆå·²ç¦ç”¨ | Visualization generation disabled
[2025-12-21 09:50:13] ğŸ” æ£€æµ‹åˆ°ä¸­é—´æ–‡ä»¶å·²å­˜åœ¨ï¼ˆ6.8GBï¼‰ï¼Œå°†è·³è¿‡æ­¥éª¤1-3
[2025-12-21 09:50:13] ğŸ¥¤ ç”ŸæˆJuiceboxæ–‡ä»¶ | Generating Juicebox files
[2025-12-21 09:50:13] ğŸ“‚ Juiceboxç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/hap1/06.juicebox
[2025-12-21 09:50:13] ğŸ¥¤ ä½¿ç”¨Raw AGPæ–‡ä»¶ï¼ˆæ ¼å¼æ›´æ ‡å‡†ï¼‰: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/hap1/04.build/OV53_1.hap1.primary.raw.agp
[2025-12-21 09:50:13] ğŸ” ä½¿ç”¨å·²å­˜åœ¨çš„.mndæ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/hap1/06.juicebox/out.links.mnd
[2025-12-21 09:50:13] ğŸ” ä½¿ç”¨å·²å­˜åœ¨çš„æ’åº.mndæ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/hap1/06.juicebox/out.sorted.links.mnd
[2025-12-21 09:50:13] ğŸ” ä½¿ç”¨å·²å­˜åœ¨çš„.assemblyæ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/hap1/06.juicebox/OV53_1.hap1.primary.assembly
[2025-12-21 09:50:13] ğŸ”§ æ­¥éª¤4: ç”Ÿæˆ.hicæ–‡ä»¶ | Step 4: Generate .hic file
[2025-12-21 09:50:13] ğŸš€ ç”Ÿæˆ.hicæ–‡ä»¶
[2025-12-21 10:04:58] âŒ å‘½ä»¤æ‰§è¡Œå¤±è´¥ | Command failed (è¿”å›ç : 1)
[2025-12-21 10:04:58] å‘½ä»¤è¾“å‡º | Command Output:
:) -p flag was triggered. Running with GNU Parallel support parameter set to false.
...Remapping contact data from the original contig set to assembly
...Building track files
...Building the hic file
Not including fragment map
Start preprocess
Writing header
Writing body
..
Writing footer

Finished preprocess
HiC file version: 8

Calculating norms for zoom BP_2500000
Calculating norms for zoom BP_1000000
Calculating norms for zoom BP_500000
Calculating norms for zoom BP_250000
Calculating norms for zoom BP_100000
Calculating norms for zoom BP_50000
Calculating norms for zoom BP_25000
Calculating norms for zoom BP_10000
Calculating norms for zoom BP_5000
Calculating norms for zoom BP_1000
Writing expected
Writing norms
Finished writing norms
[2025-12-21 10:04:58] âš ï¸ Juiceboxæ–‡ä»¶ç”Ÿæˆå¤±è´¥ï¼Œä½†ç»§ç»­æ‰§è¡Œå…¶ä»–æ­¥éª¤ | Juicebox file generation failed, but continuing with other steps
[2025-12-21 10:04:58] âœ… HapHiC Pipelineå®Œæˆ | HapHiC Pipeline completed in 885.19ç§’
[2025-12-21 10:04:58] ğŸ”„ æ£€æµ‹åˆ°çº é”™åçš„contigï¼Œéœ€è¦é‡æ–°æ¯”å¯¹Hi-Cæ•°æ® | Detected corrected contigs, need to realign Hi-C data
[2025-12-21 10:04:58] ğŸ” è°ƒè¯•ä¿¡æ¯: å½“å‰output_dir = /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/hap1
[2025-12-21 10:04:58] ğŸ” è°ƒè¯•ä¿¡æ¯: è®¡ç®—å‡ºçš„corrected_output_dir = /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/hap1/07.corrected_contig_haphic
[2025-12-21 10:04:58] ğŸ“ åˆ›å»ºçº é”™æµç¨‹ç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/hap1/07.corrected_contig_haphic
[2025-12-21 10:04:58] ğŸ”— å¼€å§‹é‡æ–°æ¯”å¯¹Hi-Cæ•°æ®åˆ°çº é”™åçš„ç»„è£… | Starting Hi-C realignment to corrected assembly
[2025-12-21 10:04:58] ğŸ”— å¼€å§‹BWAæ¯”å¯¹ | Starting BWA alignment (official method)
[2025-12-21 10:04:58] ğŸ“‚ ä½¿ç”¨çº é”™åé‡æ–°æ¯”å¯¹ç›®å½• | Using corrected realignment directory
[2025-12-21 10:04:58] ğŸ“„ ä½¿ç”¨æä¾›çš„FASTQæ–‡ä»¶å¯¹ | Using provided FASTQ pair: OV53_1-hic_R1.fastq.gz
[2025-12-21 10:04:58] ğŸ“„ æ‰¾åˆ° 1 å¯¹FASTQæ–‡ä»¶ | Found 1 FASTQ pairs
[2025-12-21 10:04:58] ğŸ”— åˆ›å»ºåŸºå› ç»„è½¯é“¾æ¥ | Created assembly symlink: assembly.fa
[2025-12-21 10:04:58] ğŸ”— åˆ›å»ºFASTQè½¯é“¾æ¥ | Created FASTQ symlinks: read1_1.fastq.gz, read2_1.fastq.gz
[2025-12-21 10:04:58] ğŸ“ åˆ›å»ºBWAç´¢å¼• | Creating BWA index: assembly.fa
[2025-12-21 10:22:59] âœ… BWAç´¢å¼•åˆ›å»ºå®Œæˆ | BWA index created
[2025-12-21 10:22:59] ğŸ”— æ­¥éª¤1: BWAæ¯”å¯¹ + å»é‡ + åˆæ­¥è¿‡æ»¤ (ä½¿ç”¨ 64 çº¿ç¨‹) | Step 1: BWA alignment + deduplication + initial filtering (using 64 threads)
[2025-12-21 10:22:59] ğŸ“ åˆ›å»ºçº é”™åçš„BAMæ–‡ä»¶ | Creating corrected BAM file
[2025-12-21 10:22:59] ğŸ”„ æ‰§è¡ŒBWAæ¯”å¯¹ç®¡é“ | Executing BWA alignment pipeline
