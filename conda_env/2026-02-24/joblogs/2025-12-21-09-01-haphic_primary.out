[2025-12-21 09:01:56] ğŸ§¬ HapHiCå¤„ç†å™¨å·²åˆå§‹åŒ– | HapHiC processor initialized
[2025-12-21 09:01:56] âš™ï¸ é…ç½®å‚æ•° | Configuration Parameters:
[2025-12-21 09:01:56]   assembly_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/02.assembly/OV53_1/02.fasta/OV53_1.primary.fa
[2025-12-21 09:01:56]   hic_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/01.data/hic/OV53_1-hic_R1.fastq.gz
[2025-12-21 09:01:56]   hic_file_type: fastq
[2025-12-21 09:01:56]   nchrs: 12
[2025-12-21 09:01:56]   output_dir: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary
[2025-12-21 09:01:56]   prefix: OV53_1.primary
[2025-12-21 09:01:56]   threads: 64
[2025-12-21 09:01:56]   processes: 8
[2025-12-21 09:01:56]   quick_view: False
[2025-12-21 09:01:56]   restriction_sites: ['GATC']
[2025-12-21 09:01:56]   correct_nrounds: 2
[2025-12-21 09:01:56]   remove_allelic_links: None
[2025-12-21 09:01:56]   phasing_weight: 1.0
[2025-12-21 09:01:56]   gfa_files: None
[2025-12-21 09:01:56]   haphic_bin: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic
[2025-12-21 09:01:56]   bwa_bin: bwa
[2025-12-21 09:01:56]   samtools_bin: samtools
[2025-12-21 09:01:56] ğŸš€ å¼€å§‹HapHiCæµç¨‹ | Starting HapHiC pipeline
[2025-12-21 09:01:56] ğŸ” ç³»ç»Ÿé¢„æ£€æŸ¥ | System pre-flight checks
[2025-12-21 09:01:56] ğŸ” éªŒè¯è¾“å…¥æ–‡ä»¶ | Validating input files
[2025-12-21 09:01:58] ğŸ“Š åŸºå› ç»„åºåˆ—æ•°é‡ | Assembly sequence count: 1211
[2025-12-21 09:01:58] ğŸ“Š FASTQæ–‡ä»¶å¤§å° | FASTQ file sizes: R1 60.14 GB, R2 58.01 GB
[2025-12-21 09:01:58] âœ… è¾“å…¥æ–‡ä»¶éªŒè¯é€šè¿‡ | Input files validated
[2025-12-21 09:01:58] ğŸ–¥ï¸ æ£€æŸ¥ç³»ç»Ÿèµ„æº | Checking system resources
[2025-12-21 09:01:58] ğŸ’¾ å¯ç”¨å†…å­˜ | Available memory: 878.5 GB
[2025-12-21 09:01:58] ğŸ’¾ å¯ç”¨ç£ç›˜ç©ºé—´ | Available disk space: 2210776.1 GB
[2025-12-21 09:01:58] ğŸ–¥ï¸ CPUæ ¸å¿ƒæ•° | CPU cores: 88
[2025-12-21 09:01:58] âœ… é¢„æ£€æŸ¥é€šè¿‡ | Pre-flight checks passed
[2025-12-21 09:01:58] ğŸ” æ£€æŸ¥å·²å­˜åœ¨çš„æ¯”å¯¹ç»“æœ | Checking for existing alignment results
[2025-12-21 09:01:58] ğŸ“‚ è¾“å‡ºç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary
[2025-12-21 09:01:58] ğŸ“‚ æ¯”å¯¹ç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/00.mapping
[2025-12-21 09:01:58] ğŸ“„ æ½œåœ¨BAMæ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/00.mapping/HiC.bam
[2025-12-21 09:01:58] ğŸ“„ æ½œåœ¨è¿‡æ»¤BAMæ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/00.mapping/HiC.filtered.bam
[2025-12-21 09:01:58] âœ… æ¯”å¯¹ç›®å½•å­˜åœ¨ | Alignment directory exists
[2025-12-21 09:01:58] ğŸ“‹ æ¯”å¯¹ç›®å½•å†…å®¹: ['assembly.fa.amb', 'assembly.fa.bwt', 'assembly.fa.ann', 'assembly.fa', 'HiC.filtered.bam', 'assembly.fa.pac', 'read1_1.fastq.gz', 'HiC.bam', 'assembly.fa.sa', 'read2_1.fastq.gz']
[2025-12-21 09:01:58] âœ… å‘ç°å·²å­˜åœ¨çš„è¿‡æ»¤BAMæ–‡ä»¶ï¼Œè·³è¿‡BWAæ¯”å¯¹æ­¥éª¤ | Found existing filtered BAM file, skipping BWA alignment: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/00.mapping/HiC.filtered.bam (67,442,747,903 bytes)
[2025-12-21 09:01:58] âœ… ä½¿ç”¨æŒ‰read nameæ’åºçš„è¿‡æ»¤BAMæ–‡ä»¶ä»¥æ»¡è¶³HapHiCè¦æ±‚ | Using read name-sorted filtered BAM file to meet HapHiC requirements
[2025-12-21 09:01:58] ğŸš€ å¼€å§‹HapHiC Pipelineæµç¨‹ | Starting HapHiC Pipeline
[2025-12-21 09:01:58] ğŸ“ è®¾ç½®ç›®å½•ç»“æ„ | Setting up directory structure
[2025-12-21 09:01:58] âœ… ç›®å½•ç»“æ„è®¾ç½®å®Œæˆ | Directory structure setup complete
[2025-12-21 09:01:58] ğŸ” æ£€æŸ¥HapHiC Pipelineå®ŒæˆçŠ¶æ€ | Checking HapHiC Pipeline completion status
[2025-12-21 09:01:58] âœ… Clusteræ­¥éª¤å·²å®Œæˆ | Cluster step completed
[2025-12-21 09:01:58] âœ… Reassignæ­¥éª¤å·²å®Œæˆ | Reassign step completed
[2025-12-21 09:01:58] âœ… Sortæ­¥éª¤å·²å®Œæˆ | Sort step completed
[2025-12-21 09:01:58] âœ… Buildæ­¥éª¤å·²å®Œæˆ | Build step completed
[2025-12-21 09:01:58] âœ… HapHiC Pipelineå·²å®Œæˆï¼Œè·³è¿‡æ‰§è¡Œ | HapHiC Pipeline already completed, skipping execution
[2025-12-21 09:01:58] ğŸ“Š ç”ŸæˆHi-Cæ¥è§¦å›¾å¯è§†åŒ– | Generating Hi-C contact map visualization
[2025-12-21 09:01:58] ğŸ“Š ä½¿ç”¨Raw AGPæ–‡ä»¶ï¼ˆæ ¼å¼æ›´æ ‡å‡†ï¼‰: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/04.build/OV53_1.primary.raw.agp
[2025-12-21 09:01:58] ğŸ“Š AGPæ–‡ä»¶é¢„å¤„ç†å®Œæˆ: å…± 2106 è¡Œï¼Œè·³è¿‡ 0 è¡Œï¼Œè¾“å‡ºåˆ° /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/04.build/OV53_1.primary.raw.processed.agp
[2025-12-21 09:01:58] ğŸš€ ç”Ÿæˆå¯è§†åŒ–
[2025-12-21 09:02:03] âŒ å‘½ä»¤æ‰§è¡Œå¤±è´¥ | Command failed (è¿”å›ç : 1)
[2025-12-21 09:02:03] å‘½ä»¤è¾“å‡º | Command Output:
2025-12-21 09:02:03 <HapHiC_plot.py> [main] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2025-12-21 09:02:03 <HapHiC_plot.py> [main] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2025-12-21 09:02:03 <HapHiC_plot.py> [main] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/02.assembly/OV53_1/02.fasta/OV53_1.primary.fa /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/04.build/OV53_1.primary.raw.processed.agp --bin_size 500 --min_len 1
2025-12-21 09:02:03 <HapHiC_plot.py> [parse_agp] Parsing input AGP file...
Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py", line 840, in <module>
    main()
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py", line 808, in main
    ctg_dict, ctg_aln_dict, group_size_dict, frag_set, group_frag_dict = parse_agp(args.agp, bin_size)
                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py", line 60, in parse_agp
    if cols[4] == 'W':
       ~~~~^^^
IndexError: list index out of range
Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic", line 117, in <module>
    subprocess.run(commands, check=True)
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/lib/python3.12/subprocess.py", line 571, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py', '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/02.assembly/OV53_1/02.fasta/OV53_1.primary.fa', '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/04.build/OV53_1.primary.raw.processed.agp', '--bin_size', '500', '--min_len', '1']' returned non-zero exit status 1.
[2025-12-21 09:02:03] âš ï¸ å¯è§†åŒ–ç”Ÿæˆå¤±è´¥ï¼Œä½†ç»§ç»­æ‰§è¡Œå…¶ä»–æ­¥éª¤ | Visualization failed, but continuing with other steps
[2025-12-21 09:02:03] ğŸ¥¤ ç”ŸæˆJuiceboxæ–‡ä»¶ | Generating Juicebox files
[2025-12-21 09:02:03] ğŸ“‚ Juiceboxç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/06.juicebox
[2025-12-21 09:02:03] ğŸ¥¤ ä½¿ç”¨Raw AGPæ–‡ä»¶ï¼ˆæ ¼å¼æ›´æ ‡å‡†ï¼‰: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/04.build/OV53_1.primary.raw.agp
[2025-12-21 09:02:03] ğŸ”§ æ­¥éª¤1: ä½¿ç”¨matlockç”Ÿæˆ.mndæ–‡ä»¶ | Step 1: Generate .mnd file with matlock
[2025-12-21 09:02:03] ğŸš€ ç”Ÿæˆ.mndæ–‡ä»¶
[2025-12-21 09:18:06] âœ… å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully (è€—æ—¶: 962.95ç§’)
[2025-12-21 09:18:06] ğŸ”§ æ­¥éª¤2: æ’åº.mndæ–‡ä»¶ | Step 2: Sorting .mnd file
[2025-12-21 09:37:29] ğŸ”§ æ­¥éª¤3: ç”Ÿæˆ.assemblyæ–‡ä»¶ | Step 3: Generate .assembly file
[2025-12-21 09:37:29] ğŸš€ ç”Ÿæˆassemblyæ–‡ä»¶
[2025-12-21 09:37:30] âœ… å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully (è€—æ—¶: 0.15ç§’)
[2025-12-21 09:37:30] ğŸ”§ æ­¥éª¤4: ç”Ÿæˆ.hicæ–‡ä»¶ | Step 4: Generate .hic file
[2025-12-21 09:37:30] ğŸš€ ç”Ÿæˆ.hicæ–‡ä»¶
[2025-12-21 09:58:38] âŒ å‘½ä»¤æ‰§è¡Œå¤±è´¥ | Command failed (è¿”å›ç : 1)
[2025-12-21 09:58:38] å‘½ä»¤è¾“å‡º | Command Output:
:) -p flag was triggered. Running with GNU Parallel support parameter set to false.
...Remapping contact data from the original contig set to assembly
...Building track files
...Building the hic file
Not including fragment map
Start preprocess
Writing header
Writing body
..
Writing footer

Finished preprocess
HiC file version: 8

Calculating norms for zoom BP_2500000
Calculating norms for zoom BP_1000000
Calculating norms for zoom BP_500000
Calculating norms for zoom BP_250000
Calculating norms for zoom BP_100000
Calculating norms for zoom BP_50000
Calculating norms for zoom BP_25000
Calculating norms for zoom BP_10000
Calculating norms for zoom BP_5000
Calculating norms for zoom BP_1000
Writing expected
Writing norms
Finished writing norms
[2025-12-21 09:58:38] âš ï¸ Juiceboxæ–‡ä»¶ç”Ÿæˆå¤±è´¥ï¼Œä½†ç»§ç»­æ‰§è¡Œå…¶ä»–æ­¥éª¤ | Juicebox file generation failed, but continuing with other steps
[2025-12-21 09:58:38] âœ… HapHiC Pipelineå®Œæˆ | HapHiC Pipeline completed in 3399.65ç§’
[2025-12-21 09:58:38] ğŸ”„ æ£€æµ‹åˆ°çº é”™åçš„contigï¼Œéœ€è¦é‡æ–°æ¯”å¯¹Hi-Cæ•°æ® | Detected corrected contigs, need to realign Hi-C data
[2025-12-21 09:58:38] ğŸ” è°ƒè¯•ä¿¡æ¯: å½“å‰output_dir = /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary
[2025-12-21 09:58:38] ğŸ” è°ƒè¯•ä¿¡æ¯: è®¡ç®—å‡ºçš„corrected_output_dir = /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/07.corrected_contig_haphic
[2025-12-21 09:58:38] ğŸ“ åˆ›å»ºçº é”™æµç¨‹ç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/07.corrected_contig_haphic
[2025-12-21 09:58:38] ğŸ”— å¼€å§‹é‡æ–°æ¯”å¯¹Hi-Cæ•°æ®åˆ°çº é”™åçš„ç»„è£… | Starting Hi-C realignment to corrected assembly
[2025-12-21 09:58:38] ğŸ”— å¼€å§‹BWAæ¯”å¯¹ | Starting BWA alignment (official method)
[2025-12-21 09:58:38] ğŸ“‚ ä½¿ç”¨çº é”™åé‡æ–°æ¯”å¯¹ç›®å½• | Using corrected realignment directory
[2025-12-21 09:58:38] ğŸ“„ ä½¿ç”¨æä¾›çš„FASTQæ–‡ä»¶å¯¹ | Using provided FASTQ pair: OV53_1-hic_R1.fastq.gz
[2025-12-21 09:58:38] ğŸ“„ æ‰¾åˆ° 1 å¯¹FASTQæ–‡ä»¶ | Found 1 FASTQ pairs
[2025-12-21 09:58:38] ğŸ”— åˆ›å»ºåŸºå› ç»„è½¯é“¾æ¥ | Created assembly symlink: assembly.fa
[2025-12-21 09:58:38] ğŸ”— åˆ›å»ºFASTQè½¯é“¾æ¥ | Created FASTQ symlinks: read1_1.fastq.gz, read2_1.fastq.gz
[2025-12-21 09:58:38] ğŸ“ åˆ›å»ºBWAç´¢å¼• | Creating BWA index: assembly.fa
[2025-12-21 10:19:23] âœ… BWAç´¢å¼•åˆ›å»ºå®Œæˆ | BWA index created
[2025-12-21 10:19:23] ğŸ”— æ­¥éª¤1: BWAæ¯”å¯¹ + å»é‡ + åˆæ­¥è¿‡æ»¤ (ä½¿ç”¨ 64 çº¿ç¨‹) | Step 1: BWA alignment + deduplication + initial filtering (using 64 threads)
[2025-12-21 10:19:23] ğŸ“ åˆ›å»ºçº é”™åçš„BAMæ–‡ä»¶ | Creating corrected BAM file
[2025-12-21 10:19:23] ğŸ”„ æ‰§è¡ŒBWAæ¯”å¯¹ç®¡é“ | Executing BWA alignment pipeline
