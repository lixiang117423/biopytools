2026-02-10 15:31:21.150 - INFO - HapHiC处理器已初始化|HapHiC processor initialized
2026-02-10 15:31:21.151 - INFO - 配置参数|Configuration Parameters:
2026-02-10 15:31:21.151 - INFO -   assembly_file: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/01.data/genome/genome.fa
2026-02-10 15:31:21.151 - INFO -   hic_file: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/01.data/hic/clean/68-1-hic_1.clean.fq.gz
2026-02-10 15:31:21.151 - INFO -   hic_file_type: fastq
2026-02-10 15:31:21.151 - INFO -   nchrs: 12
2026-02-10 15:31:21.151 - INFO -   output_dir: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据
2026-02-10 15:31:21.151 - INFO -   prefix: genome
2026-02-10 15:31:21.151 - INFO -   threads: 64
2026-02-10 15:31:21.151 - INFO -   processes: 8
2026-02-10 15:31:21.151 - INFO -   quick_view: False
2026-02-10 15:31:21.151 - INFO -   restriction_sites: ['GATC']
2026-02-10 15:31:21.151 - INFO -   correct_nrounds: 2
2026-02-10 15:31:21.151 - INFO -   remove_allelic_links: None
2026-02-10 15:31:21.151 - INFO -   phasing_weight: 1.0
2026-02-10 15:31:21.151 - INFO -   gfa_files: None
2026-02-10 15:31:21.151 - INFO -   haphic_bin: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic
2026-02-10 15:31:21.151 - INFO -   bwa_bin: bwa
2026-02-10 15:31:21.151 - INFO -   samtools_bin: samtools
2026-02-10 15:31:21.151 - INFO - 开始HapHiC流程|Starting HapHiC pipeline
2026-02-10 15:31:21.151 - INFO - 系统预检查|System pre-flight checks
2026-02-10 15:31:21.151 - INFO - 验证输入文件|Validating input files
2026-02-10 15:31:21.921 - INFO - 基因组序列数量|Assembly sequence count: 239
2026-02-10 15:31:21.921 - INFO - FASTQ文件大小|FASTQ file sizes: R1 0.30 GB, R2 0.31 GB
2026-02-10 15:31:21.921 - INFO - 输入文件验证通过|Input files validated
2026-02-10 15:31:21.921 - INFO - 检查系统资源|Checking system resources
2026-02-10 15:31:22.123 - INFO - 可用内存|Available memory: 457.1 GB
2026-02-10 15:31:22.123 - INFO - 可用磁盘空间|Available disk space: 3803823.7 GB
2026-02-10 15:31:22.123 - INFO - CPU核心数|CPU cores: 88
2026-02-10 15:31:25.069 - INFO - 预检查通过|Pre-flight checks passed
2026-02-10 15:31:25.069 - INFO - 检查已存在的比对结果|Checking for existing alignment results
2026-02-10 15:31:25.069 - INFO - 输出目录: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据
2026-02-10 15:31:25.070 - INFO - 比对目录: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/00.mapping
2026-02-10 15:31:25.070 - INFO - 潜在BAM文件: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/00.mapping/HiC.bam
2026-02-10 15:31:25.070 - INFO - 潜在过滤BAM文件: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/00.mapping/HiC.filtered.bam
2026-02-10 15:31:25.070 - INFO - 比对目录不存在|Alignment directory does not exist
2026-02-10 15:31:25.070 - INFO - 执行BWA比对|Executing BWA alignment
2026-02-10 15:31:25.070 - INFO -  开始BWA比对|Starting BWA alignment (official method)
2026-02-10 15:31:25.070 - INFO -  使用提供的FASTQ文件对|Using provided FASTQ pair: 68-1-hic_1.clean.fq.gz
2026-02-10 15:31:25.070 - INFO -  找到 1 对FASTQ文件|Found 1 FASTQ pairs
2026-02-10 15:31:25.074 - INFO -  创建基因组软链接|Created assembly symlink: assembly.fa
2026-02-10 15:31:25.075 - INFO -  创建FASTQ软链接|Created FASTQ symlinks: read1_1.fastq.gz, read2_1.fastq.gz
2026-02-10 15:31:25.075 - INFO -  创建BWA索引|Creating BWA index: assembly.fa
2026-02-10 15:33:11.693 - INFO -  BWA索引创建完成|BWA index created
2026-02-10 15:33:11.695 - INFO -  步骤1: BWA比对 + 去重 + 初步过滤 (使用 64 线程)|Step 1: BWA alignment + deduplication + initial filtering (using 64 threads)
2026-02-10 15:33:11.698 - INFO -  执行BWA比对管道|Executing BWA alignment pipeline
2026-02-10 15:35:14.040 - INFO -  BWA比对完成，生成 HiC.bam
2026-02-10 15:35:14.041 - INFO -  BAM文件大小: 952.59 MB
2026-02-10 15:35:14.041 - INFO -  步骤2: HapHiC过滤|Step 2: HapHiC filtering
2026-02-10 15:35:29.177 - INFO -  HapHiC过滤完成，生成 HiC.filtered.bam
2026-02-10 15:35:29.178 - INFO -  过滤后BAM文件大小: 650.60 MB
2026-02-10 15:35:29.178 - INFO -  BWA比对完成|BWA alignment completed: HiC.filtered.bam
2026-02-10 15:35:29.178 - INFO -  开始HapHiC Pipeline流程|Starting HapHiC Pipeline
2026-02-10 15:35:29.178 - INFO -  设置目录结构|Setting up directory structure
2026-02-10 15:35:29.178 - INFO -  目录结构设置完成|Directory structure setup complete
2026-02-10 15:35:29.179 - INFO -  检查HapHiC Pipeline完成状态|Checking HapHiC Pipeline completion status
2026-02-10 15:35:29.179 - INFO -  Cluster步骤未完成|Cluster step not completed
2026-02-10 15:35:29.179 - INFO -    期待文件: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/01.cluster/corrected_asm.fa, /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/01.cluster/paired_links.clm
2026-02-10 15:35:29.179 - INFO -  Reassign步骤未完成|Reassign step not completed
2026-02-10 15:35:29.179 - INFO -    期待文件: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/02.reassign/final_groups/final_clusters.txt
2026-02-10 15:35:29.179 - INFO -  Sort步骤未完成|Sort step not completed
2026-02-10 15:35:29.179 - INFO -    期待文件: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/03.sort/*.tour (0 files)
2026-02-10 15:35:29.179 - INFO -  Build步骤未完成|Build step not completed
2026-02-10 15:35:29.179 - INFO -    期待文件: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/04.build/genome.fa, /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/04.build/genome.agp
2026-02-10 15:35:29.179 - INFO -  运行HapHiC Pipeline|Running HapHiC Pipeline
2026-02-10 15:35:29.179 - INFO -  HapHiC将处理已存在的目录|HapHiC will handle existing directories
2026-02-10 15:35:29.179 - INFO -  自动优化分辨率: 500bp (基于覆盖率10.0)
2026-02-10 15:35:29.179 - INFO -  启用组装校正，使用分辨率: 500bp (内存优化)
2026-02-10 15:35:29.179 - INFO -  工作目录: /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据
2026-02-10 15:35:29.179 - INFO - HapHiC Pipeline
2026-02-10 15:36:57.917 - ERROR - 命令执行失败|Command failed (返回码: 1)
2026-02-10 15:36:57.918 - ERROR - 命令输出|Command Output:
2026-02-10 15:36:11 <HapHiC_pipeline.py> [main] Pipeline started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-02-10 15:36:11 <HapHiC_pipeline.py> [main] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-02-10 15:36:11 <HapHiC_pipeline.py> [main] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/01.data/genome/genome.fa /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/00.mapping/HiC.filtered.bam 12 --aln_format bam --outdir /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据 --RE GATC --steps 1,2,3,4 --threads 64 --processes 8 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000 --Nx 80 --RE_site_cutoff 25 --density_lower 0.2X --density_upper 1.9X --read_depth_upper 1.5X --topN 10 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --expansion 2 --max_iter 200 --pruning 0.0001 --min_group_len 0 --max_ctg_len 10000 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --min_density_ratio 4 --ambiguous_cutoff 0.6 --reassign_nrounds 5 --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --Ns 100 --max_width 60 --prefix genome
2026-02-10 15:36:11 <HapHiC_pipeline.py> [main] The directory /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据 already exists
2026-02-10 15:36:11 <HapHiC_pipeline.py> [haphic_cluster] Step1: Execute preprocessing and Markov clustering for contigs...
2026-02-10 15:36:11 <HapHiC_cluster.py> [run] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-02-10 15:36:11 <HapHiC_cluster.py> [run] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-02-10 15:36:11 <HapHiC_cluster.py> [run] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/01.data/genome/genome.fa /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/00.mapping/HiC.filtered.bam 12 --aln_format bam --outdir /share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据 --RE GATC --steps 1,2,3,4 --threads 64 --processes 8 --correct_nrounds 2 --correct_resolution 500 --median_cov_ratio 0.2 --region_len_ratio 0.1 --min_region_cutoff 5000 --Nx 80 --RE_site_cutoff 25 --density_lower 0.2X --density_upper 1.9X --read_depth_upper 1.5X --topN 10 --min_inflation 1.0 --max_inflation 3.0 --inflation_step 0.2 --expansion 2 --max_iter 200 --pruning 0.0001 --min_group_len 0 --max_ctg_len 10000 --min_RE_sites 25 --min_links 25 --min_link_density 0.0001 --min_density_ratio 4 --ambiguous_cutoff 0.6 --reassign_nrounds 5 --skip_allhic --mutprob 0.2 --ngen 5000 --npop 100 --seed 42 --Ns 100 --max_width 60 --prefix genome
2026-02-10 15:36:11 <HapHiC_cluster.py> [parse_fasta] Parsing input FASTA file...
2026-02-10 15:36:12 <HapHiC_cluster.py> [determine_int_type] The longest and second longest contigs are 25801270 bp and 23833094 bp, respectively. The data types for contig positions and CLM distances are calculated to be int32 and int32, respectively.
2026-02-10 15:36:12 <HapHiC_cluster.py> [parse_bam_for_correction] Parsing input BAM file for contig correction...
2026-02-10 15:36:12 <HapHiC_cluster.py> [check_sorting_order] The sorting order of the BAM file is unsorted
2026-02-10 15:36:26 <HapHiC_cluster.py> [correct_assembly] Performing assembly correction...
2026-02-10 15:36:27 <HapHiC_cluster.py> [correct_assembly] Correction round 1, breakpoints are detected in 0 contig(s)
2026-02-10 15:36:27 <HapHiC_cluster.py> [correct_assembly] Generating corrected assembly file...
2026-02-10 15:36:27 <HapHiC_cluster.py> [correct_assembly] No corrected contigs were found. Simply create a symbolic link of the input assembly
2026-02-10 15:36:27 <HapHiC_cluster.py> [stat_fragments] Making some statistics of fragments (contigs / bins)
2026-02-10 15:36:27 <HapHiC_cluster.py> [stat_fragments] bin_size is calculated to be 513937 bp
2026-02-10 15:36:27 <HapHiC_cluster.py> [parse_alignments] Parsing input alignments...
2026-02-10 15:36:27 <HapHiC_cluster.py> [check_sorting_order] The sorting order of the BAM file is unsorted
2026-02-10 15:36:42 <HapHiC_cluster.py> [output_pickle] Writing HT_link_dict to HT_links.pkl...
2026-02-10 15:36:42 <HapHiC_cluster.py> [output_clm] Writing clm_dict to paired_links.clm...
2026-02-10 15:36:43 <HapHiC_cluster.py> [filter_fragments] Filtering fragments...
2026-02-10 15:36:43 <HapHiC_cluster.py> [filter_fragments] [Nx filtering] 289 fragments kept
2026-02-10 15:36:43 <HapHiC_cluster.py> [filter_fragments] [RE sites filtering] 4 fragments removed, 285 fragments kept
2026-02-10 15:36:43 <HapHiC_cluster.py> [filter_fragments] [link density filtering] Parameter --density_lower 0.2X is set to "multiple" mode and equivalent to 0.09473684210526316 in "fraction" mode
2026-02-10 15:36:43 <HapHiC_cluster.py> [filter_fragments] [link density filtering] Parameter --density_upper 1.9X is set to "multiple" mode and equivalent to 1.0 in "fraction" mode
2026-02-10 15:36:43 <HapHiC_cluster.py> [filter_fragments] [link density filtering] 27 fragments removed, 258 fragments kept
2026-02-10 15:36:43 <HapHiC_cluster.py> [filter_fragments] [rank sum filtering] Q1=235.5, median=271.0, Q3=306.0, IQR=Q3-Q1=70.5
2026-02-10 15:36:43 <HapHiC_cluster.py> [filter_fragments] [rank sum filtering] Parameter --rank_sum_upper 1.5X is set to "multiple" mode and equivalent to 0.9263565891472868 in "fraction" mode
2026-02-10 15:36:43 <HapHiC_cluster.py> [filter_fragments] [rank sum filtering] 19 fragments removed, 239 fragments kept
2026-02-10 15:36:43 <HapHiC_cluster.py> [output_pickle] Writing full_link_dict to full_links.pkl...
2026-02-10 15:36:43 <HapHiC_cluster.py> [run] Hi-C linking matrix was constructed in 32.25071310997009s
2026-02-10 15:36:43 <HapHiC_cluster.py> [run_mcl_clustering] Performing Markov clustering...
2026-02-10 15:36:43 <HapHiC_cluster.py> [mcl] The matrix has converged after 6 rounds of iterations (expansion: 2, inflation: 1.0, maximum iterations: 200, pruning threshold: 0.0001)
2026-02-10 15:36:43 <HapHiC_cluster.py> [mcl] The matrix has converged after 42 rounds of iterations (expansion: 2, inflation: 1.2, maximum iterations: 200, pruning threshold: 0.0001)
2026-02-10 15:36:43 <HapHiC_cluster.py> [mcl] The matrix has converged after 25 rounds of iterations (expansion: 2, inflation: 1.4, maximum iterations: 200, pruning threshold: 0.0001)
2026-02-10 15:36:43 <HapHiC_cluster.py> [mcl] The matrix has converged after 15 rounds of iterations (expansion: 2, inflation: 1.6, maximum iterations: 200, pruning threshold: 0.0001)
2026-02-10 15:36:43 <HapHiC_cluster.py> [mcl] The matrix has converged after 17 rounds of iterations (expansion: 2, inflation: 1.8, maximum iterations: 200, pruning threshold: 0.0001)
2026-02-10 15:36:43 <HapHiC_cluster.py> [mcl] The matrix has converged after 15 rounds of iterations (expansion: 2, inflation: 2.0, maximum iterations: 200, pruning threshold: 0.0001)
2026-02-10 15:36:43 <HapHiC_cluster.py> [mcl] The matrix has converged after 14 rounds of iterations (expansion: 2, inflation: 2.2, maximum iterations: 200, pruning threshold: 0.0001)
2026-02-10 15:36:44 <HapHiC_cluster.py> [mcl] The matrix has converged after 13 rounds of iterations (expansion: 2, inflation: 2.4, maximum iterations: 200, pruning threshold: 0.0001)
2026-02-10 15:36:44 <HapHiC_cluster.py> [mcl] The matrix has converged after 11 rounds of iterations (expansion: 2, inflation: 2.6, maximum iterations: 200, pruning threshold: 0.0001)
2026-02-10 15:36:44 <HapHiC_cluster.py> [mcl] The matrix has converged after 12 rounds of iterations (expansion: 2, inflation: 2.8, maximum iterations: 200, pruning threshold: 0.0001)
2026-02-10 15:36:44 <HapHiC_cluster.py> [mcl] The matrix has converged after 12 rounds of iterations (expansion: 2, inflation: 3.0, maximum iterations: 200, pruning threshold: 0.0001)
2026-02-10 15:36:44 <HapHiC_cluster.py> [run_mcl_clustering] The maximum number of clusters (11) is even less than the expected number of chromosomes (12). You could try higher inflation.
2026-02-10 15:36:44 <HapHiC_cluster.py> [run] 11 round(s) of Markov clustering finished in 0.912431001663208s, average 0.08294827287847345s per round
2026-02-10 15:36:44 <HapHiC_cluster.py> [output_statistics] Making some statistics for the next HapHiC reassignment step...
2026-02-10 15:36:57 <HapHiC_cluster.py> [run] Program finished in 46.46864867210388s
Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py", line 536, in <module>
    main()
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py", line 517, in main
    haphic_cluster(args)
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py", line 397, in haphic_cluster
    raise RuntimeError(
RuntimeError: Pipeline Aborted: Inflation recommendation failed. It seems that some chromosomes were grouped together, or the maximum number of clusters is even less than the expected number of chromosomes. For more details, please check out the logs.
Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic", line 117, in <module>
    subprocess.run(commands, check=True)
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/lib/python3.12/subprocess.py", line 571, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_pipeline.py', '/share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/01.data/genome/genome.fa', '/share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据/00.mapping/HiC.filtered.bam', '12', '--aln_format', 'bam', '--outdir', '/share/org/YZWL/yzwl_lixg/project/18.小花糖芥/13.68-1基因组/05.hic小试数据', '--RE', 'GATC', '--steps', '1,2,3,4', '--threads', '64', '--processes', '8', '--correct_nrounds', '2', '--correct_resolution', '500', '--median_cov_ratio', '0.2', '--region_len_ratio', '0.1', '--min_region_cutoff', '5000', '--Nx', '80', '--RE_site_cutoff', '25', '--density_lower', '0.2X', '--density_upper', '1.9X', '--read_depth_upper', '1.5X', '--topN', '10', '--min_inflation', '1.0', '--max_inflation', '3.0', '--inflation_step', '0.2', '--expansion', '2', '--max_iter', '200', '--pruning', '0.0001', '--min_group_len', '0', '--max_ctg_len', '10000', '--min_RE_sites', '25', '--min_links', '25', '--min_link_density', '0.0001', '--min_density_ratio', '4', '--ambiguous_cutoff', '0.6', '--reassign_nrounds', '5', '--skip_allhic', '--mutprob', '0.2', '--ngen', '5000', '--npop', '100', '--seed', '42', '--Ns', '100', '--max_width', '60', '--prefix', 'genome']' returned non-zero exit status 1.
2026-02-10 15:36:57.918 - INFO - 处理统计|Processing Statistics:
2026-02-10 15:36:57.918 - INFO -   总耗时|Total time: 336.77秒
2026-02-10 15:36:57.919 - INFO -   log_file: genome_haphic.log (19,176 bytes)
