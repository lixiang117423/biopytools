2026-01-22 21:24:46.396 - INFO - 开始k-mer统计模式|Starting k-mer counting mode
2026-01-22 21:24:46.396 - INFO - 检测到目录输入模式|Detected directory input mode: fastq
2026-01-22 21:24:46.396 - INFO - 数据模式|Data mode: 双末端|Paired-end
2026-01-22 21:24:46.396 - INFO - 文件模式|File pattern: *_1.clean.fq, *_2.clean.fq
2026-01-22 21:24:46.396 - INFO - 找到 3 个read1文件|Found 3 read1 files
2026-01-22 21:24:46.397 - INFO - 验证通过|Validation passed: 3 个样本|samples
2026-01-22 21:24:46.397 - INFO - 开始统计 3 个样本|Starting to count 3 samples
2026-01-22 21:24:46.397 - INFO - 处理进度|Progress: 1/3: test1
2026-01-22 21:24:46.397 - INFO - 开始统计样本|Starting to count sample: test1
2026-01-22 21:24:46.398 - INFO - 执行步骤|Executing step: 统计样本|Counting sample test1
2026-01-22 21:24:46.398 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc -k51 -ci2 -t64 @/share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test1/input_files.txt test1 /share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test1
2026-01-22 21:24:48.108 - INFO - 命令执行成功|Command executed successfully: 统计样本|Counting sample test1
2026-01-22 21:24:48.108 - INFO - 样本统计完成|Sample counting completed: test1
2026-01-22 21:24:48.109 - INFO - 处理进度|Progress: 2/3: test2
2026-01-22 21:24:48.109 - INFO - 开始统计样本|Starting to count sample: test2
2026-01-22 21:24:48.110 - INFO - 执行步骤|Executing step: 统计样本|Counting sample test2
2026-01-22 21:24:48.110 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc -k51 -ci2 -t64 @/share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test2/input_files.txt test2 /share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test2
2026-01-22 21:24:49.562 - INFO - 命令执行成功|Command executed successfully: 统计样本|Counting sample test2
2026-01-22 21:24:49.562 - INFO - 样本统计完成|Sample counting completed: test2
2026-01-22 21:24:49.563 - INFO - 处理进度|Progress: 3/3: test3
2026-01-22 21:24:49.563 - INFO - 开始统计样本|Starting to count sample: test3
2026-01-22 21:24:49.564 - INFO - 执行步骤|Executing step: 统计样本|Counting sample test3
2026-01-22 21:24:49.564 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc -k51 -ci2 -t64 @/share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test3/input_files.txt test3 /share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test3
2026-01-22 21:24:50.971 - INFO - 命令执行成功|Command executed successfully: 统计样本|Counting sample test3
2026-01-22 21:24:50.973 - INFO - 样本统计完成|Sample counting completed: test3
2026-01-22 21:24:50.974 - INFO - 统计完成|Counting completed: 3/3 个样本成功|samples successful
2026-01-22 21:24:50.974 - INFO - 统计完成|Counting completed: 3/3 个样本成功|samples successful
2026-01-22 21:24:51.149 - INFO - 开始丰度矩阵构建模式|Starting abundance matrix building mode
2026-01-22 21:24:51.149 - INFO - 使用自定义输入目录|Using custom input directory: database/kmc_databases
2026-01-22 21:24:51.149 - INFO - 未指定样本名称，自动扫描数据库|No sample names specified, auto-scanning databases
2026-01-22 21:24:51.149 - INFO - 扫描已存在的KMC数据库|Scanning existing KMC databases
2026-01-22 21:24:51.149 - INFO - 找到 3 个KMC数据库|Found 3 KMC databases
2026-01-22 21:24:51.149 - INFO - 开始构建丰度矩阵|Starting to build abundance matrix: 3 样本|samples
2026-01-22 21:24:51.149 - INFO - 全新构建：使用union生成全局k-mer列表|Fresh build: using union to generate global k-mer list
2026-01-22 21:24:51.149 - INFO - 收集唯一k-mer列表（union+流式处理）|Collecting unique k-mer list (union+streaming)
2026-01-22 21:24:51.149 - INFO - 合并数据库生成全局k-mer列表|Union databases to generate global k-mer list
2026-01-22 21:24:51.151 - INFO - 开始合并 3 个数据库|Starting to union 3 databases
2026-01-22 21:24:51.151 - INFO - 执行步骤|Executing step: 合并数据库 1-2|Union databases 1-2
2026-01-22 21:24:51.151 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc_tools -t64 simple test2 test3 union .temp_union_0
2026-01-22 21:24:52.001 - INFO - 命令执行成功|Command executed successfully: 合并数据库 1-2|Union databases 1-2
2026-01-22 21:24:52.001 - INFO - 执行步骤|Executing step: 合并数据库 3|Union database 3
2026-01-22 21:24:52.001 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc_tools -t64 simple .temp_union_0 test1 union .temp_union_2
2026-01-22 21:24:52.786 - INFO - 命令执行成功|Command executed successfully: 合并数据库 3|Union database 3
2026-01-22 21:24:52.787 - INFO - 数据库合并完成|Database union completed: global_kmers
2026-01-22 21:24:52.787 - INFO - 导出全局k-mer列表|Exporting global k-mer list
2026-01-22 21:24:54.696 - INFO - 添加 ID 列|Adding ID column: database/global_kmers.txt → database/global_kmers_with_id.txt
2026-01-22 21:25:09.797 - INFO - ID 列已添加|ID column added: database/global_kmers_with_id.txt
2026-01-22 21:25:12.207 - INFO - 元数据文件已创建|Metadata file created: database/kmer_metadata.json
2026-01-22 21:25:12.208 - INFO - 保留中间文件用于断点续传|Keeping intermediate files for resuming
2026-01-22 21:25:12.208 - INFO - k-mer列表已生成并添加ID列|K-mer list generated with ID column: database/global_kmers_with_id.txt
2026-01-22 21:25:12.208 - INFO - 共收集到 34676051 个唯一k-mer|Collected 34676051 unique k-mers
2026-01-22 21:25:12.208 - INFO - 初始化矩阵文件|Initializing matrix file
2026-01-22 21:25:12.217 - INFO - 矩阵文件初始化完成|Matrix file initialized
2026-01-22 21:25:12.217 - INFO - k-mer文件大小|K-mer file size: 2.03GB
2026-01-22 21:25:12.217 - INFO - 加载或构建索引|Loading or building index
2026-01-22 21:25:12.217 - INFO - 文件大小 2.03GB < 阈值 10.0GB，使用内存索引|File size 2.03GB < threshold 10.0GB, using memory index
2026-01-22 21:25:12.217 - WARNING - 构建内存索引（可能占用大量内存）|Building in-memory index (may use lots of memory)
2026-01-22 21:25:32.872 - INFO - 内存索引构建完成：34,676,051 k-mers|Memory index built: 34,676,051 k-mers
2026-01-22 21:25:32.874 - INFO - 处理样本|Processing sample 1/3: test2
2026-01-22 21:25:32.874 - INFO - 查询样本丰度|Querying sample abundances: test2
2026-01-22 21:26:03.879 - INFO - 查询完成|Query completed: 84 个k-mer
2026-01-22 21:26:03.880 - INFO - 保存样本丰度|Saving sample abundances: test2
2026-01-22 21:26:03.882 - INFO - 存储类型|Storage type: sparse (类型|type: <class 'str'>)
2026-01-22 21:26:03.882 - INFO - 使用稀疏存储|Using sparse storage
2026-01-22 21:26:03.882 - INFO - 当前数据集大小|Current dataset size: 5201407, 新增|new: 84
2026-01-22 21:26:03.884 - INFO - 数据集已扩展|Dataset resized to: 5201491
2026-01-22 21:26:03.886 - INFO - 样本丰度已保存|Sample abundances saved: test2
2026-01-22 21:26:03.886 - INFO - 处理样本|Processing sample 2/3: test3
2026-01-22 21:26:03.886 - INFO - 查询样本丰度|Querying sample abundances: test3
2026-01-22 21:26:35.166 - INFO - 查询完成|Query completed: 84 个k-mer
2026-01-22 21:26:35.168 - INFO - 保存样本丰度|Saving sample abundances: test3
2026-01-22 21:26:35.169 - INFO - 存储类型|Storage type: sparse (类型|type: <class 'str'>)
2026-01-22 21:26:35.169 - INFO - 使用稀疏存储|Using sparse storage
2026-01-22 21:26:35.169 - INFO - 当前数据集大小|Current dataset size: 5201491, 新增|new: 84
2026-01-22 21:26:35.169 - INFO - 数据集已扩展|Dataset resized to: 5201575
2026-01-22 21:26:35.171 - INFO - 样本丰度已保存|Sample abundances saved: test3
2026-01-22 21:26:35.171 - INFO - 处理样本|Processing sample 3/3: test1
2026-01-22 21:26:35.171 - INFO - 查询样本丰度|Querying sample abundances: test1
2026-01-22 21:27:06.145 - INFO - 查询完成|Query completed: 84 个k-mer
2026-01-22 21:27:06.146 - INFO - 保存样本丰度|Saving sample abundances: test1
2026-01-22 21:27:06.147 - INFO - 存储类型|Storage type: sparse (类型|type: <class 'str'>)
2026-01-22 21:27:06.147 - INFO - 使用稀疏存储|Using sparse storage
2026-01-22 21:27:06.147 - INFO - 当前数据集大小|Current dataset size: 5201575, 新增|new: 84
2026-01-22 21:27:06.147 - INFO - 数据集已扩展|Dataset resized to: 5201659
2026-01-22 21:27:06.149 - INFO - 样本丰度已保存|Sample abundances saved: test1
2026-01-22 21:27:06.149 - INFO - 从文件保存k-mer字典到HDF5|Saving k-mer dictionary from file to HDF5
2026-01-22 21:27:55.643 - INFO - k-mer字典已保存|K-mer dictionary saved: database/kmer_dictionary.h5
2026-01-22 21:27:56.330 - INFO - 丰度矩阵构建完成|Abundance matrix built: database/abundance_matrix.h5
2026-01-22 21:27:57.485 - INFO - 矩阵统计|Matrix statistics:
2026-01-22 21:27:57.485 - INFO -   k-mer数量|K-mer count: 34.68M
2026-01-22 21:27:57.485 - INFO -   样本数量|Sample count: 3
2026-01-22 21:27:57.485 - INFO -   k-mer长度|K-mer size: 21
2026-01-22 21:27:57.485 - INFO -   存储类型|Storage type: sparse
2026-01-22 21:27:57.485 - INFO -   稀疏度|Sparsity: 5.00%
2026-01-22 21:27:57.485 - INFO - 自动导出TSV文件|Auto exporting TSV files
2026-01-22 21:27:57.485 - INFO - 导出丰度文件|Exporting abundance file: database/abundance_matrix.tsv
2026-01-22 21:27:57.485 - ERROR - 程序执行出错|Program execution error: 'KMCMatrixExporter' object has no attribute 'export_to_file'
