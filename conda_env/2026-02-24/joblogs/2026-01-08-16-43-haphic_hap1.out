2026-01-08 16:43:32.820 - INFO - HapHiC处理器已初始化|HapHiC processor initialized
2026-01-08 16:43:32.836 - INFO - 配置参数|Configuration Parameters:
2026-01-08 16:43:32.836 - INFO -   assembly_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/OV53_1.hap1.primary.fa
2026-01-08 16:43:32.836 - INFO -   hic_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/01.data/hic/OV53_1-hic_R1.fastq.gz
2026-01-08 16:43:32.836 - INFO -   hic_file_type: fastq
2026-01-08 16:43:32.836 - INFO -   nchrs: 12
2026-01-08 16:43:32.836 - INFO -   output_dir: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1
2026-01-08 16:43:32.836 - INFO -   prefix: OV53_1.hap1.primary
2026-01-08 16:43:32.836 - INFO -   threads: 64
2026-01-08 16:43:32.836 - INFO -   processes: 8
2026-01-08 16:43:32.836 - INFO -   quick_view: False
2026-01-08 16:43:32.836 - INFO -   restriction_sites: ['GATC']
2026-01-08 16:43:32.836 - INFO -   correct_nrounds: 2
2026-01-08 16:43:32.836 - INFO -   remove_allelic_links: None
2026-01-08 16:43:32.836 - INFO -   phasing_weight: 1.0
2026-01-08 16:43:32.836 - INFO -   gfa_files: None
2026-01-08 16:43:32.836 - INFO -   haphic_bin: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic
2026-01-08 16:43:32.836 - INFO -   bwa_bin: bwa
2026-01-08 16:43:32.836 - INFO -   samtools_bin: samtools
2026-01-08 16:43:32.836 - INFO - 开始HapHiC流程|Starting HapHiC pipeline
2026-01-08 16:43:32.836 - INFO - 系统预检查|System pre-flight checks
2026-01-08 16:43:32.836 - INFO - 验证输入文件|Validating input files
2026-01-08 16:43:33.973 - INFO - 基因组序列数量|Assembly sequence count: 1282
2026-01-08 16:43:33.974 - INFO - FASTQ文件大小|FASTQ file sizes: R1 60.14 GB, R2 58.01 GB
2026-01-08 16:43:33.974 - INFO - 输入文件验证通过|Input files validated
2026-01-08 16:43:33.974 - INFO - 检查系统资源|Checking system resources
2026-01-08 16:43:34.131 - INFO - 可用内存|Available memory: 456.3 GB
2026-01-08 16:43:34.132 - INFO - 可用磁盘空间|Available disk space: 1486728.8 GB
2026-01-08 16:43:34.132 - INFO - CPU核心数|CPU cores: 88
2026-01-08 16:43:36.574 - INFO - 预检查通过|Pre-flight checks passed
2026-01-08 16:43:36.574 - INFO - 检查已存在的比对结果|Checking for existing alignment results
2026-01-08 16:43:36.574 - INFO - 输出目录: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1
2026-01-08 16:43:36.574 - INFO - 比对目录: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/00.mapping
2026-01-08 16:43:36.574 - INFO - 潜在BAM文件: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/00.mapping/HiC.bam
2026-01-08 16:43:36.574 - INFO - 潜在过滤BAM文件: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/00.mapping/HiC.filtered.bam
2026-01-08 16:43:36.574 - INFO - 比对目录存在|Alignment directory exists
2026-01-08 16:43:36.574 - INFO - 比对目录内容: ['assembly.fa.amb', 'assembly.fa.bwt', 'assembly.fa.ann', 'assembly.fa', 'HiC.filtered.bam', 'assembly.fa.pac', 'read1_1.fastq.gz', 'HiC.bam', 'assembly.fa.sa', 'read2_1.fastq.gz']
2026-01-08 16:43:36.575 - INFO - 发现已存在的过滤BAM文件，跳过BWA比对步骤|Found existing filtered BAM file, skipping BWA alignment: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/00.mapping/HiC.filtered.bam (69,225,553,169 bytes)
2026-01-08 16:43:36.575 - INFO - 使用按read name排序的过滤BAM文件以满足HapHiC要求|Using read name-sorted filtered BAM file to meet HapHiC requirements
2026-01-08 16:43:36.575 - INFO -  开始HapHiC Pipeline流程|Starting HapHiC Pipeline
2026-01-08 16:43:36.576 - INFO -  设置目录结构|Setting up directory structure
2026-01-08 16:43:36.577 - INFO -  目录结构设置完成|Directory structure setup complete
2026-01-08 16:43:36.577 - INFO -  检查HapHiC Pipeline完成状态|Checking HapHiC Pipeline completion status
2026-01-08 16:43:36.605 - INFO -  Cluster步骤已完成|Cluster step completed
2026-01-08 16:43:36.605 - INFO -  Reassign步骤已完成|Reassign step completed
2026-01-08 16:43:36.605 - INFO -  Sort步骤已完成|Sort step completed
2026-01-08 16:43:36.605 - INFO -  Build步骤已完成|Build step completed
2026-01-08 16:43:36.605 - INFO -  HapHiC Pipeline已完成，跳过执行|HapHiC Pipeline already completed, skipping execution
2026-01-08 16:43:36.606 - INFO -  可视化生成已禁用|Visualization generation disabled
2026-01-08 16:43:36.607 - INFO -  生成Juicebox文件|Generating Juicebox files
2026-01-08 16:43:36.607 - INFO -  步骤1: 生成.mnd文件|Step 1: Generating .mnd file
2026-01-08 16:43:36.607 - INFO - 生成.mnd文件
2026-01-08 17:00:52.691 - INFO - 命令执行成功|Command executed successfully (耗时: 1036.08秒)
2026-01-08 17:00:52.736 - INFO - 命令输出|Command Output:
INFO: converting bam to juicer on /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/00.mapping/HiC.filtered.bam
INFO: detected bam filetype
INFO: reading file "/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/00.mapping/HiC.filtered.bam"
INFO: parsed 1000000 read pairs
INFO: parsed 2000000 read pairs
INFO: parsed 3000000 read pairs
INFO: parsed 4000000 read pairs
INFO: parsed 5000000 read pairs
INFO: parsed 6000000 read pairs
INFO: parsed 7000000 read pairs
INFO: parsed 8000000 read pairs
INFO: parsed 9000000 read pairs
INFO: parsed 10000000 read pairs
INFO: parsed 11000000 read pairs
INFO: parsed 12000000 read pairs
INFO: parsed 13000000 read pairs
INFO: parsed 14000000 read pairs
INFO: parsed 15000000 read pairs
INFO: parsed 16000000 read pairs
INFO: parsed 17000000 read pairs
INFO: parsed 18000000 read pairs
INFO: parsed 19000000 read pairs
INFO: parsed 20000000 read pairs
INFO: parsed 21000000 read pairs
INFO: parsed 22000000 read pairs
INFO: parsed 23000000 read pairs
INFO: parsed 24000000 read pairs
INFO: parsed 25000000 read pairs
INFO: parsed 26000000 read pairs
INFO: parsed 27000000 read pairs
INFO: parsed 28000000 read pairs
INFO: parsed 29000000 read pairs
INFO: parsed 30000000 read pairs
INFO: parsed 31000000 read pairs
INFO: parsed 32000000 read pairs
INFO: parsed 33000000 read pairs
INFO: parsed 34000000 read pairs
INFO: parsed 35000000 read pairs
INFO: parsed 36000000 read pairs
INFO: parsed 37000000 read pairs
INFO: parsed 38000000 read pairs
INFO: parsed 39000000 read pairs
INFO: parsed 40000000 read pairs
INFO: parsed 41000000 read pairs
INFO: parsed 42000000 read pairs
INFO: parsed 43000000 read pairs
INFO: parsed 44000000 read pairs
INFO: parsed 45000000 read pairs
INFO: parsed 46000000 read pairs
INFO: parsed 47000000 read pairs
INFO: parsed 48000000 read pairs
INFO: parsed 49000000 read pairs
INFO: parsed 50000000 read pairs
INFO: parsed 51000000 read pairs
INFO: parsed 52000000 read pairs
INFO: parsed 53000000 read pairs
INFO: parsed 54000000 read pairs
INFO: parsed 55000000 read pairs
INFO: parsed 56000000 read pairs
INFO: parsed 57000000 read pairs
INFO: parsed 58000000 read pairs
INFO: parsed 59000000 read pairs
INFO: parsed 60000000 read pairs
INFO: parsed 61000000 read pairs
INFO: parsed 62000000 read pairs
INFO: parsed 63000000 read pairs
INFO: parsed 64000000 read pairs
INFO: parsed 65000000 read pairs
INFO: parsed 66000000 read pairs
INFO: parsed 67000000 read pairs
INFO: parsed 68000000 read pairs
INFO: parsed 69000000 read pairs
INFO: parsed 70000000 read pairs
INFO: parsed 71000000 read pairs
INFO: parsed 72000000 read pairs
INFO: parsed 73000000 read pairs
INFO: parsed 74000000 read pairs
INFO: parsed 75000000 read pairs
INFO: parsed 76000000 read pairs
INFO: parsed 77000000 read pairs
INFO: parsed 78000000 read pairs
INFO: parsed 79000000 read pairs
INFO: parsed 80000000 read pairs
INFO: parsed 81000000 read pairs
INFO: parsed 82000000 read pairs
INFO: parsed 83000000 read pairs
INFO: parsed 84000000 read pairs
INFO: parsed 85000000 read pairs
INFO: parsed 86000000 read pairs
INFO: parsed 87000000 read pairs
INFO: parsed 88000000 read pairs
INFO: parsed 89000000 read pairs
INFO: parsed 90000000 read pairs
INFO: parsed 91000000 read pairs
INFO: parsed 92000000 read pairs
INFO: parsed 93000000 read pairs
INFO: parsed 94000000 read pairs
INFO: parsed 95000000 read pairs
INFO: parsed 96000000 read pairs
INFO: parsed 97000000 read pairs
INFO: parsed 98000000 read pairs
INFO: parsed 99000000 read pairs
INFO: parsed 100000000 read pairs
INFO: parsed 101000000 read pairs
INFO: parsed 102000000 read pairs
INFO: parsed 103000000 read pairs
INFO: parsed 104000000 read pairs
INFO: parsed 105000000 read pairs
INFO: parsed 106000000 read pairs
INFO: parsed 107000000 read pairs
INFO: parsed 108000000 read pairs
INFO: parsed 109000000 read pairs
INFO: parsed 110000000 read pairs
INFO: parsed 111000000 read pairs
INFO: parsed 112000000 read pairs
INFO: parsed 113000000 read pairs
INFO: parsed 114000000 read pairs
INFO: parsed 115000000 read pairs
INFO: parsed 116000000 read pairs
INFO: parsed 117000000 read pairs
INFO: parsed 118000000 read pairs
INFO: parsed 119000000 read pairs
INFO: parsed 120000000 read pairs
INFO: parsed 121000000 read pairs
INFO: parsed 122000000 read pairs
INFO: parsed 123000000 read pairs
INFO: parsed 124000000 read pairs
INFO: parsed 125000000 read pairs
INFO: parsed 126000000 read pairs
INFO: parsed 127000000 read pairs
INFO: parsed 128000000 read pairs
INFO: parsed 129000000 read pairs
INFO: parsed 130000000 read pairs
INFO: parsed 131000000 read pairs
INFO: parsed 132000000 read pairs
INFO: parsed 133000000 read pairs
INFO: parsed 134000000 read pairs
INFO: parsed 135000000 read pairs
INFO: parsed 136000000 read pairs
INFO: parsed 137000000 read pairs
INFO: parsed 138000000 read pairs
INFO: parsed 139000000 read pairs
INFO: parsed 140000000 read pairs
INFO: parsed 141000000 read pairs
INFO: parsed 142000000 read pairs
INFO: parsed 143000000 read pairs
INFO: parsed 144000000 read pairs
INFO: parsed 145000000 read pairs
INFO: parsed 146000000 read pairs
INFO: parsed 147000000 read pairs
INFO: parsed 148000000 read pairs
INFO: parsed 149000000 read pairs
INFO: parsed 150000000 read pairs
INFO: parsed 151000000 read pairs
INFO: parsed 152000000 read pairs
INFO: parsed 153000000 read pairs
INFO: parsed 154000000 read pairs
INFO: parsed 155000000 read pairs
INFO: parsed 156000000 read pairs
INFO: parsed 157000000 read pairs
INFO: parsed 158000000 read pairs
INFO: parsed 159000000 read pairs
INFO: parsed 160000000 read pairs
INFO: parsed 161000000 read pairs
INFO: parsed 162000000 read pairs
INFO: parsed 163000000 read pairs
INFO: parsed 164000000 read pairs
INFO: parsed 165000000 read pairs
INFO: parsed 166000000 read pairs
INFO: parsed 167000000 read pairs
INFO: parsed 168000000 read pairs
INFO: parsed 169000000 read pairs
INFO: parsed 170000000 read pairs
INFO: parsed 171000000 read pairs
INFO: parsed 172000000 read pairs
INFO: parsed 173000000 read pairs
INFO: parsed 174000000 read pairs
INFO: parsed 175000000 read pairs
INFO: parsed 176000000 read pairs
INFO: parsed 177000000 read pairs
INFO: parsed 178000000 read pairs
INFO: parsed 179000000 read pairs
INFO: parsed 180000000 read pairs
INFO: parsed 181000000 read pairs
INFO: parsed 182000000 read pairs
INFO: parsed 183000000 read pairs
INFO: parsed 184000000 read pairs
INFO: parsed 185000000 read pairs
INFO: parsed 186000000 read pairs
INFO: parsed 187000000 read pairs
INFO: parsed 188000000 read pairs
INFO: parsed 189000000 read pairs
INFO: parsed 190000000 read pairs
INFO: parsed 191000000 read pairs
INFO: parsed 192000000 read pairs
INFO: parsed 193000000 read pairs
INFO: parsed 194000000 read pairs
INFO: parsed 195000000 read pairs
INFO: parsed 196000000 read pairs
INFO: parsed 197000000 read pairs
INFO: parsed 198000000 read pairs
INFO: parsed 199000000 read pairs
INFO: parsed 200000000 read pairs
INFO: parsed 201000000 read pairs
INFO: parsed 202000000 read pairs
INFO: parsed 203000000 read pairs
INFO: parsed 204000000 read pairs
INFO: parsed 205000000 read pairs
INFO: parsed 206000000 read pairs
INFO: parsed 207000000 read pairs
INFO: parsed 208000000 read pairs
INFO: parsed 209000000 read pairs
INFO: parsed 210000000 read pairs
INFO: parsed 211000000 read pairs
INFO: parsed 212000000 read pairs
INFO: parsed 213000000 read pairs
INFO: parsed 214000000 read pairs
INFO: parsed 215000000 read pairs
INFO: parsed 216000000 read pairs
INFO: parsed 217000000 read pairs
INFO: parsed 218000000 read pairs
INFO: parsed 219000000 read pairs
INFO: parsed 220000000 read pairs
INFO: parsed 221000000 read pairs
INFO: parsed 222000000 read pairs
INFO: parsed 223000000 read pairs
INFO: parsed 224000000 read pairs
INFO: parsed 225000000 read pairs
INFO: parsed 226000000 read pairs
INFO: parsed 227000000 read pairs
INFO: parsed 228000000 read pairs
INFO: parsed 229000000 read pairs
INFO: parsed 230000000 read pairs
INFO: parsed 231000000 read pairs
INFO: parsed 232000000 read pairs
INFO: parsed 233000000 read pairs
INFO: parsed 234000000 read pairs
INFO: parsed 235000000 read pairs
INFO: parsed 236000000 read pairs
INFO: parsed 237000000 read pairs
INFO: parsed 238000000 read pairs
INFO: parsed 239000000 read pairs
INFO: parsed 240000000 read pairs
INFO: parsed 241000000 read pairs
INFO: parsed 242000000 read pairs
INFO: parsed 243000000 read pairs
INFO: parsed 244000000 read pairs
INFO: parsed 245000000 read pairs
INFO: parsed 246000000 read pairs
INFO: parsed 247000000 read pairs
INFO: parsed 248000000 read pairs
INFO: parsed 249000000 read pairs
INFO: parsed 250000000 read pairs
INFO: parsed 251000000 read pairs
INFO: parsed 252000000 read pairs
INFO: parsed 253000000 read pairs
INFO: parsed 254000000 read pairs
INFO: parsed 255000000 read pairs
INFO: parsed 256000000 read pairs
INFO: parsed 257000000 read pairs
INFO: parsed 258000000 read pairs
INFO: parsed 259000000 read pairs
INFO: parsed 260000000 read pairs
INFO: parsed 261000000 read pairs
INFO: parsed 262000000 read pairs
INFO: parsed 263000000 read pairs
INFO: parsed 264000000 read pairs
INFO: parsed 265000000 read pairs
INFO: parsed 266000000 read pairs
INFO: parsed 267000000 read pairs
INFO: parsed 268000000 read pairs
INFO: parsed 269000000 read pairs
INFO: parsed 270000000 read pairs
INFO: parsed 271000000 read pairs
INFO: parsed 272000000 read pairs
INFO: parsed 273000000 read pairs
INFO: parsed 274000000 read pairs
INFO: parsed 275000000 read pairs
INFO: parsed 276000000 read pairs
INFO: parsed 277000000 read pairs
INFO: parsed 278000000 read pairs
INFO: parsed 279000000 read pairs
INFO: parsed 280000000 read pairs
INFO: parsed 281000000 read pairs
INFO: parsed 282000000 read pairs
INFO: parsed 283000000 read pairs
INFO: parsed 284000000 read pairs
INFO: parsed 285000000 read pairs
INFO: parsed 286000000 read pairs
INFO: parsed 287000000 read pairs
INFO: parsed 288000000 read pairs
INFO: parsed 289000000 read pairs
INFO: parsed 290000000 read pairs
INFO: parsed 291000000 read pairs
INFO: parsed 292000000 read pairs
INFO: parsed 293000000 read pairs
INFO: parsed 294000000 read pairs
INFO: parsed 295000000 read pairs
INFO: parsed 296000000 read pairs
INFO: parsed 297000000 read pairs
INFO: parsed 298000000 read pairs
INFO: parsed 299000000 read pairs
INFO: parsed 300000000 read pairs
INFO: parsed 301000000 read pairs
INFO: parsed 302000000 read pairs
INFO: parsed 303000000 read pairs
INFO: parsed 304000000 read pairs
INFO: parsed 305000000 read pairs
INFO: parsed 306000000 read pairs
INFO: parsed 307000000 read pairs
INFO: parsed 308000000 read pairs
INFO: parsed 309000000 read pairs
INFO: parsed 310000000 read pairs
INFO: parsed 311000000 read pairs
INFO: parsed 312000000 read pairs
INFO: parsed 313000000 read pairs
INFO: parsed 314000000 read pairs
INFO: parsed 315000000 read pairs
INFO: parsed 316000000 read pairs
INFO: parsed 317000000 read pairs
INFO: parsed 318000000 read pairs
2026-01-08 17:00:52.737 - INFO -  步骤2: 排序.mnd文件|Step 2: Sorting .mnd file
2026-01-08 17:22:05.249 - INFO -  步骤3: 生成.assembly文件|Step 3: Generating .assembly file
2026-01-08 17:22:05.283 - INFO - 生成.assembly文件
2026-01-08 17:22:05.599 - INFO - 命令执行成功|Command executed successfully (耗时: 0.32秒)
2026-01-08 17:22:05.599 - INFO -  步骤4: 生成.hic文件|Step 4: Generating .hic file
2026-01-08 17:37:20.929 - WARNING -  asm-visualizer返回码非0，但.hic文件已生成|asm-visualizer returned non-zero code, but .hic file exists
2026-01-08 17:37:20.929 - WARNING -  返回码|Return code: 1
2026-01-08 17:37:21.025 - ERROR - Juicebox文件生成失败|Juicebox file generation failed: [Errno 2] No such file or directory: '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/06.juicebox/OV53_1.hap1.primary.hic' -> '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/06.juicebox/OV53_1.hap1.primary.hic'
2026-01-08 17:37:21.025 - WARNING -  Juicebox文件生成失败，但继续执行其他步骤|Juicebox file generation failed, but continuing with other steps
2026-01-08 17:37:21.025 - INFO -  HapHiC Pipeline完成|HapHiC Pipeline completed in 3224.45秒
2026-01-08 17:37:21.027 - INFO - 检测到纠错后的contig，需要重新比对Hi-C数据|Detected corrected contigs, need to realign Hi-C data
2026-01-08 17:37:21.028 - INFO - 创建纠错流程目录|Creating corrected workflow directory: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap1/07.corrected_contig_haphic
2026-01-08 17:37:21.028 - INFO - 开始重新比对Hi-C数据到纠错后的组装|Starting Hi-C realignment to corrected assembly
2026-01-08 17:37:21.028 - INFO -  开始BWA比对|Starting BWA alignment (official method)
2026-01-08 17:37:21.028 - INFO -  使用纠错后重新比对目录|Using corrected realignment directory
2026-01-08 17:37:21.048 - INFO -  使用提供的FASTQ文件对|Using provided FASTQ pair: OV53_1-hic_R1.fastq.gz
2026-01-08 17:37:21.048 - INFO -  找到 1 对FASTQ文件|Found 1 FASTQ pairs
2026-01-08 17:37:21.049 - INFO -  创建基因组软链接|Created assembly symlink: assembly.fa
2026-01-08 17:37:21.049 - INFO -  创建FASTQ软链接|Created FASTQ symlinks: read1_1.fastq.gz, read2_1.fastq.gz
2026-01-08 17:37:21.071 - INFO -  创建BWA索引|Creating BWA index: assembly.fa
2026-01-08 17:55:42.883 - INFO -  BWA索引创建完成|BWA index created
2026-01-08 17:55:42.911 - INFO -  步骤1: BWA比对 + 去重 + 初步过滤 (使用 64 线程)|Step 1: BWA alignment + deduplication + initial filtering (using 64 threads)
2026-01-08 17:55:42.911 - INFO -  创建纠错后的BAM文件|Creating corrected BAM file
2026-01-08 17:55:42.911 - INFO -  执行BWA比对管道|Executing BWA alignment pipeline
