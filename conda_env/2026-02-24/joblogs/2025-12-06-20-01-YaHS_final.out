
╔══════════════════════════════════════════════════════════════╗
║      🧬 YaHS 高速染色体挂载流程 - 优化版 v4.0              ║
╚══════════════════════════════════════════════════════════════╝

[0;34mℹ️  [2025-12-06 20:01:29] INFO:[0m 流程启动于: 2025-12-06 20:01:29
[0;34mℹ️  [2025-12-06 20:01:29] INFO:[0m 运行节点: c01n0580
[0;34mℹ️  [2025-12-06 20:01:29] INFO:[0m 当前用户: yzwl_lixg
[0;34mℹ️  [2025-12-06 20:01:29] INFO:[0m 日志文件: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/04.YaHS/logs/pipeline_20251206_200129.log

╔══════════════════════════════════════════════════════════════╗
║                  📋 流程配置信息                              ║
╠══════════════════════════════════════════════════════════════╣
║ 工作目录: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/04.YaHS
║ 参考基因组: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/04.YaHS/OV53_1.primary.fa
║ Hi-C R1: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/04.YaHS/fastq/OV53_1-hic_R1.fastq.gz
║ Hi-C R2: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/04.YaHS/fastq/OV53_1-hic_R2.fastq.gz
║ 
║ 线程数: 86
║ Java内存: 604G
║ Sort内存: 201G
║ 限制性酶: GATC
║ 最小长度: 10000 bp
║ 最小MAPQ: 30
╚══════════════════════════════════════════════════════════════╝

[0;36m🔹 [2025-12-06 20:01:29] STEP:[0m 开始环境检查
[0;34mℹ️  [2025-12-06 20:01:29] INFO:[0m 检查 Java 版本:
openjdk version "17.0.15-internal" 2025-04-15
OpenJDK Runtime Environment (build 17.0.15-internal+0-adhoc..src)
OpenJDK 64-Bit Server VM (build 17.0.15-internal+0-adhoc..src, mixed mode, sharing)
[0;34mℹ️  [2025-12-06 20:01:30] INFO:[0m ✓ 所有必需工具已安装
[0;34mℹ️  [2025-12-06 20:01:30] INFO:[0m ✓ 所有输入文件验证通过
[0;34mℹ️  [2025-12-06 20:01:30] INFO:[0m ✓ 磁盘空间充足 (可用 2349149G)
[0;32m✅ [2025-12-06 20:01:30] SUCCESS:[0m 环境检查完成

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[0;36m🔹 [2025-12-06 20:01:30] STEP:[0m 步骤 1/6: 构建基因组索引
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[0;34mℹ️  [2025-12-06 20:01:30] INFO:[0m ✓ BWA 索引已存在，跳过
[0;34mℹ️  [2025-12-06 20:01:30] INFO:[0m ✓ SAMtools 索引已存在，跳过
[0;32m✅ [2025-12-06 20:01:30] SUCCESS:[0m 步骤 1 完成 [用时: 00:00:00]

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[0;36m🔹 [2025-12-06 20:01:30] STEP:[0m 步骤 2/6: Hi-C 数据比对与处理
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[0;34mℹ️  [2025-12-06 20:01:30] INFO:[0m ✓ BAM 文件已存在，跳过比对步骤

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[0;36m🔹 [2025-12-06 20:01:30] STEP:[0m 步骤 3/6: YaHS 染色体挂载
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[0;34mℹ️  [2025-12-06 20:01:30] INFO:[0m ✓ Scaffold 文件已存在，跳过 YaHS

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[0;36m🔹 [2025-12-06 20:01:30] STEP:[0m 步骤 4/6: 生成标准 Hi-C 热图
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[0;34mℹ️  [2025-12-06 20:01:30] INFO:[0m ✓ 标准 .hic 文件已存在，跳过

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[0;36m🔹 [2025-12-06 20:01:30] STEP:[0m 步骤 5/6: 生成 JBAT 文件（手动纠错用）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[0;34mℹ️  [2025-12-06 20:01:30] INFO:[0m [1/4] 生成 JBAT 文本格式...
[0;34mℹ️  [2025-12-06 20:03:49] INFO:[0m [2/4] 提取 assembly 大小信息...
[0;34mℹ️  [2025-12-06 20:03:49] INFO:[0m [3/4] 对 JBAT 文件进行排序（防止 OOM）...
[0;34mℹ️  [2025-12-07 00:23:01] INFO:[0m [4/4] 生成 JBAT .hic 文件...
WARNING: sun.reflect.Reflection.getCallerClass is not supported. This will impact performance.
WARN [2025-12-07T00:23:02,352]  [Globals.java:138] [main]  Development mode is enabled
Using 1 CPU thread(s)
Not including fragment map
Start preprocess
Writing header
Writing body
..
Writing footer

Finished preprocess

Calculating norms for zoom BP_2500000
Calculating norms for zoom BP_1000000
Calculating norms for zoom BP_500000
Calculating norms for zoom BP_250000
Calculating norms for zoom BP_100000
Calculating norms for zoom BP_50000
Calculating norms for zoom BP_25000
Calculating norms for zoom BP_10000
Calculating norms for zoom BP_5000
Calculating norms for zoom BP_1000
Finished writing norms
[0;32m✅ [2025-12-07 04:59:10] SUCCESS:[0m JBAT 文件生成成功
[0;34mℹ️  [2025-12-07 04:59:10] INFO:[0m 已删除临时文件: out_JBAT.txt
[0;34mℹ️  [2025-12-07 04:59:10] INFO:[0m 已删除临时文件: out_JBAT_sorted.txt
[0;32m✅ [2025-12-07 04:59:10] SUCCESS:[0m 步骤 5 完成 [用时: 08:57:40]

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[0;36m🔹 [2025-12-07 04:59:10] STEP:[0m 步骤 6/6: 组装质量评估
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[0;34mℹ️  [2025-12-07 04:59:10] INFO:[0m 计算统计指标...

╔════════════════════════════════════════════════════════════╗
║           📊 组装质量统计报告                              ║
╠════════════════════════════════════════════════════════════╣
║ Scaffold 总数:                                        367 ║
║ 总长度:                                 1,514,522,642 bp ║
║ 最长 Scaffold:                             203,092,078 bp ║
║ N50:                                          87,486,830 bp ║
║ N90:                                           6,283,271 bp ║
╚════════════════════════════════════════════════════════════╝
[0;32m✅ [2025-12-07 04:59:22] SUCCESS:[0m 步骤 6 完成 [用时: 00:00:12]

╔════════════════════════════════════════════════════════════╗
║                  🎉 流程执行完成                             ║
╠════════════════════════════════════════════════════════════╣
║ 总运行时间:                                   08:57:53 ║
║ 工作目录:                                       04.YaHS ║
║ 日志文件:                  pipeline_20251206_200129.log ║
║                                                            ║
║ 主要输出文件:                                                ║
║   • results/yahs_out_scaffolds_final.fa                    ║
║   • results/yahs_out_final.hic                             ║
║   • results/out_JBAT.hic                                   ║
║   • results/out_JBAT.assembly                              ║
║   • results/assembly_metrics.txt                           ║
╚════════════════════════════════════════════════════════════╝

[0;32m✅ [2025-12-07 04:59:22] SUCCESS:[0m 全流程执行完毕！
