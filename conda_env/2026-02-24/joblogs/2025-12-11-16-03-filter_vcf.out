2025-12-11 16:03:10,446 - INFO - ============================================================
2025-12-11 16:03:10,447 - INFO - ğŸ§¬ å¼€å§‹VCF SNP/INDELè¿‡æ»¤æµç¨‹ | Starting VCF SNP/INDEL Filtering Pipeline
2025-12-11 16:03:10,447 - INFO - ============================================================
2025-12-11 16:03:10,447 - INFO - ğŸ“¦ æ£€æŸ¥ä¾èµ–è½¯ä»¶ | Checking dependencies
2025-12-11 16:03:10,447 - INFO - ğŸ” æ£€æŸ¥ä¾èµ–è½¯ä»¶ | Checking dependencies
2025-12-11 16:03:10,792 - INFO - âœ… BCFtools å¯ç”¨ | BCFtools available
2025-12-11 16:03:10,792 - INFO - ============================================================
2025-12-11 16:03:10,792 - INFO - ğŸ”¬ æ­¥éª¤1: åˆ†ç¦»SNPå’ŒINDEL | Step 1: Separating SNPs and INDELs
2025-12-11 16:03:10,792 - INFO - ============================================================
2025-12-11 16:03:10,792 - INFO - ğŸ”§ æ‰§è¡Œæ­¥éª¤ | Executing step: æå–SNPå˜å¼‚ | Extracting SNP variants
2025-12-11 16:03:10,792 - INFO - ğŸ“ å‘½ä»¤ | Command: bcftools view --types snps --threads 88 -Oz -o variation.raw.snp.vcf.gz /share/org/YZWL/yzwl_lixg/project/21.é‡ç”Ÿå¤§è±†ç¾¤ä½“/03.ç¬¬ä¸€æ‰¹720ä¸ªæ ·å“/01.gtx_joint/gtx_joint_merged.vcf.gz
2025-12-12 12:16:06,593 - INFO - âœ… å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: æå–SNPå˜å¼‚ | Extracting SNP variants
2025-12-12 12:16:06,594 - INFO - ğŸ”§ æ‰§è¡Œæ­¥éª¤ | Executing step: æå–INDELå˜å¼‚ | Extracting INDEL variants
2025-12-12 12:16:06,594 - INFO - ğŸ“ å‘½ä»¤ | Command: bcftools view --types indels --threads 88 -Oz -o variation.raw.indel.vcf.gz /share/org/YZWL/yzwl_lixg/project/21.é‡ç”Ÿå¤§è±†ç¾¤ä½“/03.ç¬¬ä¸€æ‰¹720ä¸ªæ ·å“/01.gtx_joint/gtx_joint_merged.vcf.gz
2025-12-13 02:49:30,738 - INFO - âœ… å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: æå–INDELå˜å¼‚ | Extracting INDEL variants
2025-12-13 02:49:30,739 - INFO - ğŸ“‡ åˆ›å»ºVCFç´¢å¼• | Creating VCF index
2025-12-13 02:49:30,739 - INFO - ğŸ”§ æ‰§è¡Œæ­¥éª¤ | Executing step: ç´¢å¼•æ–‡ä»¶ | Indexing variation.raw.snp.vcf.gz
2025-12-13 02:49:30,739 - INFO - ğŸ“ å‘½ä»¤ | Command: bcftools index -f variation.raw.snp.vcf.gz
2025-12-13 07:53:57,196 - INFO - âœ… å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: ç´¢å¼•æ–‡ä»¶ | Indexing variation.raw.snp.vcf.gz
2025-12-13 07:53:57,197 - INFO - ğŸ”§ æ‰§è¡Œæ­¥éª¤ | Executing step: ç´¢å¼•æ–‡ä»¶ | Indexing variation.raw.indel.vcf.gz
2025-12-13 07:53:57,197 - INFO - ğŸ“ å‘½ä»¤ | Command: bcftools index -f variation.raw.indel.vcf.gz
2025-12-13 09:27:20,067 - INFO - âœ… å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: ç´¢å¼•æ–‡ä»¶ | Indexing variation.raw.indel.vcf.gz
2025-12-13 09:27:20,067 - INFO - âœ… SNPå’ŒINDELåˆ†ç¦»å®Œæˆ | SNP and INDEL separation completed
2025-12-13 09:27:20,067 - INFO - ============================================================
2025-12-13 09:27:20,067 - INFO - ğŸ§¹ æ­¥éª¤2a: è¿‡æ»¤SNP | Step 2a: Filtering SNPs
2025-12-13 09:27:20,067 - INFO - ============================================================
2025-12-13 09:27:20,067 - INFO - ğŸ“‹ SNPè¿‡æ»¤æ¡ä»¶ | SNP filter criteria:
2025-12-13 09:27:20,067 - INFO -    â€¢ QUAL >= 30.0
2025-12-13 09:27:20,067 - INFO -    â€¢ INFO/DP >= 10
2025-12-13 09:27:20,067 - INFO -    â€¢ MQ >= 40.0
2025-12-13 09:27:20,067 - INFO -    â€¢ QD >= 2.0
2025-12-13 09:27:20,067 - INFO -    â€¢ FS <= 60.0
2025-12-13 09:27:20,067 - INFO -    â€¢ SOR <= 3.0
2025-12-13 09:27:20,067 - INFO -    â€¢ MQRankSum >= -12.5
2025-12-13 09:27:20,067 - INFO -    â€¢ ReadPosRankSum >= -8.0
2025-12-13 09:27:20,067 - INFO -    â€¢ MAF >= 0.05
2025-12-13 09:27:20,067 - INFO - ğŸ”§ æ‰§è¡Œæ­¥éª¤ | Executing step: åº”ç”¨SNPè¿‡æ»¤ | Applying SNP filters
2025-12-13 09:27:20,068 - INFO - ğŸ“ å‘½ä»¤ | Command: bcftools view -i 'QUAL >= 30.0 && INFO/DP >= 10 && MQ >= 40.0 && QD >= 2.0 && FS <= 60.0 && SOR <= 3.0 && MQRankSum >= -12.5 && ReadPosRankSum >= -8.0 && MAF >= 0.05' --threads 88 -Oz -o variation.filtered.snp.vcf.gz variation.raw.snp.vcf.gz
2025-12-13 20:10:26,210 - INFO - âœ… å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: åº”ç”¨SNPè¿‡æ»¤ | Applying SNP filters
2025-12-13 20:10:26,214 - INFO - ğŸ”§ æ‰§è¡Œæ­¥éª¤ | Executing step: ç´¢å¼•è¿‡æ»¤åçš„SNPæ–‡ä»¶ | Indexing filtered SNP file
2025-12-13 20:10:26,214 - INFO - ğŸ“ å‘½ä»¤ | Command: bcftools index -f variation.filtered.snp.vcf.gz
2025-12-13 20:40:04,867 - INFO - âœ… å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: ç´¢å¼•è¿‡æ»¤åçš„SNPæ–‡ä»¶ | Indexing filtered SNP file
2025-12-13 20:40:04,867 - INFO - âœ… SNPè¿‡æ»¤å®Œæˆ | SNP filtering completed
2025-12-13 20:40:04,867 - INFO - ============================================================
2025-12-13 20:40:04,867 - INFO - ğŸ§¹ æ­¥éª¤2b: è¿‡æ»¤INDEL | Step 2b: Filtering INDELs
2025-12-13 20:40:04,867 - INFO - ============================================================
2025-12-13 20:40:04,867 - INFO - ğŸ“‹ INDELè¿‡æ»¤æ¡ä»¶ | INDEL filter criteria:
2025-12-13 20:40:04,867 - INFO -    â€¢ QUAL >= 30.0
2025-12-13 20:40:04,867 - INFO -    â€¢ INFO/DP >= 10
2025-12-13 20:40:04,867 - INFO -    â€¢ MQ >= 40.0
2025-12-13 20:40:04,867 - INFO -    â€¢ QD >= 2.0
2025-12-13 20:40:04,867 - INFO -    â€¢ FS <= 200.0
2025-12-13 20:40:04,867 - INFO -    â€¢ SOR <= 10.0
2025-12-13 20:40:04,867 - INFO -    â€¢ ReadPosRankSum >= -20.0
2025-12-13 20:40:04,868 - INFO - ğŸ”§ æ‰§è¡Œæ­¥éª¤ | Executing step: åº”ç”¨INDELè¿‡æ»¤ | Applying INDEL filters
2025-12-13 20:40:04,868 - INFO - ğŸ“ å‘½ä»¤ | Command: bcftools view -i 'QUAL >= 30.0 && INFO/DP >= 10 && MQ >= 40.0 && QD >= 2.0 && FS <= 200.0 && SOR <= 10.0 && ReadPosRankSum >= -20.0' --threads 88 -Oz -o variation.filtered.indel.vcf.gz variation.raw.indel.vcf.gz
2025-12-14 00:59:24,885 - INFO - âœ… å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: åº”ç”¨INDELè¿‡æ»¤ | Applying INDEL filters
2025-12-14 00:59:24,885 - INFO - ğŸ”§ æ‰§è¡Œæ­¥éª¤ | Executing step: ç´¢å¼•è¿‡æ»¤åçš„INDELæ–‡ä»¶ | Indexing filtered INDEL file
2025-12-14 00:59:24,885 - INFO - ğŸ“ å‘½ä»¤ | Command: bcftools index -f variation.filtered.indel.vcf.gz
2025-12-14 01:53:21,633 - INFO - âœ… å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: ç´¢å¼•è¿‡æ»¤åçš„INDELæ–‡ä»¶ | Indexing filtered INDEL file
2025-12-14 01:53:21,657 - INFO - âœ… INDELè¿‡æ»¤å®Œæˆ | INDEL filtering completed
2025-12-14 01:53:21,657 - INFO - ============================================================
2025-12-14 01:53:21,657 - INFO - ğŸ”— æ­¥éª¤3: åˆå¹¶è¿‡æ»¤åçš„å˜å¼‚ | Step 3: Merging filtered variants
2025-12-14 01:53:21,657 - INFO - ============================================================
2025-12-14 01:53:21,657 - INFO - ğŸ”§ æ‰§è¡Œæ­¥éª¤ | Executing step: åˆå¹¶SNPå’ŒINDEL | Merging SNPs and INDELs
2025-12-14 01:53:21,657 - INFO - ğŸ“ å‘½ä»¤ | Command: bcftools concat -a -D --threads 88 -Oz -o variation.filtered.merged.unsorted.vcf.gz variation.filtered.snp.vcf.gz variation.filtered.indel.vcf.gz
2025-12-14 07:09:55,207 - INFO - âœ… å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: åˆå¹¶SNPå’ŒINDEL | Merging SNPs and INDELs
2025-12-14 07:09:55,207 - INFO - ğŸ”§ æ‰§è¡Œæ­¥éª¤ | Executing step: æŒ‰ä½ç½®æ’åº | Sorting by position
2025-12-14 07:09:55,207 - INFO - ğŸ“ å‘½ä»¤ | Command: bcftools sort -Oz -o variation.filtered.merged.vcf.gz variation.filtered.merged.unsorted.vcf.gz
2025-12-15 08:53:01,592 - INFO - âœ… å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: æŒ‰ä½ç½®æ’åº | Sorting by position
2025-12-15 08:53:01,592 - INFO - ğŸ—‘ï¸ æ¸…ç†ä¸´æ—¶æ–‡ä»¶ | Cleaning up temporary file: 02.filtered_snp_indel/variation.filtered.merged.unsorted.vcf.gz
2025-12-15 08:53:01,633 - INFO - âœ… ä¸´æ—¶æ–‡ä»¶å·²åˆ é™¤ | Temporary file deleted.
2025-12-15 08:53:01,633 - INFO - ğŸ”§ æ‰§è¡Œæ­¥éª¤ | Executing step: ç´¢å¼•åˆå¹¶æ–‡ä»¶ | Indexing merged file
2025-12-15 08:53:01,633 - INFO - ğŸ“ å‘½ä»¤ | Command: bcftools index -f variation.filtered.merged.vcf.gz
2025-12-15 10:12:00,723 - INFO - âœ… å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully: ç´¢å¼•åˆå¹¶æ–‡ä»¶ | Indexing merged file
2025-12-15 10:12:00,724 - INFO - âœ… å˜å¼‚åˆå¹¶å®Œæˆ | Variant merging completed
2025-12-15 10:12:00,724 - INFO - ============================================================
2025-12-15 10:12:00,724 - INFO - ğŸ“Š æ­¥éª¤4: ç”Ÿæˆç»Ÿè®¡æŠ¥å‘Š | Step 4: Generating statistics report
2025-12-15 10:12:00,751 - INFO - ============================================================
2025-12-16 22:10:40,219 - INFO - ============================================================
2025-12-16 22:10:40,219 - INFO - ğŸ“Š è¿‡æ»¤ç»Ÿè®¡ | Filtering Statistics
2025-12-16 22:10:40,219 - INFO - ============================================================
2025-12-16 22:10:40,219 - INFO - åŸå§‹SNP | Raw SNPs: 157,737,340
2025-12-16 22:10:40,219 - INFO - è¿‡æ»¤åSNP | Filtered SNPs: 11,959,424
2025-12-16 22:10:40,219 - INFO - åŸå§‹INDEL | Raw INDELs: 41,744,218
2025-12-16 22:10:40,219 - INFO - è¿‡æ»¤åINDEL | Filtered INDELs: 22,245,641
2025-12-16 22:10:40,219 - INFO - åˆå¹¶åå˜å¼‚ | Merged variants: 32,886,543
2025-12-16 22:10:40,219 - INFO - ğŸ“ˆ SNPä¿ç•™ç‡ | SNP retention rate: 7.58%
2025-12-16 22:10:40,219 - INFO - ğŸ“ˆ INDELä¿ç•™ç‡ | INDEL retention rate: 53.29%
2025-12-16 22:10:40,219 - INFO - ğŸ“„ ç»Ÿè®¡æŠ¥å‘Šå·²ä¿å­˜ | Statistics report saved: 02.filtered_snp_indel/filtering_statistics.txt
2025-12-16 22:10:40,219 - INFO - ============================================================
2025-12-16 22:10:40,219 - INFO - ğŸ‰ VCFè¿‡æ»¤æµç¨‹æˆåŠŸå®Œæˆ | VCF Filtering Pipeline Completed Successfully!
2025-12-16 22:10:40,219 - INFO - ============================================================
2025-12-16 22:10:40,219 - INFO - ğŸ“‚ ç»“æœä¿å­˜åœ¨ | Results saved in: /share/org/YZWL/yzwl_lixg/project/21.é‡ç”Ÿå¤§è±†ç¾¤ä½“/03.ç¬¬ä¸€æ‰¹720ä¸ªæ ·å“/02.filtered_snp_indel
2025-12-16 22:10:40,219 - INFO - ============================================================

