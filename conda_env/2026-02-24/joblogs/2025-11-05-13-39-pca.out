2025-11-05 13:39:39,338 - INFO - 开始VCF PCA分析流程 | Starting VCF PCA analysis pipeline
2025-11-05 13:39:39,338 - INFO - VCF文件 | VCF file: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/variation.filtered.snp.vcf.gz
2025-11-05 13:39:39,338 - INFO - 输出目录 | Output directory: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output
2025-11-05 13:39:39,338 - INFO - 检查依赖软件 | Checking dependencies
2025-11-05 13:39:39,839 - INFO - ✓ PLINK 可用 | available
2025-11-05 13:39:40,304 - INFO - ✓ BCFtools 可用 | available
2025-11-05 13:39:40,304 - INFO - 
============================================================
2025-11-05 13:39:40,304 - INFO - 步骤1: VCF转PLINK格式 | Step 1: VCF to PLINK conversion
2025-11-05 13:39:40,304 - INFO - ============================================================
2025-11-05 13:39:40,304 - INFO - 获取VCF文件统计信息 | Getting VCF file statistics
2025-11-05 13:45:50,457 - INFO - VCF统计 | VCF statistics: 100 样本 | samples, 12697136 变异 | variants
2025-11-05 13:45:50,458 - INFO - 开始处理包含 100 个样本和 12697136 个变异的VCF文件
2025-11-05 13:45:50,460 - INFO - 输出目录可写 | Output directory is writable: pca_output
2025-11-05 13:45:50,460 - INFO - 执行步骤 | Executing step: VCF转换为PLINK格式 | Convert VCF to PLINK format
2025-11-05 13:45:50,460 - INFO - 命令 | Command: plink --vcf /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/variation.filtered.snp.vcf.gz --make-bed --out /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/vcf_pca --allow-extra-chr --double-id
2025-11-05 13:45:50,460 - INFO - 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output
2025-11-05 13:48:36,787 - INFO - 命令执行成功 | Command executed successfully: VCF转换为PLINK格式 | Convert VCF to PLINK format
2025-11-05 13:48:36,787 - INFO - PLINK文件已生成 | PLINK files generated: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/vcf_pca
2025-11-05 13:48:36,787 - INFO - 
============================================================
2025-11-05 13:48:36,787 - INFO - 步骤2: 质量控制 | Step 2: Quality control
2025-11-05 13:48:36,787 - INFO - ============================================================
2025-11-05 13:48:36,787 - INFO - 应用质量控制过滤 | Applying quality control filters
2025-11-05 13:48:36,787 - INFO - MAF阈值 | MAF threshold: 0.05
2025-11-05 13:48:36,787 - INFO - 缺失率阈值 | Missing rate threshold: 0.1
2025-11-05 13:48:36,787 - INFO - HWE p值阈值 | HWE p-value threshold: 1e-06
2025-11-05 13:48:36,787 - INFO - 执行步骤 | Executing step: MAF过滤 | MAF filtering (>=0.05)
2025-11-05 13:48:36,787 - INFO - 命令 | Command: plink --bfile /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/vcf_pca --maf 0.05 --make-bed --out /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/vcf_pca_maf --allow-extra-chr
2025-11-05 13:48:36,787 - INFO - 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output
2025-11-05 13:48:41,314 - INFO - 命令执行成功 | Command executed successfully: MAF过滤 | MAF filtering (>=0.05)
2025-11-05 13:48:41,315 - INFO - 执行步骤 | Executing step: HWE过滤 | HWE filtering (p>1e-06)
2025-11-05 13:48:41,315 - INFO - 命令 | Command: plink --bfile /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/vcf_pca_maf --hwe 1e-06 --make-bed --out /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/vcf_pca_hwe --allow-extra-chr
2025-11-05 13:48:41,315 - INFO - 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output
2025-11-05 13:48:44,664 - INFO - 命令执行成功 | Command executed successfully: HWE过滤 | HWE filtering (p>1e-06)
2025-11-05 13:48:44,664 - INFO - 执行步骤 | Executing step: 缺失率过滤 | Missing rate filtering (<0.1)
2025-11-05 13:48:44,664 - INFO - 命令 | Command: plink --bfile /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/vcf_pca_hwe --geno 0.1 --mind 0.1 --make-bed --out /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/vcf_pca_qc --allow-extra-chr
2025-11-05 13:48:44,664 - INFO - 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output
2025-11-05 13:48:45,382 - ERROR - 命令执行失败 | Command execution failed: 缺失率过滤 | Missing rate filtering (<0.1)
2025-11-05 13:48:45,382 - ERROR - 错误代码 | Error code: 11
2025-11-05 13:48:45,382 - ERROR - 错误信息 | Error message: Error: All people removed due to missing genotype data (--mind).

2025-11-05 13:48:45,382 - ERROR - 标准输出 | Stdout: PLINK v1.9.0-b.8 64-bit (22 Oct 2024)              cog-genomics.org/plink/1.9/
(C) 2005-2024 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/vcf_pca_qc.log.
Options in effect:
  --allow-extra-chr
  --bfile /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/vcf_pca_hwe
  --geno 0.1
  --make-bed
  --mind 0.1
  --out /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/vcf_pca_qc

1031262 MB RAM detected; reserving 515631 MB for main workspace.
3561700 variants loaded from .bim file.
100 people (0 males, 0 females, 100 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
/share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/vcf_pca_qc.nosex
.
IDs written to
/share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/vcf_pca_qc.irem
.

2025-11-05 13:48:45,382 - ERROR - 分析流程在执行过程中意外终止 | Analysis pipeline terminated unexpectedly: 质量控制失败 | Quality control failed
