2025-11-05 19:41:27,806 - INFO - 开始VCF PCA分析流程 | Starting VCF PCA analysis pipeline
2025-11-05 19:41:27,806 - INFO - VCF文件 | VCF file: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/variation.filtered.snp.vcf.gz
2025-11-05 19:41:27,806 - INFO - 输出目录 | Output directory: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output
2025-11-05 19:41:27,806 - INFO - 检查依赖软件 | Checking dependencies
2025-11-05 19:41:28,219 - INFO - ✓ PLINK 可用 | available
2025-11-05 19:41:28,595 - INFO - ✓ BCFtools 可用 | available
2025-11-05 19:41:28,595 - INFO - 
============================================================
2025-11-05 19:41:28,595 - INFO - 步骤1: VCF转PLINK格式 | Step 1: VCF to PLINK conversion
2025-11-05 19:41:28,595 - INFO - ============================================================
2025-11-05 19:41:28,595 - INFO - 获取VCF文件统计信息 | Getting VCF file statistics
2025-11-05 19:47:41,037 - INFO - VCF统计 | VCF statistics: 100 样本 | samples, 12697136 变异 | variants
2025-11-05 19:47:41,038 - INFO - 开始处理包含 100 个样本和 12697136 个变异的VCF文件
2025-11-05 19:47:41,039 - INFO - 输出目录可写 | Output directory is writable: pca_output
2025-11-05 19:47:41,040 - INFO - 执行步骤 | Executing step: VCF转换为PLINK格式 | Convert VCF to PLINK format
2025-11-05 19:47:41,040 - INFO - 命令 | Command: plink --vcf /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/variation.filtered.snp.vcf.gz --make-bed --out /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/vcf_pca --allow-extra-chr --double-id
2025-11-05 19:47:41,040 - INFO - 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output
2025-11-05 19:50:27,730 - INFO - 命令执行成功 | Command executed successfully: VCF转换为PLINK格式 | Convert VCF to PLINK format
2025-11-05 19:50:27,731 - INFO - PLINK文件已生成 | PLINK files generated: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/vcf_pca
2025-11-05 19:50:27,731 - INFO - 
============================================================
2025-11-05 19:50:27,731 - INFO - 步骤2: 质量控制 | Step 2: Quality control
2025-11-05 19:50:27,731 - INFO - ============================================================
2025-11-05 19:50:27,731 - INFO - 跳过质量控制过滤 (用户指定) | Skipping quality control filtering (user specified)
2025-11-05 19:50:27,731 - INFO - 输入样本数 | Input samples: 100
2025-11-05 19:50:28,425 - INFO - 输入SNP数 | Input SNPs: 12697136
2025-11-05 19:50:28,426 - INFO - 
============================================================
2025-11-05 19:50:28,426 - INFO - 步骤3: PCA分析 | Step 3: PCA analysis
2025-11-05 19:50:28,426 - INFO - ============================================================
2025-11-05 19:50:28,427 - INFO - 开始PCA分析 | Starting PCA analysis
2025-11-05 19:50:28,427 - INFO - 主成分数量 | Number of components: 10
2025-11-05 19:50:28,427 - INFO - 执行步骤 | Executing step: PCA分析 | PCA analysis (10 components)
2025-11-05 19:50:28,427 - INFO - 命令 | Command: plink --bfile /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/vcf_pca --pca 10 --out /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output/pca_results --allow-extra-chr
2025-11-05 19:50:28,427 - INFO - 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output
2025-11-05 19:50:56,333 - INFO - 命令执行成功 | Command executed successfully: PCA分析 | PCA analysis (10 components)
2025-11-05 19:50:56,335 - INFO - 分析PCA结果 | Analyzing PCA results
2025-11-05 19:50:56,337 - INFO - PCA分析结果 | PCA Analysis Results:
2025-11-05 19:50:56,337 - INFO - 总方差 | Total variance: 10.3658
2025-11-05 19:50:56,341 - INFO - 主成分解释方差 | Principal component explained variance:
2025-11-05 19:50:56,341 - INFO -   PC1: 特征值 | Eigenvalue = 2.8389, 解释方差比 | Explained variance ratio = 0.2739 (27.39%), 累积 | Cumulative = 0.2739 (27.39%)
2025-11-05 19:50:56,341 - INFO -   PC2: 特征值 | Eigenvalue = 1.0889, 解释方差比 | Explained variance ratio = 0.1050 (10.50%), 累积 | Cumulative = 0.3789 (37.89%)
2025-11-05 19:50:56,341 - INFO -   PC3: 特征值 | Eigenvalue = 0.9365, 解释方差比 | Explained variance ratio = 0.0903 (9.03%), 累积 | Cumulative = 0.4693 (46.93%)
2025-11-05 19:50:56,341 - INFO -   PC4: 特征值 | Eigenvalue = 0.8683, 解释方差比 | Explained variance ratio = 0.0838 (8.38%), 累积 | Cumulative = 0.5530 (55.30%)
2025-11-05 19:50:56,341 - INFO -   PC5: 特征值 | Eigenvalue = 0.8295, 解释方差比 | Explained variance ratio = 0.0800 (8.00%), 累积 | Cumulative = 0.6331 (63.31%)
2025-11-05 19:50:56,341 - INFO -   PC6: 特征值 | Eigenvalue = 0.8150, 解释方差比 | Explained variance ratio = 0.0786 (7.86%), 累积 | Cumulative = 0.7117 (71.17%)
2025-11-05 19:50:56,341 - INFO -   PC7: 特征值 | Eigenvalue = 0.8055, 解释方差比 | Explained variance ratio = 0.0777 (7.77%), 累积 | Cumulative = 0.7894 (78.94%)
2025-11-05 19:50:56,341 - INFO -   PC8: 特征值 | Eigenvalue = 0.7890, 解释方差比 | Explained variance ratio = 0.0761 (7.61%), 累积 | Cumulative = 0.8655 (86.55%)
2025-11-05 19:50:56,341 - INFO -   PC9: 特征值 | Eigenvalue = 0.7123, 解释方差比 | Explained variance ratio = 0.0687 (6.87%), 累积 | Cumulative = 0.9342 (93.42%)
2025-11-05 19:50:56,341 - INFO -   PC10: 特征值 | Eigenvalue = 0.6818, 解释方差比 | Explained variance ratio = 0.0658 (6.58%), 累积 | Cumulative = 1.0000 (100.00%)
2025-11-05 19:50:56,420 - INFO - 解释方差表已保存 | Explained variance table saved: pca_output/pca_explained_variance.txt
2025-11-05 19:50:56,421 - INFO - 特征值说明文件已保存 | Eigenvalues explanation saved: pca_output/eigenvalues_explanation.txt
2025-11-05 19:50:56,425 - INFO - 格式化特征向量已保存 | Formatted eigenvectors saved: pca_output/pca_eigenvectors_formatted.txt
2025-11-05 19:50:56,425 - INFO - 总结报告已生成 | Summary report generated: pca_output/pca_analysis_summary.txt
2025-11-05 19:50:56,425 - INFO - 
============================================================
2025-11-05 19:50:56,425 - INFO - PCA分析完成！| PCA analysis completed!
2025-11-05 19:50:56,425 - INFO - ============================================================
2025-11-05 19:50:56,425 - INFO - 结果保存在 | Results saved in: /share/org/YZWL/yzwl_lixg/project/96.yabian/14.新的变异信息/05.pca/pca_output
