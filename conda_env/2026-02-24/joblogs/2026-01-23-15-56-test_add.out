2026-01-23 15:56:36.259 - INFO - 开始添加新样本模式（增量式）|Starting add new samples mode (incremental)
2026-01-23 15:56:36.260 - INFO - 从metadata读取k-mer大小|Read k-mer size from metadata: 21 → 51
2026-01-23 15:56:36.260 - INFO - 检测到目录输入模式|Detected directory input mode: fastq_new
2026-01-23 15:56:36.260 - INFO - 数据模式|Data mode: 双末端|Paired-end
2026-01-23 15:56:36.260 - INFO - 文件模式|File pattern: *_1.clean.fq.gz, *_2.clean.fq.gz
2026-01-23 15:56:36.260 - INFO - 检测到目录输入模式|Detected directory input mode: fastq_new
2026-01-23 15:56:36.260 - INFO - 数据模式|Data mode: 双末端|Paired-end
2026-01-23 15:56:36.260 - INFO - 文件模式|File pattern: *_1.clean.fq.gz, *_2.clean.fq.gz
2026-01-23 15:56:36.261 - INFO - 找到 2 个read1文件|Found 2 read1 files
2026-01-23 15:56:36.262 - INFO - 验证通过|Validation passed: 2 个样本|samples
2026-01-23 15:56:36.262 - INFO - 找到 2 个新样本|Found 2 new samples: ['W681A', 'W680A']
2026-01-23 15:56:36.262 - INFO - 增量式添加 2 个新样本|Incrementally adding 2 new samples
2026-01-23 15:56:36.262 - INFO - 统计新样本|Counting new sample: W681A
2026-01-23 15:56:36.262 - INFO - 开始统计样本|Starting to count sample: W681A
2026-01-23 15:56:36.263 - INFO - 执行步骤|Executing step: 统计样本|Counting sample W681A
2026-01-23 15:56:36.263 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc -k51 -ci2 -t64 -m200G @/share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/W681A/input_files.txt W681A /share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/W681A
2026-01-23 15:58:04.161 - INFO - 命令执行成功|Command executed successfully: 统计样本|Counting sample W681A
2026-01-23 15:58:04.163 - INFO - 样本统计完成|Sample counting completed: W681A
2026-01-23 15:58:04.164 - INFO - 统计新样本|Counting new sample: W680A
2026-01-23 15:58:04.164 - INFO - 开始统计样本|Starting to count sample: W680A
2026-01-23 15:58:04.164 - INFO - 执行步骤|Executing step: 统计样本|Counting sample W680A
2026-01-23 15:58:04.164 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc -k51 -ci2 -t64 -m200G @/share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/W680A/input_files.txt W680A /share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/W680A
2026-01-23 15:59:30.019 - INFO - 命令执行成功|Command executed successfully: 统计样本|Counting sample W680A
2026-01-23 15:59:30.020 - INFO - 样本统计完成|Sample counting completed: W680A
2026-01-23 15:59:30.021 - INFO - 现有 k-mer 数量|Existing k-mers: 34,676,051
2026-01-23 15:59:30.021 - INFO - 步骤1/6: 增量式 Union 全局数据库|Step 1/6: Incremental union global database
2026-01-23 15:59:30.343 - INFO - 现有样本|Existing samples: ['test2', 'test3', 'test1']
2026-01-23 15:59:30.343 - INFO - 新样本|New samples: ['W681A', 'W680A']
2026-01-23 15:59:32.612 - INFO -   合并新样本|Merging new sample: W681A
2026-01-23 15:59:32.612 - INFO - 增量式合并数据库|Incremental union: global_kmers + W681A → global_kmers_temp_0
2026-01-23 15:59:32.612 - INFO - 执行步骤|Executing step: 增量合并数据库|Incremental union: global_kmers + W681A
2026-01-23 15:59:32.612 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc_tools -t64 simple ../global_kmers W681A union global_kmers_temp_0
2026-01-23 16:02:23.875 - INFO - 命令执行成功|Command executed successfully: 增量合并数据库|Incremental union: global_kmers + W681A
2026-01-23 16:02:23.877 - INFO - 增量合并完成|Incremental union completed: global_kmers_temp_0
2026-01-23 16:02:23.877 - INFO -   合并新样本|Merging new sample: W680A
2026-01-23 16:02:23.877 - INFO - 增量式合并数据库|Incremental union: global_kmers_temp_0 + W680A → global_kmers_temp_1
2026-01-23 16:02:23.877 - INFO - 执行步骤|Executing step: 增量合并数据库|Incremental union: global_kmers_temp_0 + W680A
2026-01-23 16:02:23.880 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc_tools -t64 simple ../global_kmers_temp_0 W680A union global_kmers_temp_1
2026-01-23 16:04:59.946 - INFO - 命令执行成功|Command executed successfully: 增量合并数据库|Incremental union: global_kmers_temp_0 + W680A
2026-01-23 16:04:59.947 - INFO - 增量合并完成|Incremental union completed: global_kmers_temp_1
2026-01-23 16:06:44.198 - INFO - 新增 k-mer 数量|New k-mers added: 923,486,318
2026-01-23 16:06:44.216 - INFO - 更新后 k-mer 总数|Total k-mers after update: 958,162,369
2026-01-23 16:06:44.216 - INFO - 步骤2/6: 导出新增 k-mer|Step 2/6: Export new k-mers
2026-01-23 16:06:44.216 - INFO - 导出新增的 923486318 个 k-mer|Exporting 923486318 new k-mers
2026-01-23 16:08:57.826 - INFO - 新 k-mer 文件已保存|New k-mer file saved: database_bak/new_kmers.txt
2026-01-23 16:08:57.827 - INFO - 步骤3/6: 更新 k-mer 字典|Step 3/6: Update k-mer dictionary
2026-01-23 16:08:57.827 - INFO - 追加 k-mer 到字典|Appending k-mers to dictionary
2026-01-23 16:08:58.026 - WARNING - kmer dataset的maxshape不足（34676051 < 958162369），需要扩展|kmer dataset maxshape too small, need to expand
2026-01-23 16:08:58.027 - INFO - 备份旧k-mer数据|Backing up old k-mer data: 34,676,051
2026-01-23 16:09:04.691 - INFO - 现有 k-mer 数量|Existing k-mers: 34,676,051
2026-01-23 16:09:04.691 - INFO - 创建新的kmer dataset（包含旧数据+新数据）|Creating new kmer dataset (old + new data)
2026-01-23 16:09:04.691 - INFO - 恢复 34,676,051 个旧k-mer|Restoring 34,676,051 old k-mers
2026-01-23 16:29:06.942 - INFO - 已追加 923486318 个 k-mer|Appended 923486318 k-mers
2026-01-23 16:29:38.944 - INFO - 步骤4/6: 更新 LevelDB 索引|Step 4/6: Update LevelDB index
2026-01-23 16:29:39.121 - INFO - 追加到 LevelDB|Appending to LevelDB
2026-01-23 16:31:15.653 - INFO -   已写入|Written: 100,000,000
2026-01-23 16:32:51.793 - INFO -   已写入|Written: 200,000,000
2026-01-23 16:34:27.212 - INFO -   已写入|Written: 300,000,000
2026-01-23 16:36:04.256 - INFO -   已写入|Written: 400,000,000
2026-01-23 16:37:42.250 - INFO -   已写入|Written: 500,000,000
2026-01-23 16:39:19.309 - INFO -   已写入|Written: 600,000,000
2026-01-23 16:40:54.542 - INFO -   已写入|Written: 700,000,000
2026-01-23 16:42:30.112 - INFO -   已写入|Written: 800,000,000
2026-01-23 16:44:05.365 - INFO -   已写入|Written: 900,000,000
2026-01-23 16:45:41.629 - INFO - LevelDB 追加完成|LevelDB append completed: 923,486,318 entries
2026-01-23 16:45:41.656 - INFO - 步骤5/6: 查询新样本丰度|Step 5/6: Query new sample abundances
2026-01-23 16:45:41.685 - INFO - 文件大小 49.00GB >= 阈值 1.0GB，使用数据库索引|File size 49.00GB >= threshold 1.0GB, using database index
2026-01-23 16:45:41.688 - INFO - 检测到已存在的LevelDB索引，直接加载|Found existing LevelDB index, loading: database_bak/kmer_index.ldb
2026-01-23 16:48:03.193 - INFO - 处理新样本|Processing new sample: W681A
2026-01-23 16:48:03.194 - INFO - 查询样本丰度|Querying sample abundances: W681A
2026-01-23 16:56:50.715 - INFO - 从dump文件读取|Read from dump: 841,179,211 k-mers
2026-01-23 16:56:50.716 - INFO - 使用 64 线程并行查询|Using 64 threads for parallel query
2026-01-23 16:56:58.556 - INFO - 数据分块|Data chunks: 64, 每块约|~13,143,426 条
