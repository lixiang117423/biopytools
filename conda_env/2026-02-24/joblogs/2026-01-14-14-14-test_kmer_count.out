2026-01-14 14:14:20.621 - INFO - ============================================================
2026-01-14 14:14:20.622 - INFO - 开始K-mer丰度分析|Starting K-mer abundance analysis
2026-01-14 14:14:20.622 - INFO - ============================================================
2026-01-14 14:14:20.622 - INFO - 发现进度文件，将支持断点续传|Progress file found, checkpoint resumption enabled
2026-01-14 14:14:20.622 - INFO - ============================================================
2026-01-14 14:14:20.622 - INFO - 进度摘要|Progress Summary:
2026-01-14 14:14:20.622 - INFO -   已完成步骤|Completed steps: 5/8
2026-01-14 14:14:20.622 - INFO -   开始时间|Start time: 2026-01-14T13:42:19.064584
2026-01-14 14:14:20.622 - INFO -   最后更新|Last update: 2026-01-14T13:42:19.222705
2026-01-14 14:14:20.622 - INFO -   已完成的步骤|Completed step names:
2026-01-14 14:14:20.622 - INFO -     ✓ 步骤1: 检查依赖软件|Step 1: Checking dependencies
2026-01-14 14:14:20.622 - INFO -     ✓ 步骤2: 设置临时目录|Step 2: Setting up temporary directory
2026-01-14 14:14:20.622 - INFO -     ✓ 步骤3: 查找输入文件|Step 3: Finding input files
2026-01-14 14:14:20.622 - INFO -     ✓ 步骤4: 准备k-mer库|Step 4: Preparing k-mer library
2026-01-14 14:14:20.622 - INFO -     ✓ 步骤5: 解析注释信息|Step 5: Parsing annotation information
2026-01-14 14:14:20.622 - INFO -   剩余步骤|Remaining steps: 3
2026-01-14 14:14:20.622 - INFO - ============================================================
2026-01-14 14:14:20.622 - INFO - 步骤1已完成，跳过|Step 1 completed, skipping
2026-01-14 14:14:20.623 - INFO - 步骤2: 设置临时目录|Step 2: Setting up temporary directory
2026-01-14 14:14:20.652 - INFO - 临时目录: /share/org/YZWL/yzwl_lixg/tmp/test_kmer_count/tmp/kmer_count_1768371260_5722
2026-01-14 14:14:20.652 - INFO - 步骤2: 设置临时目录|Step 2: Setting up temporary directory 已完成|步骤2: 设置临时目录|Step 2: Setting up temporary directory completed
2026-01-14 14:14:20.652 - INFO - 进度已保存|Progress saved to: 03.kmer丰度/.kmer_count_progress.json
2026-01-14 14:14:20.652 - INFO - 步骤3已完成，跳过|Step 3 completed, skipping
2026-01-14 14:14:20.652 - INFO -  查找输入文件|Finding input files
2026-01-14 14:14:20.652 - INFO -  输入目录: 00.fastq
2026-01-14 14:14:20.652 - INFO -  文件模式: *_1.clean.fq.gz
2026-01-14 14:14:20.652 - INFO -  输入目录是否存在: True
2026-01-14 14:14:20.653 - INFO -  目录中的文件: ['OV8-105_1.clean.fq.gz', 'OV8-106_1.clean.fq.gz', 'OV8-105_2.clean.fq.gz', 'OV8-106_2.clean.fq.gz']
2026-01-14 14:14:20.653 - INFO -  使用FASTQ文件处理逻辑|Using FASTQ file processing logic
2026-01-14 14:14:20.653 - INFO -  常规文件|Regular file: OV8-105_1.clean.fq.gz
2026-01-14 14:14:20.654 - INFO -  常规文件|Regular file: OV8-106_1.clean.fq.gz
2026-01-14 14:14:20.654 - INFO -  找到2个有效R1文件
2026-01-14 14:14:20.654 - INFO -  提取样本名: OV8-105
2026-01-14 14:14:20.654 - INFO - 找到双端样本|Found paired-end sample: OV8-105
2026-01-14 14:14:20.654 - INFO -    R1: /share/org/YZWL/yzwl_lixg/tmp/test_kmer_count/00.fastq/OV8-105_1.clean.fq.gz
2026-01-14 14:14:20.654 - INFO -    R2: /share/org/YZWL/yzwl_lixg/tmp/test_kmer_count/00.fastq/OV8-105_2.clean.fq.gz
2026-01-14 14:14:20.654 - INFO -  提取样本名: OV8-106
2026-01-14 14:14:20.654 - INFO - 找到双端样本|Found paired-end sample: OV8-106
2026-01-14 14:14:20.654 - INFO -    R1: /share/org/YZWL/yzwl_lixg/tmp/test_kmer_count/00.fastq/OV8-106_1.clean.fq.gz
2026-01-14 14:14:20.654 - INFO -    R2: /share/org/YZWL/yzwl_lixg/tmp/test_kmer_count/00.fastq/OV8-106_2.clean.fq.gz
2026-01-14 14:14:20.654 - INFO - 找到2个样本|Found 2 samples
2026-01-14 14:14:20.654 - INFO - 步骤4已完成，跳过|Step 4 completed, skipping
2026-01-14 14:14:20.654 - INFO - 使用已处理的k-mer库|Using processed k-mer library: 03.kmer丰度/intermediate_files/kmers_expanded.fasta
2026-01-14 14:14:20.658 - INFO - 步骤5已完成，加载已有数据|Step 5 completed, loading existing data
2026-01-14 14:14:20.658 - INFO - 加载已有BED文件|Loading existing BED file: 03.kmer丰度/intermediate_files/processed_kmers.bed
2026-01-14 14:14:20.689 - INFO - BED文件已加载，共11465条记录|BED file loaded, 11465 records
2026-01-14 14:14:20.689 - INFO - 步骤6: 处理样本|Step 6: Processing samples
2026-01-14 14:14:20.690 - INFO - 处理样本|Processing sample: OV8-105
2026-01-14 14:14:20.690 - INFO - 开始k-mer计数|Starting k-mer counting for sample: OV8-105
2026-01-14 14:14:20.701 - INFO - 发现已有jellyfish计数文件，跳过|Found existing jellyfish file, skipping: 03.kmer丰度/jellyfish_cache/OV8-105.jf
2026-01-14 14:14:20.701 - INFO -  查询k-mer丰度|Querying k-mer abundance for sample: OV8-105
2026-01-14 14:14:20.701 - INFO - 发现已有k-mer计数文件，跳过|Found existing count file, skipping: 03.kmer丰度/jellyfish_cache/OV8-105.kmers.count
2026-01-14 14:14:20.701 - INFO -  解析Jellyfish输出|Parsing Jellyfish output for OV8-105
2026-01-14 14:14:20.743 - INFO -  解析完成，去重后共22912个k-mer结果|Parsing completed, 22912 unique k-mer results after deduplication
2026-01-14 14:14:20.744 - INFO - 合并样品OV8-105与BED文件
2026-01-14 14:14:20.744 - INFO - BED记录数: 11,465, 样本k-mer数: 22,912
2026-01-14 14:14:20.744 - INFO - 使用反向merge策略|Using reverse merge strategy
2026-01-14 14:14:24.162 - INFO - 样品OV8-105合并完成，共0行
2026-01-14 14:14:24.269 - INFO - 样品OV8-105结果已保存: 03.kmer丰度/each_sample/OV8-105_kmer_abundance.tsv
2026-01-14 14:14:24.269 - INFO - 处理样本|Processing sample: OV8-106
2026-01-14 14:14:24.269 - INFO - 开始k-mer计数|Starting k-mer counting for sample: OV8-106
2026-01-14 14:14:24.314 - INFO - 发现已有jellyfish计数文件，跳过|Found existing jellyfish file, skipping: 03.kmer丰度/jellyfish_cache/OV8-106.jf
2026-01-14 14:14:24.314 - INFO -  查询k-mer丰度|Querying k-mer abundance for sample: OV8-106
2026-01-14 14:14:24.314 - INFO - 发现已有k-mer计数文件，跳过|Found existing count file, skipping: 03.kmer丰度/jellyfish_cache/OV8-106.kmers.count
2026-01-14 14:14:24.314 - INFO -  解析Jellyfish输出|Parsing Jellyfish output for OV8-106
2026-01-14 14:14:24.392 - INFO -  解析完成，去重后共22912个k-mer结果|Parsing completed, 22912 unique k-mer results after deduplication
2026-01-14 14:14:24.393 - INFO - 合并样品OV8-106与BED文件
2026-01-14 14:14:24.393 - INFO - BED记录数: 11,465, 样本k-mer数: 22,912
2026-01-14 14:14:24.394 - INFO - 使用反向merge策略|Using reverse merge strategy
2026-01-14 14:14:27.817 - INFO - 样品OV8-106合并完成，共0行
2026-01-14 14:14:27.835 - INFO - 样品OV8-106结果已保存: 03.kmer丰度/each_sample/OV8-106_kmer_abundance.tsv
2026-01-14 14:14:27.835 - INFO - ==================================================
2026-01-14 14:14:27.835 - INFO - 样本处理总结|Sample Processing Summary:
2026-01-14 14:14:27.835 - INFO -   总样本数: 2
2026-01-14 14:14:27.835 - INFO -   成功处理: 2
2026-01-14 14:14:27.835 - INFO -    跳过样本: 0
2026-01-14 14:14:27.836 - INFO - ==================================================
2026-01-14 14:14:27.836 - INFO - 步骤6: 处理样本|Step 6: Processing samples 已完成|步骤6: 处理样本|Step 6: Processing samples completed
2026-01-14 14:14:27.836 - INFO - 进度已保存|Progress saved to: 03.kmer丰度/.kmer_count_progress.json
2026-01-14 14:14:27.836 - INFO - 步骤7: 合并所有样本结果|Step 7: Merging all sample results
2026-01-14 14:14:27.836 - INFO - 合并所有样本结果（SQLite优化版本）
2026-01-14 14:14:27.836 - INFO - 初始化SQLite数据库|Initializing SQLite database
2026-01-14 14:14:27.850 - INFO - 插入BED数据到数据库|Inserting BED data into database
2026-01-14 14:14:27.851 - INFO - BED数据插入完成，共 0 条记录
2026-01-14 14:14:27.851 - INFO - 更新样本丰度数据|Updating sample abundance data
2026-01-14 14:14:27.851 - WARNING - 样本文件为空: OV8-105
2026-01-14 14:14:27.851 - WARNING - 样本文件为空: OV8-106
2026-01-14 14:14:27.852 - INFO - 导出最终矩阵为TSV文件|Exporting final matrix to TSV
2026-01-14 14:14:27.852 - INFO - 导出 0 行 × 9 列
2026-01-14 14:14:27.852 - INFO - 临时数据库已删除|Temporary database deleted
2026-01-14 14:14:27.852 - INFO - 最终矩阵已保存: 03.kmer丰度/kmer_abundance_matrix.tsv
2026-01-14 14:14:27.852 - INFO - 步骤7: 合并结果|Step 7: Merging results 已完成|步骤7: 合并结果|Step 7: Merging results completed
2026-01-14 14:14:27.852 - INFO - 进度已保存|Progress saved to: 03.kmer丰度/.kmer_count_progress.json
2026-01-14 14:14:27.853 - INFO - 步骤8: 保存最终结果|Step 8: Saving final results
2026-01-14 14:14:27.853 - ERROR - 分析过程中出现错误|Error during analysis: 'NoneType' object has no attribute 'to_csv'
2026-01-14 14:14:27.853 - INFO - 临时目录已清理|Temporary directory cleaned
错误|Error: 'NoneType' object has no attribute 'to_csv'
