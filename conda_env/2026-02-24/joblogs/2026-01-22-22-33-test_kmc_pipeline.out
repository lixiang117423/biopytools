2026-01-22 22:33:29.918 - INFO - 开始k-mer统计模式|Starting k-mer counting mode
2026-01-22 22:33:29.918 - INFO - 检测到目录输入模式|Detected directory input mode: fastq
2026-01-22 22:33:29.918 - INFO - 数据模式|Data mode: 双末端|Paired-end
2026-01-22 22:33:29.918 - INFO - 文件模式|File pattern: *_1.clean.fq, *_2.clean.fq
2026-01-22 22:33:29.918 - INFO - 找到 3 个read1文件|Found 3 read1 files
2026-01-22 22:33:29.919 - INFO - 验证通过|Validation passed: 3 个样本|samples
2026-01-22 22:33:29.919 - INFO - 开始统计 3 个样本|Starting to count 3 samples
2026-01-22 22:33:29.919 - INFO - 处理进度|Progress: 1/3: test1
2026-01-22 22:33:29.919 - INFO - 开始统计样本|Starting to count sample: test1
2026-01-22 22:33:29.936 - INFO - 执行步骤|Executing step: 统计样本|Counting sample test1
2026-01-22 22:33:29.936 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc -k51 -ci2 -t64 @/share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test1/input_files.txt test1 /share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test1
2026-01-22 22:33:32.356 - INFO - 命令执行成功|Command executed successfully: 统计样本|Counting sample test1
2026-01-22 22:33:32.358 - INFO - 样本统计完成|Sample counting completed: test1
2026-01-22 22:33:32.358 - INFO - 处理进度|Progress: 2/3: test2
2026-01-22 22:33:32.359 - INFO - 开始统计样本|Starting to count sample: test2
2026-01-22 22:33:32.359 - INFO - 执行步骤|Executing step: 统计样本|Counting sample test2
2026-01-22 22:33:32.359 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc -k51 -ci2 -t64 @/share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test2/input_files.txt test2 /share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test2
2026-01-22 22:33:33.847 - INFO - 命令执行成功|Command executed successfully: 统计样本|Counting sample test2
2026-01-22 22:33:33.848 - INFO - 样本统计完成|Sample counting completed: test2
2026-01-22 22:33:33.848 - INFO - 处理进度|Progress: 3/3: test3
2026-01-22 22:33:33.848 - INFO - 开始统计样本|Starting to count sample: test3
2026-01-22 22:33:33.849 - INFO - 执行步骤|Executing step: 统计样本|Counting sample test3
2026-01-22 22:33:33.849 - INFO - 命令|Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/kmc_v.3.2.4/bin/kmc -k51 -ci2 -t64 @/share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test3/input_files.txt test3 /share/org/YZWL/yzwl_lixg/tmp/test_kmc/test/kmc_tmp/test3
2026-01-22 22:33:35.506 - INFO - 命令执行成功|Command executed successfully: 统计样本|Counting sample test3
2026-01-22 22:33:35.506 - INFO - 样本统计完成|Sample counting completed: test3
2026-01-22 22:33:35.507 - INFO - 统计完成|Counting completed: 3/3 个样本成功|samples successful
2026-01-22 22:33:35.507 - INFO - 统计完成|Counting completed: 3/3 个样本成功|samples successful
2026-01-22 22:33:35.508 - INFO - Metadata文件已保存|Metadata file saved: database/kmer_metadata.json
2026-01-22 22:33:35.508 - INFO - k-mer大小|K-mer size: 51
2026-01-22 22:33:35.661 - INFO - 开始丰度矩阵构建模式|Starting abundance matrix building mode
2026-01-22 22:33:35.662 - INFO - 使用自定义输入目录|Using custom input directory: database/kmc_databases
2026-01-22 22:33:35.662 - INFO - 从count metadata读取k-mer大小|Read k-mer size from count metadata: 21 → 51
2026-01-22 22:33:35.662 - INFO - 未指定样本名称，自动扫描数据库|No sample names specified, auto-scanning databases
2026-01-22 22:33:35.662 - INFO - 扫描已存在的KMC数据库|Scanning existing KMC databases
2026-01-22 22:33:35.662 - INFO - 找到 3 个KMC数据库|Found 3 KMC databases
2026-01-22 22:33:35.662 - INFO - 开始构建丰度矩阵|Starting to build abundance matrix: 3 样本|samples
2026-01-22 22:33:35.709 - INFO - 发现已存在的矩阵包含 3 个样本|Found existing matrix with 3 samples
2026-01-22 22:33:35.711 - INFO - 已处理样本|Already processed: ['test2', 'test3', 'test1']
2026-01-22 22:33:35.711 - INFO - 所有样本已处理，无需重新构建|All samples already processed, no need to rebuild
2026-01-22 22:33:35.712 - INFO - 矩阵统计|Matrix statistics:
2026-01-22 22:33:35.712 - INFO -   k-mer数量|K-mer count: 34.68M
2026-01-22 22:33:35.712 - INFO -   样本数量|Sample count: 3
2026-01-22 22:33:35.712 - INFO -   k-mer长度|K-mer size: 51
2026-01-22 22:33:35.712 - INFO -   存储类型|Storage type: sparse
2026-01-22 22:33:35.712 - INFO -   稀疏度|Sparsity: 5.00%
2026-01-22 22:33:35.712 - INFO - 自动导出TSV文件|Auto exporting TSV files
2026-01-22 22:33:35.712 - INFO - 导出丰度文件|Exporting abundance file: database/abundance_matrix.tsv
2026-01-22 22:33:35.712 - INFO - 开始导出矩阵到TSV|Starting to export matrix to TSV: database/abundance_matrix.tsv
2026-01-22 22:33:35.712 - INFO - 输出格式|Output format: full
2026-01-22 22:33:35.712 - INFO - 最小丰度阈值|Minimum abundance threshold: 1
2026-01-22 22:33:35.712 - ERROR - k-mer字典文件不存在|K-mer dictionary file not found: database/kmer_dictionary.h5
2026-01-22 22:33:35.712 - INFO - 导出存在文件|Exporting presence file: database/presence_matrix.tsv
2026-01-22 22:33:35.713 - ERROR - 程序执行出错|Program execution error: [Errno 2] Unable to synchronously open file (unable to open file: name = 'database/kmer_dictionary.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
