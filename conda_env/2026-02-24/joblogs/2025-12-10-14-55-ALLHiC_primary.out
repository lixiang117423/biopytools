ğŸ“ Log file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/primary/logs/allhic_20251210_145556.log

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”§ Setting up environment
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-10 14:56:01] Checking required tools...
[2025-12-10 14:56:01] âœ… Environment ready
[2025-12-10 14:56:01] Working directory: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/primary
[2025-12-10 14:56:01] Threads: 88
[2025-12-10 14:56:01] Memory: 800G
[2025-12-10 14:56:01] Chromosomes: 12
[2025-12-10 14:56:01] Enzyme: GATC
[2025-12-10 14:56:01] â±ï¸  Step completed in 5s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸš€ Starting ALLHiC Pipeline v4.1
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”— [Step 0] Preparing input data
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-10 14:56:01] âœ… Input files linked
[2025-12-10 14:56:01] â±ï¸  Step completed in 0s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ” [Step 1] Mapping Hi-C reads
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-10 14:56:01] Building BWA index...
[2025-12-10 14:56:01] â–¶ï¸  bwa index draft.asm.fasta
[bwa_index] Pack FASTA... 6.10 sec
[bwa_index] Construct BWT for the packed sequence...
[BWTIncCreate] textLength=3028876484, availableWord=225122508
[BWTIncConstructFromPacked] 10 iterations done. 99999988 characters processed.
[BWTIncConstructFromPacked] 20 iterations done. 199999988 characters processed.
[BWTIncConstructFromPacked] 30 iterations done. 299999988 characters processed.
[BWTIncConstructFromPacked] 40 iterations done. 399999988 characters processed.
[BWTIncConstructFromPacked] 50 iterations done. 499999988 characters processed.
[BWTIncConstructFromPacked] 60 iterations done. 599999988 characters processed.
[BWTIncConstructFromPacked] 70 iterations done. 699999988 characters processed.
[BWTIncConstructFromPacked] 80 iterations done. 799999988 characters processed.
[BWTIncConstructFromPacked] 90 iterations done. 899999988 characters processed.
[BWTIncConstructFromPacked] 100 iterations done. 999999988 characters processed.
[BWTIncConstructFromPacked] 110 iterations done. 1099999988 characters processed.
[BWTIncConstructFromPacked] 120 iterations done. 1199999988 characters processed.
[BWTIncConstructFromPacked] 130 iterations done. 1299999988 characters processed.
[BWTIncConstructFromPacked] 140 iterations done. 1399999988 characters processed.
[BWTIncConstructFromPacked] 150 iterations done. 1499999988 characters processed.
[BWTIncConstructFromPacked] 160 iterations done. 1599999988 characters processed.
[BWTIncConstructFromPacked] 170 iterations done. 1699999988 characters processed.
[BWTIncConstructFromPacked] 180 iterations done. 1799999988 characters processed.
[BWTIncConstructFromPacked] 190 iterations done. 1899999988 characters processed.
[BWTIncConstructFromPacked] 200 iterations done. 1999999988 characters processed.
[BWTIncConstructFromPacked] 210 iterations done. 2099999988 characters processed.
[BWTIncConstructFromPacked] 220 iterations done. 2199999988 characters processed.
[BWTIncConstructFromPacked] 230 iterations done. 2299999988 characters processed.
[BWTIncConstructFromPacked] 240 iterations done. 2398701460 characters processed.
[BWTIncConstructFromPacked] 250 iterations done. 2487898420 characters processed.
[BWTIncConstructFromPacked] 260 iterations done. 2567172884 characters processed.
[BWTIncConstructFromPacked] 270 iterations done. 2637628212 characters processed.
[BWTIncConstructFromPacked] 280 iterations done. 2700245076 characters processed.
[BWTIncConstructFromPacked] 290 iterations done. 2755895108 characters processed.
[BWTIncConstructFromPacked] 300 iterations done. 2805352996 characters processed.
[BWTIncConstructFromPacked] 310 iterations done. 2849307252 characters processed.
[BWTIncConstructFromPacked] 320 iterations done. 2888369860 characters processed.
[BWTIncConstructFromPacked] 330 iterations done. 2923084772 characters processed.
[BWTIncConstructFromPacked] 340 iterations done. 2953935460 characters processed.
[BWTIncConstructFromPacked] 350 iterations done. 2981351588 characters processed.
[BWTIncConstructFromPacked] 360 iterations done. 3005715092 characters processed.
[BWTIncConstructFromPacked] 370 iterations done. 3027365412 characters processed.
[bwt_gen] Finished constructing BWT in 371 iterations.
[bwa_index] 855.09 seconds elapse.
[bwa_index] Update BWT... 5.75 sec
[bwa_index] Pack forward-only FASTA... 3.58 sec
[bwa_index] Construct SA from BWT and Occ... 371.96 sec
[main] Version: 0.7.19-r1273
[main] CMD: bwa index draft.asm.fasta
[main] Real time: 1245.089 sec; CPU: 1242.484 sec
[2025-12-10 15:16:46] Building samtools index...
[2025-12-10 15:16:46] â–¶ï¸  samtools faidx draft.asm.fasta
[2025-12-10 15:16:50] Running BWA MEM alignment...
[2025-12-10 15:16:50] â–¶ï¸  bwa mem -t 88 -5SP draft.asm.fasta reads_R1.fastq.gz reads_R2.fastq.gz 2>logs/bwa_mapping.log |              samtools view -@ 88 -hF 2316 -q 30 - |              samtools sort -@ 88 -n -o sample.clean.bam -
[bam_sort_core] merging from 4 files and 88 in-memory blocks...
[2025-12-10 23:51:17] âœ… Mapping completed
[2025-12-10 23:51:17] â±ï¸  Step completed in 8h 55m 16s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ§¬ [Step 1.5] Allele detection
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-10 23:51:17] â–¶ï¸  allhic extract sample.clean.bam draft.asm.fasta --RE GATC
[32m23:51:19 writeRE | NOTICE [0m RE counts in 1211 contigs (total: 7737245, avg 1 per 195 bp) written to `sample.clean.counts_GATC.txt`
[32m23:51:19 extractContigLinks | NOTICE [0m Parse bamfile `sample.clean.bam`
[32m00:03:56 extractContigLinks | NOTICE [0m Extracted 1015 intra-contig link groups (total = 48789669)
[32m00:09:12 extractContigLinks | NOTICE [0m Extracted 633790 inter-contig groups to `sample.clean.clm` (total = 1570341304, maxLinks = 417003, minLinks = 3)
[32m00:09:14 fitPowerLaw | NOTICE [0m Power law Y = 0.000177 * X ^ -0.7032
[32m00:09:14 writeDistribution | NOTICE [0m Link size distribution written to `sample.clean.distribution.txt`
[32m00:09:14 readClmLines | NOTICE [0m Parse clmfile `sample.clean.clm`
[32m00:10:17 calcInterContigs | NOTICE [0m Contig pair analyses written to `sample.clean.pairs.txt`
[32m00:10:17 Run | NOTICE [0m Success
[2025-12-11 00:10:17] â–¶ï¸  minimap2 -DP -k19 -w19 -m200 -t 88 draft.asm.fasta draft.asm.fasta 2>logs/minimap2.log > draft.asm.paf
[2025-12-11 00:31:33] â–¶ï¸  allhic alleles draft.asm.paf sample.clean.counts_GATC.txt > alleles.table
[32m00:31:33 ParseRecords | NOTICE [0m Parse paffile `draft.asm.paf`
[32m00:34:15 ReadCSVLines | NOTICE [0m Parse csvfile `sample.clean.counts_GATC.txt`
[32m00:34:15 Run | NOTICE [0m Success
[2025-12-11 00:34:15] âœ… Allele detection completed
[2025-12-11 00:34:15] â±ï¸  Step completed in 42m 58s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ‚ï¸  [Step 2] Pruning chimeric contigs
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 00:34:15] âš ï¸  No allele table found, using original BAM
[2025-12-11 00:34:15] âœ… Pruning completed
[2025-12-11 00:34:15] â±ï¸  Step completed in 0s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“¦ [Step 3] Partitioning contigs
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 00:34:15] â–¶ï¸  ALLHiC_partition -b prunning.bam -r draft.asm.fasta -e GATC -k 12
Extract function: calculate an empirical distribution of Hi-C link size based on intra-contig links
CMD: allhic extract prunning.bam draft.asm.fasta --RE GATC
[32m00:34:17 writeRE | NOTICE [0m RE counts in 1211 contigs (total: 7737245, avg 1 per 195 bp) written to `prunning.counts_GATC.txt`
[32m00:34:17 extractContigLinks | NOTICE [0m Parse bamfile `prunning.bam`
[32m00:46:53 extractContigLinks | NOTICE [0m Extracted 1015 intra-contig link groups (total = 48789669)
[32m00:52:08 extractContigLinks | NOTICE [0m Extracted 633790 inter-contig groups to `prunning.clm` (total = 1570341304, maxLinks = 417003, minLinks = 3)
[32m00:52:10 fitPowerLaw | NOTICE [0m Power law Y = 0.000177 * X ^ -0.7032
[32m00:52:10 writeDistribution | NOTICE [0m Link size distribution written to `prunning.distribution.txt`
[32m00:52:10 readClmLines | NOTICE [0m Parse clmfile `prunning.clm`
[32m00:53:11 calcInterContigs | NOTICE [0m Contig pair analyses written to `prunning.pairs.txt`
[32m00:53:11 Run | NOTICE [0m Success
Partition contigs based on prunning bam file
CMD: allhic partition prunning.counts_GATC.txt prunning.pairs.txt 12 --minREs 25
[32m00:53:12 ReadCSVLines | NOTICE [0m Parse csvfile `prunning.counts_GATC.txt`
[32m00:53:12 readRE | NOTICE [0m Loaded 1211 contig RE lengths for normalization from `prunning.counts_GATC.txt`
[32m00:53:12 skipContigsWithFewREs | NOTICE [0m skipContigsWithFewREs with MinREs = 25 (RE = GATC)
[32m00:53:12 skipContigsWithFewREs | NOTICE [0m Marked 0 contigs (avg 0.0 RE sites, len 0) since they contain too few REs (MinREs = 25)
[32m00:53:12 ReadCSVLines | NOTICE [0m Parse csvfile `prunning.pairs.txt`
[32m00:53:12 skipRepeats | NOTICE [0m skipRepeats with multiplicity = 2
Contig #63 (ptg000064l) has 2.2x the average number of Hi-C links -> MARKED REPETITIVE
Contig #80 (ptg000081l) has 2.3x the average number of Hi-C links -> MARKED REPETITIVE
Contig #429 (ptg000430l) has 2.2x the average number of Hi-C links -> MARKED REPETITIVE
Contig #526 (ptg000527l) has 2.5x the average number of Hi-C links -> MARKED REPETITIVE
Contig #589 (ptg000590l) has 2.3x the average number of Hi-C links -> MARKED REPETITIVE
Contig #638 (ptg000639l) has 2.3x the average number of Hi-C links -> MARKED REPETITIVE
Contig #775 (ptg000776l) has 2.2x the average number of Hi-C links -> MARKED REPETITIVE
Contig #787 (ptg000788l) has 2.0x the average number of Hi-C links -> MARKED REPETITIVE
Contig #797 (ptg000798l) has 24.8x the average number of Hi-C links -> MARKED REPETITIVE
Contig #800 (ptg000801l) has 2.8x the average number of Hi-C links -> MARKED REPETITIVE
Contig #852 (ptg000853l) has 2.1x the average number of Hi-C links -> MARKED REPETITIVE
Contig #909 (ptg000910l) has 30.1x the average number of Hi-C links -> MARKED REPETITIVE
Contig #958 (ptg000959l) has 34.5x the average number of Hi-C links -> MARKED REPETITIVE
Contig #960 (ptg000961l) has 48.4x the average number of Hi-C links -> MARKED REPETITIVE
Contig #962 (ptg000963l) has 6.1x the average number of Hi-C links -> MARKED REPETITIVE
Contig #976 (ptg000977l) has 8.4x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1023 (ptg001024l) has 14.2x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1075 (ptg001076l) has 2.1x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1124 (ptg001125l) has 2.1x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1132 (ptg001133l) has 16.9x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1133 (ptg001134l) has 11.5x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1138 (ptg001139l) has 2.3x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1143 (ptg001144l) has 4.6x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1168 (ptg001169l) has 23.9x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1178 (ptg001179l) has 9.7x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1195 (ptg001196l) has 2.8x the average number of Hi-C links -> MARKED REPETITIVE
Contig #1210 (ptg001211l) has 6.3x the average number of Hi-C links -> MARKED REPETITIVE
[32m00:53:12 skipRepeats | NOTICE [0m Marked 27 contigs (avg len 445040) as repetitive (MaxLinkDensity = 2)
[32m00:53:12 Cluster | NOTICE [0m Clustering starts with 1211 (1184 informative) contigs with target of 12 clusters
[32m00:53:13 Cluster | NOTICE [0m Merge #50: Clusters	510 + 1215 -> 1260, Linkage = 2.5082197e+07
[32m00:53:14 Cluster | NOTICE [0m Merge #100: Clusters	1014 + 1282 -> 1310, Linkage = 1.611818e+07
[32m00:53:14 Cluster | NOTICE [0m Merge #150: Clusters	405 + 597 -> 1360, Linkage = 1.3136335e+07
[32m00:53:15 Cluster | NOTICE [0m Merge #200: Clusters	578 + 712 -> 1410, Linkage = 1.1085136e+07
[32m00:53:15 Cluster | NOTICE [0m Merge #250: Clusters	367 + 1260 -> 1460, Linkage = 9.946411333333334e+06
[32m00:53:16 Cluster | NOTICE [0m Merge #300: Clusters	848 + 1509 -> 1510, Linkage = 9.8499495e+06
[32m00:53:16 Cluster | NOTICE [0m Merge #350: Clusters	610 + 1351 -> 1560, Linkage = 8.048306e+06
[32m00:53:17 Cluster | NOTICE [0m Merge #400: Clusters	1324 + 1609 -> 1610, Linkage = 8.41880475e+06
[32m00:53:17 Cluster | NOTICE [0m Merge #450: Clusters	404 + 907 -> 1660, Linkage = 6.312134e+06
[32m00:53:17 Cluster | NOTICE [0m Merge #500: Clusters	42 + 629 -> 1710, Linkage = 5.581764e+06
[32m00:53:17 Cluster | NOTICE [0m Merge #550: Clusters	278 + 1670 -> 1760, Linkage = 5.080274e+06
[32m00:53:17 Cluster | NOTICE [0m Merge #600: Clusters	36 + 433 -> 1810, Linkage = 4.555537e+06
[32m00:53:18 Cluster | NOTICE [0m Merge #650: Clusters	6 + 1756 -> 1860, Linkage = 4.0281135e+06
[32m00:53:18 Cluster | NOTICE [0m Merge #700: Clusters	132 + 170 -> 1910, Linkage = 3.611003e+06
[32m00:53:18 Cluster | NOTICE [0m Merge #750: Clusters	1613 + 1760 -> 1960, Linkage = 3.1885546666666665e+06
[32m00:53:18 Cluster | NOTICE [0m Merge #800: Clusters	1805 + 2009 -> 2010, Linkage = 2.8273529777777777e+06
[32m00:53:18 Cluster | NOTICE [0m Merge #850: Clusters	1881 + 1943 -> 2060, Linkage = 2.2094698333333335e+06
[32m00:53:18 Cluster | NOTICE [0m Merge #900: Clusters	1098 + 2064 -> 2110, Linkage = 1.6924386666666667e+06
[32m00:53:18 Cluster | NOTICE [0m Merge #950: Clusters	1179 + 2130 -> 2160, Linkage = 1.2535491666666667e+06
[32m00:53:18 Cluster | NOTICE [0m Merge #1000: Clusters	1090 + 2189 -> 2210, Linkage = 863840.6
[32m00:53:18 Cluster | NOTICE [0m Merge #1050: Clusters	2244 + 2249 -> 2260, Linkage = 648175.7636363637
[32m00:53:18 Cluster | NOTICE [0m Merge #1100: Clusters	1083 + 2286 -> 2310, Linkage = 472918.537037037
[32m00:53:18 Cluster | NOTICE [0m Merge #1150: Clusters	880 + 2355 -> 2360, Linkage = 369927.52777777775
[32m00:53:18 Cluster | NOTICE [0m 1170 merges made so far; this leaves 12 clusters, and so we'r done!
[32m00:53:18 setClusters | NOTICE [0m setClusters summary (NonInformativeRatio = 3): nPassRatio = 14, nFailRatio = 13, nFailCluster=0
[32m00:53:18 printClusters | NOTICE [0m Write 12 partitions to `prunning.clusters.txt`
[32m00:53:18 writeRE | NOTICE [0m RE counts in 28 contigs (total: 415279, avg 1 per 181 bp) written to `prunning.counts_GATC.12g9.txt`
[32m00:53:18 writeRE | NOTICE [0m RE counts in 26 contigs (total: 276180, avg 1 per 173 bp) written to `prunning.counts_GATC.12g11.txt`
[32m00:53:18 writeRE | NOTICE [0m RE counts in 25 contigs (total: 2460, avg 1 per 420 bp) written to `prunning.counts_GATC.12g12.txt`
[32m00:53:18 writeRE | NOTICE [0m RE counts in 282 contigs (total: 1956956, avg 1 per 203 bp) written to `prunning.counts_GATC.12g1.txt`
[32m00:53:18 writeRE | NOTICE [0m RE counts in 99 contigs (total: 694484, avg 1 per 192 bp) written to `prunning.counts_GATC.12g4.txt`
[32m00:53:18 writeRE | NOTICE [0m RE counts in 95 contigs (total: 627217, avg 1 per 193 bp) written to `prunning.counts_GATC.12g8.txt`
[32m00:53:18 writeRE | NOTICE [0m RE counts in 120 contigs (total: 653417, avg 1 per 196 bp) written to `prunning.counts_GATC.12g6.txt`
[32m00:53:18 writeRE | NOTICE [0m RE counts in 102 contigs (total: 657646, avg 1 per 191 bp) written to `prunning.counts_GATC.12g7.txt`
[32m00:53:18 writeRE | NOTICE [0m RE counts in 27 contigs (total: 267193, avg 1 per 208 bp) written to `prunning.counts_GATC.12g10.txt`
[32m00:53:18 writeRE | NOTICE [0m RE counts in 138 contigs (total: 792656, avg 1 per 190 bp) written to `prunning.counts_GATC.12g2.txt`
[32m00:53:18 writeRE | NOTICE [0m RE counts in 129 contigs (total: 699131, avg 1 per 195 bp) written to `prunning.counts_GATC.12g3.txt`
[32m00:53:18 writeRE | NOTICE [0m RE counts in 125 contigs (total: 663647, avg 1 per 197 bp) written to `prunning.counts_GATC.12g5.txt`
[32m00:53:18 Run | NOTICE [0m Success
[2025-12-11 00:53:18] âœ… Partition completed
[2025-12-11 00:53:18] â±ï¸  Step completed in 19m 3s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ§¬ [Step 3.5] Extracting contact matrix
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 00:53:18] âœ… Found existing: sample.clean.clm
[2025-12-11 00:53:18] â±ï¸  Step completed in 0s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸš‘ [Step 4] Rescuing unplaced contigs
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 00:53:18] â–¶ï¸  ALLHiC_rescue -b sample.clean.bam -r draft.asm.fasta              -c prunning.clusters.txt -i sample.clean.counts_GATC.txt
Starting rescue ungrouped contigs
Reading contig length
Reading link signals ...
Reading sample.clean.bam
find ungrouped contigs ...
output HiC link signals ...
Output refined clusters 
Number of original contigs in group9: 28
Number of rescued contigs in group9: 0
Number of original contigs in group8: 95
Number of rescued contigs in group8: 0
Number of original contigs in group12: 25
Number of rescued contigs in group12: 0
Number of original contigs in group11: 26
Number of rescued contigs in group11: 0
Number of original contigs in group3: 129
Number of rescued contigs in group3: 0
Number of original contigs in group4: 99
Number of rescued contigs in group4: 0
Number of original contigs in group10: 27
Number of rescued contigs in group10: 0
Number of original contigs in group1: 282
Number of rescued contigs in group1: 13
Number of original contigs in group2: 138
Number of rescued contigs in group2: 0
Number of original contigs in group7: 102
Number of rescued contigs in group7: 0
Number of original contigs in group6: 120
Number of rescued contigs in group6: 0
Number of original contigs in group5: 125
Number of rescued contigs in group5: 0
[2025-12-11 01:35:42] âœ… Rescue completed
[2025-12-11 01:35:42] â±ï¸  Step completed in 42m 24s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš™ï¸  [Step 5] Optimizing contig order
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 01:35:42]   Processing: prunning.counts_GATC.12g10.txt -> group10.txt
[2025-12-11 01:35:42]   Processing: prunning.counts_GATC.12g11.txt -> group11.txt
[2025-12-11 01:35:42]   Processing: prunning.counts_GATC.12g12.txt -> group12.txt
[2025-12-11 01:35:42]   Processing: prunning.counts_GATC.12g1.txt -> group1.txt
[2025-12-11 01:35:42]   Processing: prunning.counts_GATC.12g2.txt -> group2.txt
[2025-12-11 01:35:42]   Processing: prunning.counts_GATC.12g3.txt -> group3.txt
[2025-12-11 01:35:42]   Processing: prunning.counts_GATC.12g4.txt -> group4.txt
[2025-12-11 01:35:42]   Processing: prunning.counts_GATC.12g5.txt -> group5.txt
[2025-12-11 01:35:42]   Processing: prunning.counts_GATC.12g6.txt -> group6.txt
[2025-12-11 01:35:42]   Processing: prunning.counts_GATC.12g7.txt -> group7.txt
[2025-12-11 01:35:42]   Processing: prunning.counts_GATC.12g8.txt -> group8.txt
[2025-12-11 01:35:42]   Processing: prunning.counts_GATC.12g9.txt -> group9.txt
[2025-12-11 01:35:42] Found 12 chromosome groups
[2025-12-11 01:35:42] Need to optimize 12 groups: 1 2 3 4 5 6 7 8 9 10 11 12
[2025-12-11 01:35:42] Running optimization in parallel (max 88 jobs)...
[2025-12-11 01:35:42] Using GNU Parallel for optimization
[01:35:43] Starting optimization for group2
[01:35:43] Starting optimization for group4
[01:35:43] Starting optimization for group11
[01:35:43] Starting optimization for group1
[01:35:43] Starting optimization for group7
[01:35:43] Starting optimization for group8
[01:35:43] Starting optimization for group10
[01:35:43] Starting optimization for group6
[01:35:43] Starting optimization for group9
[01:35:43] Starting optimization for group5
[01:35:43] Starting optimization for group3
[01:35:43] Starting optimization for group12
[01:36:56] âœ… Group 9 completed
[01:36:56] âœ… Group 4 completed
[01:36:57] âœ… Group 12 completed
[01:36:57] âœ… Group 10 completed
[01:36:59] âœ… Group 5 completed
[01:37:00] âœ… Group 8 completed
[01:37:02] âœ… Group 11 completed
[01:37:02] âœ… Group 2 completed
[01:37:05] âœ… Group 3 completed
[01:37:07] âœ… Group 6 completed
[01:37:08] âœ… Group 7 completed
[01:37:48] âœ… Group 1 completed
[2025-12-11 01:37:48] 
[2025-12-11 01:37:48] Checking optimization results...
[2025-12-11 01:37:48]   âœ… Group 1: success
[2025-12-11 01:37:48]   âœ… Group 2: success
[2025-12-11 01:37:48]   âœ… Group 3: success
[2025-12-11 01:37:48]   âœ… Group 4: success
[2025-12-11 01:37:48]   âœ… Group 5: success
[2025-12-11 01:37:48]   âœ… Group 6: success
[2025-12-11 01:37:48]   âœ… Group 7: success
[2025-12-11 01:37:48]   âœ… Group 8: success
[2025-12-11 01:37:48]   âœ… Group 9: success
[2025-12-11 01:37:48]   âœ… Group 10: success
[2025-12-11 01:37:48]   âœ… Group 11: success
[2025-12-11 01:37:48]   âœ… Group 12: success
[2025-12-11 01:37:48] 
[2025-12-11 01:37:48] Optimization summary: 12/12 groups succeeded
[2025-12-11 01:37:48] âœ… All groups optimized successfully
[2025-12-11 01:37:48] â±ï¸  Step completed in 2m 6s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ—ï¸  [Step 6] Building final assembly
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 01:37:48] â–¶ï¸  ALLHiC_build draft.asm.fasta
1. tour format to agp ...
Processing group1.tour ...
Processing group10.tour ...
Processing group11.tour ...
Processing group12.tour ...
Processing group2.tour ...
Processing group3.tour ...
Processing group4.tour ...
Processing group5.tour ...
Processing group6.tour ...
Processing group7.tour ...
Processing group8.tour ...
Processing group9.tour ...
[2025-12-11 01:37:55] âœ… Build completed
[2025-12-11 01:37:55] â±ï¸  Step completed in 7s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š [Step 7] Generating contact maps
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 01:37:59] â–¶ï¸  ALLHiC_plot -b sample.clean.bam -a groups.agp -l chrn.list              -m 50k -s 500k -o ./
/share/org/YZWL/yzwl_lixg/software/ALLHiC/bin/ALLHiC_plot:178: UserWarning: Attempting to set identical low and high xlims makes transformation singular; automatically expanding.
  hmap = ax.imshow(np.log2(sub_data[: plt_cnt, : plt_cnt]), interpolation='nearest', origin='lower', cmap=cmap, aspect='equal')
/share/org/YZWL/yzwl_lixg/software/ALLHiC/bin/ALLHiC_plot:178: UserWarning: Attempting to set identical low and high ylims makes transformation singular; automatically expanding.
  hmap = ax.imshow(np.log2(sub_data[: plt_cnt, : plt_cnt]), interpolation='nearest', origin='lower', cmap=cmap, aspect='equal')
[32m[01:38:09][0m Step1: Get chromosome length
[32m[01:38:09][0m Step2: Get signal matrix
[32m[02:23:41][0m Step3: Draw heatmap
[32m[02:23:41][0m Drawing with bin size 500k
[32m[02:23:51][0m Success
[2025-12-11 02:23:52] âœ… Plotting completed
[2025-12-11 02:23:52] â±ï¸  Step completed in 45m 57s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ¨ [Step 8] Generating JBAT files for manual curation
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 02:23:52] Converting AGP to Assembly format...
[2025-12-11 02:23:52] â–¶ï¸  python3 '/share/org/YZWL/yzwl_lixg/software/3d-dna/utils/agp2assembly.py' groups.agp 'jbat_results/out_JBAT.assembly'
[2025-12-11 02:23:52] Mapping reads to draft contigs for HiC generation...
[2025-12-11 02:23:52] Running BWA MEM pipeline (this may take a while)...
[2025-12-11 13:11:45] âœ… MND file generated successfully
[2025-12-11 13:11:45] Generating HIC file using Juicer Tools...
[2025-12-11 13:11:45] â–¶ï¸  java -Xmx800G -jar '/share/org/YZWL/yzwl_lixg/software/juicer/CPU/common/juicer_tools.jar' pre 'jbat_results/draft.mnd.sorted.txt' 'jbat_results/draft.hic' 'jbat_results/draft.chrom.sizes'
WARNING: sun.reflect.Reflection.getCallerClass is not supported. This will impact performance.
WARN [2025-12-11T13:11:46,666]  [Globals.java:138] [main]  Development mode is enabled
Using 1 CPU thread(s)
Not including fragment map
Start preprocess
Writing header
Writing body
java.io.IOException: Unexpected column count.  Check file format
	at juicebox.tools.utils.original.AsciiPairIterator.advance(AsciiPairIterator.java:167)
	at juicebox.tools.utils.original.AsciiPairIterator.<init>(AsciiPairIterator.java:74)
	at juicebox.tools.utils.original.Preprocessor.computeWholeGenomeMatrix(Preprocessor.java:565)
	at juicebox.tools.utils.original.Preprocessor.writeBody(Preprocessor.java:658)
	at juicebox.tools.utils.original.Preprocessor.preprocess(Preprocessor.java:425)
	at juicebox.tools.clt.old.PreProcessing.run(PreProcessing.java:139)
	at juicebox.tools.HiCTools.main(HiCTools.java:94)
java.lang.RuntimeException: No reads in Hi-C contact matrices. This could be because the MAPQ filter is set too high (-q) or because all reads map to the same fragment.
	at juicebox.tools.utils.original.MatrixZoomDataPP.mergeAndWriteBlocks(MatrixZoomDataPP.java:276)
	at juicebox.tools.utils.original.Preprocessor.writeMatrix(Preprocessor.java:970)
	at juicebox.tools.utils.original.Preprocessor.writeBody(Preprocessor.java:659)
	at juicebox.tools.utils.original.Preprocessor.preprocess(Preprocessor.java:425)
	at juicebox.tools.clt.old.PreProcessing.run(PreProcessing.java:139)
	at juicebox.tools.HiCTools.main(HiCTools.java:94)
[2025-12-11 13:11:46] âœ… HIC file generated successfully
[2025-12-11 13:11:46] ğŸ’¡ Tip: You can remove jbat_results/draft.mnd.sorted.txt (44G) to save space

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ‰ JBAT Files Ready for Manual Curation
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 13:11:46] 
[2025-12-11 13:11:46] ğŸ“‚ Location: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/primary/jbat_results/
[2025-12-11 13:11:46] 
[2025-12-11 13:11:46] ğŸ“„ Files generated:
[2025-12-11 13:11:46]   1ï¸âƒ£  draft.hic           - Hi-C contact map (load this first in Juicebox)
[2025-12-11 13:11:46]   2ï¸âƒ£  out_JBAT.assembly   - Assembly structure file
[2025-12-11 13:11:46]   3ï¸âƒ£  draft.chrom.sizes   - Chromosome sizes
[2025-12-11 13:11:46] 
[2025-12-11 13:11:46] ğŸ”§ Instructions for Juicebox Assembly Tools (JBAT):
[2025-12-11 13:11:46]   1. Open Juicebox (https://aidenlab.org/juicebox/)
[2025-12-11 13:11:46]   2. Load draft.hic file
[2025-12-11 13:11:46]   3. Import assembly: Assembly â†’ Import Map Assembly â†’ out_JBAT.assembly
[2025-12-11 13:11:46]   4. Perform manual curation
[2025-12-11 13:11:46]   5. Export corrected assembly
[2025-12-11 13:11:46] 
[2025-12-11 13:11:46] â±ï¸  Step completed in 0s

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ‰ Pipeline Completed in 22h 15m 50s
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[2025-12-11 13:11:46] ğŸ“ Full log: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/21.ALLHiC_hap/primary/logs/allhic_20251210_145556.log
[2025-12-11 13:11:46]   ğŸ’¡ Run the optimize step first to generate group files
