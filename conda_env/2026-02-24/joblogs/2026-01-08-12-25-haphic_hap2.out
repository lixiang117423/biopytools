2026-01-08 12:25:11.522 - INFO - HapHiC处理器已初始化|HapHiC processor initialized
2026-01-08 12:25:11.561 - INFO - 配置参数|Configuration Parameters:
2026-01-08 12:25:11.561 - INFO -   assembly_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap2/OV53_1.hap2.primary.fa
2026-01-08 12:25:11.561 - INFO -   hic_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/01.data/hic/OV53_1-hic_R1.fastq.gz
2026-01-08 12:25:11.561 - INFO -   hic_file_type: fastq
2026-01-08 12:25:11.561 - INFO -   nchrs: 12
2026-01-08 12:25:11.561 - INFO -   output_dir: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap2
2026-01-08 12:25:11.561 - INFO -   prefix: OV53_1.hap2.primary
2026-01-08 12:25:11.561 - INFO -   threads: 64
2026-01-08 12:25:11.561 - INFO -   processes: 8
2026-01-08 12:25:11.561 - INFO -   quick_view: False
2026-01-08 12:25:11.561 - INFO -   restriction_sites: ['GATC']
2026-01-08 12:25:11.561 - INFO -   correct_nrounds: 2
2026-01-08 12:25:11.561 - INFO -   remove_allelic_links: None
2026-01-08 12:25:11.561 - INFO -   phasing_weight: 1.0
2026-01-08 12:25:11.561 - INFO -   gfa_files: None
2026-01-08 12:25:11.561 - INFO -   haphic_bin: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic
2026-01-08 12:25:11.561 - INFO -   bwa_bin: bwa
2026-01-08 12:25:11.561 - INFO -   samtools_bin: samtools
2026-01-08 12:25:11.561 - INFO - 开始HapHiC流程|Starting HapHiC pipeline
2026-01-08 12:25:11.561 - INFO - 系统预检查|System pre-flight checks
2026-01-08 12:25:11.561 - INFO - 验证输入文件|Validating input files
2026-01-08 12:25:12.635 - INFO - 基因组序列数量|Assembly sequence count: 972
2026-01-08 12:25:12.636 - INFO - FASTQ文件大小|FASTQ file sizes: R1 60.14 GB, R2 58.01 GB
2026-01-08 12:25:12.636 - INFO - 输入文件验证通过|Input files validated
2026-01-08 12:25:12.636 - INFO - 检查系统资源|Checking system resources
2026-01-08 12:25:12.839 - INFO - 可用内存|Available memory: 456.2 GB
2026-01-08 12:25:12.839 - INFO - 可用磁盘空间|Available disk space: 1517926.6 GB
2026-01-08 12:25:12.840 - INFO - CPU核心数|CPU cores: 88
2026-01-08 12:25:15.306 - INFO - 预检查通过|Pre-flight checks passed
2026-01-08 12:25:15.307 - INFO - 检查已存在的比对结果|Checking for existing alignment results
2026-01-08 12:25:15.307 - INFO - 输出目录: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap2
2026-01-08 12:25:15.307 - INFO - 比对目录: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap2/00.mapping
2026-01-08 12:25:15.307 - INFO - 潜在BAM文件: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap2/00.mapping/HiC.bam
2026-01-08 12:25:15.307 - INFO - 潜在过滤BAM文件: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap2/00.mapping/HiC.filtered.bam
2026-01-08 12:25:15.308 - INFO - 比对目录存在|Alignment directory exists
2026-01-08 12:25:15.308 - INFO - 比对目录内容: ['assembly.fa.amb', 'assembly.fa.bwt', 'assembly.fa.ann', 'assembly.fa', 'HiC.filtered.bam', 'assembly.fa.pac', 'read1_1.fastq.gz', 'HiC.bam', 'assembly.fa.sa', 'read2_1.fastq.gz']
2026-01-08 12:25:15.308 - INFO - 发现已存在的过滤BAM文件，跳过BWA比对步骤|Found existing filtered BAM file, skipping BWA alignment: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap2/00.mapping/HiC.filtered.bam (58,021,990,062 bytes)
2026-01-08 12:25:15.308 - INFO - 使用按read name排序的过滤BAM文件以满足HapHiC要求|Using read name-sorted filtered BAM file to meet HapHiC requirements
2026-01-08 12:25:15.308 - INFO -  开始HapHiC Pipeline流程|Starting HapHiC Pipeline
2026-01-08 12:25:15.310 - INFO -  设置目录结构|Setting up directory structure
2026-01-08 12:25:15.311 - INFO -  目录结构设置完成|Directory structure setup complete
2026-01-08 12:25:15.311 - INFO -  检查HapHiC Pipeline完成状态|Checking HapHiC Pipeline completion status
2026-01-08 12:25:15.395 - INFO -  Cluster步骤已完成|Cluster step completed
2026-01-08 12:25:15.395 - INFO -  Reassign步骤已完成|Reassign step completed
2026-01-08 12:25:15.395 - INFO -  Sort步骤已完成|Sort step completed
2026-01-08 12:25:15.395 - INFO -  Build步骤已完成|Build step completed
2026-01-08 12:25:15.395 - INFO -  HapHiC Pipeline已完成，跳过执行|HapHiC Pipeline already completed, skipping execution
2026-01-08 12:25:15.396 - INFO -  生成Hi-C接触图可视化|Generating Hi-C contact map visualization
2026-01-08 12:25:15.396 - INFO -  使用Raw AGP文件（格式更标准）: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap2/04.build/OV53_1.hap2.primary.raw.agp
2026-01-08 12:25:15.427 - INFO -  AGP文件预处理完成: 共 1824 行，跳过 0 行，输出到 /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap2/04.build/OV53_1.hap2.primary.raw.processed.agp
2026-01-08 12:25:15.427 - INFO - 生成可视化
2026-01-08 12:25:23.117 - ERROR - 命令执行失败|Command failed (返回码: 1)
2026-01-08 12:25:23.118 - ERROR - 命令输出|Command Output:
2026-01-08 12:25:23 <HapHiC_plot.py> [main] Program started, HapHiC version: 1.0.7 (update: 2025.05.07)
2026-01-08 12:25:23 <HapHiC_plot.py> [main] Python version: 3.12.12 | packaged by conda-forge | (main, Oct 22 2025, 23:25:55) [GCC 14.3.0]
2026-01-08 12:25:23 <HapHiC_plot.py> [main] Command: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap2/OV53_1.hap2.primary.fa /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap2/04.build/OV53_1.hap2.primary.raw.processed.agp --bin_size 500 --min_len 1
2026-01-08 12:25:23 <HapHiC_plot.py> [parse_agp] Parsing input AGP file...
Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py", line 840, in <module>
    main()
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py", line 808, in main
    ctg_dict, ctg_aln_dict, group_size_dict, frag_set, group_frag_dict = parse_agp(args.agp, bin_size)
                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py", line 60, in parse_agp
    if cols[4] == 'W':
       ~~~~^^^
IndexError: list index out of range
Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic", line 117, in <module>
    subprocess.run(commands, check=True)
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/lib/python3.12/subprocess.py", line 571, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py', '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap2/OV53_1.hap2.primary.fa', '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap2/04.build/OV53_1.hap2.primary.raw.processed.agp', '--bin_size', '500', '--min_len', '1']' returned non-zero exit status 1.
2026-01-08 12:25:23.118 - WARNING -  可视化生成失败，但继续执行其他步骤|Visualization failed, but continuing with other steps
2026-01-08 12:25:23.119 - INFO -  生成Juicebox文件|Generating Juicebox files
2026-01-08 12:25:23.119 - INFO -  Juicebox目录: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap2/06.juicebox
2026-01-08 12:25:23.119 - INFO -  使用HapHiC官方juicebox.sh脚本生成Juicebox文件|Using HapHiC official juicebox.sh script
2026-01-08 12:25:23.119 - INFO -  工作目录: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap2/04.build
2026-01-08 12:25:23.119 - INFO - 运行juicebox.sh脚本
2026-01-08 12:25:26.375 - ERROR - 命令执行失败|Command failed (返回码: 1)
2026-01-08 12:25:26.376 - ERROR - 命令输出|Command Output:
Error: Unable to access jarfile /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/../utils/juicer_tools.1.9.9_jcuda.0.8.jar
2026-01-08 12:25:26.376 - WARNING -  Juicebox文件生成失败，但继续执行其他步骤|Juicebox file generation failed, but continuing with other steps
2026-01-08 12:25:26.376 - INFO -  HapHiC Pipeline完成|HapHiC Pipeline completed in 11.07秒
2026-01-08 12:25:26.376 - INFO - 检测到纠错后的contig，需要重新比对Hi-C数据|Detected corrected contigs, need to realign Hi-C data
2026-01-08 12:25:26.376 - INFO - 创建纠错流程目录|Creating corrected workflow directory: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.三代数据组装和注释/43.单倍型挂载/hap2/07.corrected_contig_haphic
2026-01-08 12:25:26.376 - INFO - 开始重新比对Hi-C数据到纠错后的组装|Starting Hi-C realignment to corrected assembly
2026-01-08 12:25:26.377 - INFO -  开始BWA比对|Starting BWA alignment (official method)
2026-01-08 12:25:26.377 - INFO -  使用纠错后重新比对目录|Using corrected realignment directory
2026-01-08 12:25:26.377 - INFO -  使用提供的FASTQ文件对|Using provided FASTQ pair: OV53_1-hic_R1.fastq.gz
2026-01-08 12:25:26.377 - INFO -  找到 1 对FASTQ文件|Found 1 FASTQ pairs
2026-01-08 12:25:26.454 - INFO -  创建基因组软链接|Created assembly symlink: assembly.fa
2026-01-08 12:25:26.520 - INFO -  创建FASTQ软链接|Created FASTQ symlinks: read1_1.fastq.gz, read2_1.fastq.gz
2026-01-08 12:25:26.565 - INFO -  BWA索引已存在|BWA index already exists: assembly.fa
2026-01-08 12:25:26.565 - INFO -  步骤1: BWA比对 + 去重 + 初步过滤 (使用 64 线程)|Step 1: BWA alignment + deduplication + initial filtering (using 64 threads)
2026-01-08 12:25:26.565 - INFO -  创建纠错后的BAM文件|Creating corrected BAM file
2026-01-08 12:25:26.565 - INFO -  执行BWA比对管道|Executing BWA alignment pipeline
