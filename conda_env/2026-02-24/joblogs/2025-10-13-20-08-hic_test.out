==========================================
Hi-C数据质控分析 - 最终修正版 v4 (解决samtools header问题)
==========================================
样品: ov53-1-HIC1
限制性酶: MboI (GATC)
线程数: 88
工作目录: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/62.hic/20251011_test

2025年 10月 13日 星期一 20:08:52 CST

步骤1: 创建目录结构...
  ✓ 目录创建完成

步骤2: 生成限制性酶切位点BED文件...
  ✓ BED文件已存在

步骤3: 构建Bowtie2索引...
  ✓ 索引已存在

步骤4: 比对Hi-C reads并清理read名...
  比对 Read 1...
  ✓ R1比对完成
  比对 Read 2...
  ✓ R2比对完成

==========================================
步骤5: 构建Hi-C矩阵（最关键的一步）
==========================================
  这将需要 1-3 小时...

INFO:hicexplorer.lib.buildMatrixMethods:reading mapping/ov53-1-HIC1_R1.bam and mapping/ov53-1-HIC1_R2.bam to build hic_matrix

INFO:hicexplorer.lib.buildMatrixMethods:dangling sequences to check are {'GATC': {'pat_forw': 'GATC', 'pat_rev': 'GATC'}}

Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/.local/bin/hicBuildMatrix", line 7, in <module>
    main()
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/hicexplorer/lib/python3.12/site-packages/hicexplorer/hicBuildMatrix.py", line 265, in main
    createMatrix(pOutFileName=args.outFileName, pMaxDistance=args.maxDistance, pMaxLibraryInsertSize=args.maxLibraryInsertSize, pQCfolder=args.QCfolder,
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/hicexplorer/lib/python3.12/site-packages/hicexplorer/lib/buildMatrixMethods.py", line 1068, in createMatrix
    one_mate_low_quality_, iter_num_ = readBamFiles(pFileOneIterator=str1,
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/hicexplorer/lib/python3.12/site-packages/hicexplorer/lib/buildMatrixMethods.py", line 494, in readBamFiles
    assert mate1.qname == mate2.qname, "FATAL ERROR {} {} " \
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: FATAL ERROR E250103085L1C001R00100002405/1 E250103085L1C001R00100002405/2 Be sure that the sam files have the same read order If using Bowtie2 or Hisat2 add the --reorder option

  ✗ 矩阵构建失败
  查看日志: matrix/build_matrix.log
INFO:hicexplorer.lib.buildMatrixMethods:reading mapping/ov53-1-HIC1_R1.bam and mapping/ov53-1-HIC1_R2.bam to build hic_matrix

INFO:hicexplorer.lib.buildMatrixMethods:dangling sequences to check are {'GATC': {'pat_forw': 'GATC', 'pat_rev': 'GATC'}}

Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/.local/bin/hicBuildMatrix", line 7, in <module>
    main()
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/hicexplorer/lib/python3.12/site-packages/hicexplorer/hicBuildMatrix.py", line 265, in main
    createMatrix(pOutFileName=args.outFileName, pMaxDistance=args.maxDistance, pMaxLibraryInsertSize=args.maxLibraryInsertSize, pQCfolder=args.QCfolder,
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/hicexplorer/lib/python3.12/site-packages/hicexplorer/lib/buildMatrixMethods.py", line 1068, in createMatrix
    one_mate_low_quality_, iter_num_ = readBamFiles(pFileOneIterator=str1,
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/hicexplorer/lib/python3.12/site-packages/hicexplorer/lib/buildMatrixMethods.py", line 494, in readBamFiles
    assert mate1.qname == mate2.qname, "FATAL ERROR {} {} " \
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: FATAL ERROR E250103085L1C001R00100002405/1 E250103085L1C001R00100002405/2 Be sure that the sam files have the same read order If using Bowtie2 or Hisat2 add the --reorder option
