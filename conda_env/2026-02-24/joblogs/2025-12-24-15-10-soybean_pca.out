2025-12-24 15:10:30,026 - INFO - 开始VCF PCA分析流程 | Starting VCF PCA analysis pipeline
2025-12-24 15:10:30,027 - INFO - VCF文件 | VCF file: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/variation.filtered.snp.vcf.gz
2025-12-24 15:10:30,027 - INFO - 输出目录 | Output directory: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output
2025-12-24 15:10:30,027 - INFO - 检查依赖软件 | Checking dependencies
2025-12-24 15:10:30,337 - INFO - ✓ PLINK 可用 | available
2025-12-24 15:10:30,622 - INFO - ✓ BCFtools 可用 | available
2025-12-24 15:10:30,622 - INFO - ============================================================
2025-12-24 15:10:30,622 - INFO - 步骤1: VCF转PLINK格式 | Step 1: VCF to PLINK conversion
2025-12-24 15:10:30,622 - INFO - ============================================================
2025-12-24 15:10:30,623 - INFO - 获取VCF文件统计信息 | Getting VCF file statistics
2025-12-24 17:02:28,452 - INFO - VCF统计 | VCF statistics: 2162 样本 | samples, 11959424 变异 | variants
2025-12-24 17:02:28,453 - INFO - 开始处理包含 2162 个样本和 11959424 个变异的VCF文件
2025-12-24 17:02:28,455 - INFO - 输出目录可写 | Output directory is writable: pca_output
2025-12-24 17:02:28,455 - INFO - 执行步骤 | Executing step: VCF转换为PLINK格式 | Convert VCF to PLINK format
2025-12-24 17:02:28,455 - INFO - 命令 | Command: plink --vcf /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/variation.filtered.snp.vcf.gz --make-bed --out /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output/vcf_pca --allow-extra-chr --double-id
2025-12-24 17:02:28,455 - INFO - 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output
2025-12-24 17:46:01,824 - INFO - 命令执行成功 | Command executed successfully: VCF转换为PLINK格式 | Convert VCF to PLINK format
2025-12-24 17:46:01,824 - INFO - PLINK文件已生成 | PLINK files generated: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output/vcf_pca
2025-12-24 17:46:01,824 - INFO - ============================================================
2025-12-24 17:46:01,824 - INFO - 步骤2: 质量控制 | Step 2: Quality control
2025-12-24 17:46:01,824 - INFO - ============================================================
2025-12-24 17:46:01,824 - INFO - 跳过质量控制过滤 (用户指定) | Skipping quality control filtering (user specified)
2025-12-24 17:46:01,825 - INFO - 输入样本数 | Input samples: 2162
2025-12-24 17:46:02,430 - INFO - 输入SNP数 | Input SNPs: 11959424
2025-12-24 17:46:02,430 - INFO - ============================================================
2025-12-24 17:46:02,430 - INFO - 步骤3: PCA分析 | Step 3: PCA analysis
2025-12-24 17:46:02,430 - INFO - ============================================================
2025-12-24 17:46:02,431 - INFO - 开始PCA分析 | Starting PCA analysis
2025-12-24 17:46:02,431 - INFO - 主成分数量 | Number of components: 10
2025-12-24 17:46:02,431 - INFO - 执行步骤 | Executing step: PCA分析 | PCA analysis (10 components)
2025-12-24 17:46:02,431 - INFO - 命令 | Command: plink --bfile /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output/vcf_pca --pca 10 --out /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output/pca_results --allow-extra-chr
2025-12-24 17:46:02,431 - INFO - 工作目录 | Working directory: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output
2025-12-24 17:50:06,156 - INFO - 命令执行成功 | Command executed successfully: PCA分析 | PCA analysis (10 components)
2025-12-24 17:50:06,157 - INFO - 分析PCA结果 | Analyzing PCA results
2025-12-24 17:50:06,161 - INFO - PCA分析结果 | PCA Analysis Results:
2025-12-24 17:50:06,162 - INFO - 总方差 | Total variance: 926.0238
2025-12-24 17:50:06,162 - INFO - 主成分解释方差 | Principal component explained variance:
2025-12-24 17:50:06,162 - INFO -   PC1: 特征值 | Eigenvalue = 247.2300, 解释方差比 | Explained variance ratio = 0.2670 (26.70%), 累积 | Cumulative = 0.2670 (26.70%)
2025-12-24 17:50:06,162 - INFO -   PC2: 特征值 | Eigenvalue = 145.8320, 解释方差比 | Explained variance ratio = 0.1575 (15.75%), 累积 | Cumulative = 0.4245 (42.45%)
2025-12-24 17:50:06,162 - INFO -   PC3: 特征值 | Eigenvalue = 109.5360, 解释方差比 | Explained variance ratio = 0.1183 (11.83%), 累积 | Cumulative = 0.5427 (54.27%)
2025-12-24 17:50:06,162 - INFO -   PC4: 特征值 | Eigenvalue = 92.7448, 解释方差比 | Explained variance ratio = 0.1002 (10.02%), 累积 | Cumulative = 0.6429 (64.29%)
2025-12-24 17:50:06,162 - INFO -   PC5: 特征值 | Eigenvalue = 71.4842, 解释方差比 | Explained variance ratio = 0.0772 (7.72%), 累积 | Cumulative = 0.7201 (72.01%)
2025-12-24 17:50:06,162 - INFO -   PC6: 特征值 | Eigenvalue = 65.2170, 解释方差比 | Explained variance ratio = 0.0704 (7.04%), 累积 | Cumulative = 0.7905 (79.05%)
2025-12-24 17:50:06,162 - INFO -   PC7: 特征值 | Eigenvalue = 59.0145, 解释方差比 | Explained variance ratio = 0.0637 (6.37%), 累积 | Cumulative = 0.8543 (85.43%)
2025-12-24 17:50:06,162 - INFO -   PC8: 特征值 | Eigenvalue = 51.9811, 解释方差比 | Explained variance ratio = 0.0561 (5.61%), 累积 | Cumulative = 0.9104 (91.04%)
2025-12-24 17:50:06,162 - INFO -   PC9: 特征值 | Eigenvalue = 42.8058, 解释方差比 | Explained variance ratio = 0.0462 (4.62%), 累积 | Cumulative = 0.9566 (95.66%)
2025-12-24 17:50:06,162 - INFO -   PC10: 特征值 | Eigenvalue = 40.1784, 解释方差比 | Explained variance ratio = 0.0434 (4.34%), 累积 | Cumulative = 1.0000 (100.00%)
2025-12-24 17:50:06,182 - INFO - 解释方差表已保存 | Explained variance table saved: pca_output/pca_explained_variance.txt
2025-12-24 17:50:06,182 - INFO - 特征值说明文件已保存 | Eigenvalues explanation saved: pca_output/eigenvalues_explanation.txt
2025-12-24 17:50:06,207 - INFO - 格式化特征向量已保存 | Formatted eigenvectors saved: pca_output/pca_eigenvectors_formatted.txt
2025-12-24 17:50:06,208 - INFO - 总结报告已生成 | Summary report generated: pca_output/pca_analysis_summary.txt
2025-12-24 17:50:06,208 - INFO - ============================================================
2025-12-24 17:50:06,208 - INFO - PCA分析完成！| PCA analysis completed!
2025-12-24 17:50:06,208 - INFO - ============================================================
2025-12-24 17:50:06,208 - INFO - 结果保存在 | Results saved in: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/03.第一批720个样品/04.pca/pca_output
