ℹ️  [INFO] 检查依赖软件...
✅ [SUCCESS] 所有依赖软件检查通过

════════════════════════════════════════════════════════════════
            🧬 GWAS 自动化分析流程 v2.1
════════════════════════════════════════════════════════════════

ℹ️  [INFO] 输入 VCF 文件: variation.filtered.snp.vcf.gz
ℹ️  [INFO] 输入表型文件: 58.拟合用于测试GWAS的数据.txt
ℹ️  [INFO] 输出文件夹: output
ℹ️  [INFO] 主成分数量: 5
ℹ️  [INFO] MAF阈值: 0.05
ℹ️  [INFO] SNP缺失率阈值: 0.1
ℹ️  [INFO] 样本缺失率阈值: 0.1
ℹ️  [INFO] 线程数: 12
────────────────────────────────────────────────────────────────

ℹ️  [INFO] 为GEMMA准备一个无表头的临时表型文件...
✅ [SUCCESS] 临时表型文件已创建。

🔹 [STEP 1/6] 转换VCF文件为PLINK二进制格式 📁
✅ [SUCCESS] PLINK文件生成完成: output/genotypes.{bed,bim,fam}
ℹ️  [INFO] 样本数: 419
ℹ️  [INFO] SNP数: 370681

🔹 [STEP 2/6] 执行质量控制过滤 🔍
✅ [SUCCESS] 质控过滤完成
ℹ️  [INFO] 过滤后样本数: 414 (移除: 5)
ℹ️  [INFO] 过滤后SNP数: 11888 (移除: 358793)

ℹ️  [INFO] 确保基因型样本与表型文件匹配...
✅ [SUCCESS] 样本匹配完成
🔹 [STEP 3/6] 执行主成分分析 (PCA) 📊
✅ [SUCCESS] PCA分析完成: output/pca.eigenvec

🔹 [STEP 4/6] 准备GEMMA协变量文件 📝
⚠️  [WARNING] 协变量文件行数 (414) 与表型数据行数 (419) 不匹配
ℹ️  [INFO] 这可能是由于质控过滤导致的样本缺失
ℹ️  [INFO] 尝试自动匹配样本ID...
✅ [SUCCESS] 已根据表型文件重新匹配协变量样本
✅ [SUCCESS] 协变量文件生成完成: output/covariates.txt
ℹ️  [INFO] 样本数: 414
ℹ️  [INFO] 包含: FID + IID + 截距 + 5 个主成分

ℹ️  [INFO] 验证样本ID一致性...
⚠️  [WARNING] 基因型与表型样本ID不完全一致
	A2-2
	Nov-9
	SRR7532846
	SRR7532851
	T30-4
🔹 [STEP 5/6] 计算标准化亲缘关系矩阵 🧮
✅ [SUCCESS] 亲缘关系矩阵生成完成: output/kinship/kinship.cXX.txt

🔹 [STEP 6/6] 执行GEMMA关联分析 🚀
ℹ️  [INFO] 检测到 1 个性状，开始逐一分析...

  🔬 分析性状 [1/1]: DI
⚠️  [WARNING] 性状 DI 分析失败，请查看日志
ℹ️  [INFO] 清理临时文件...
✅ [SUCCESS] 清理完成

════════════════════════════════════════════════════════════════
✨ 所有分析完成！
════════════════════════════════════════════════════════════════

✅ [SUCCESS] 关联分析结果: output/association_results/gwas_*.assoc.txt
✅ [SUCCESS] 日志文件目录: output/logs/
✅ [SUCCESS] 亲缘关系矩阵: output/kinship/

ℹ️  [INFO] 总用时: 0分14秒

📊 建议后续分析步骤:
  1. 绘制曼哈顿图和QQ图
  2. 检查显著性位点的LD结构
  3. 进行基因注释和功能富集分析

════════════════════════════════════════════════════════════════

