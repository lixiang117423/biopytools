[2025-12-21 06:42:29] ğŸ§¬ HapHiCå¤„ç†å™¨å·²åˆå§‹åŒ– | HapHiC processor initialized
[2025-12-21 06:42:29] âš™ï¸ é…ç½®å‚æ•° | Configuration Parameters:
[2025-12-21 06:42:29]   assembly_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/02.assembly/OV53_1/02.fasta/OV53_1.primary.fa
[2025-12-21 06:42:29]   hic_file: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/01.data/hic/OV53_1-hic_R1.fastq.gz
[2025-12-21 06:42:29]   hic_file_type: fastq
[2025-12-21 06:42:29]   nchrs: 12
[2025-12-21 06:42:29]   output_dir: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary
[2025-12-21 06:42:29]   prefix: OV53_1.primary
[2025-12-21 06:42:29]   threads: 64
[2025-12-21 06:42:29]   processes: 8
[2025-12-21 06:42:29]   quick_view: False
[2025-12-21 06:42:29]   restriction_sites: ['GATC']
[2025-12-21 06:42:29]   correct_nrounds: 2
[2025-12-21 06:42:29]   remove_allelic_links: None
[2025-12-21 06:42:29]   phasing_weight: 1.0
[2025-12-21 06:42:29]   gfa_files: None
[2025-12-21 06:42:29]   haphic_bin: /share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic
[2025-12-21 06:42:29]   bwa_bin: bwa
[2025-12-21 06:42:29]   samtools_bin: samtools
[2025-12-21 06:42:29] ğŸš€ å¼€å§‹HapHiCæµç¨‹ | Starting HapHiC pipeline
[2025-12-21 06:42:29] ğŸ” ç³»ç»Ÿé¢„æ£€æŸ¥ | System pre-flight checks
[2025-12-21 06:42:29] ğŸ” éªŒè¯è¾“å…¥æ–‡ä»¶ | Validating input files
[2025-12-21 06:42:30] ğŸ“Š åŸºå› ç»„åºåˆ—æ•°é‡ | Assembly sequence count: 1211
[2025-12-21 06:42:30] ğŸ“Š FASTQæ–‡ä»¶å¤§å° | FASTQ file sizes: R1 60.14 GB, R2 58.01 GB
[2025-12-21 06:42:30] âœ… è¾“å…¥æ–‡ä»¶éªŒè¯é€šè¿‡ | Input files validated
[2025-12-21 06:42:30] ğŸ–¥ï¸ æ£€æŸ¥ç³»ç»Ÿèµ„æº | Checking system resources
[2025-12-21 06:42:30] ğŸ’¾ å¯ç”¨å†…å­˜ | Available memory: 908.0 GB
[2025-12-21 06:42:30] ğŸ’¾ å¯ç”¨ç£ç›˜ç©ºé—´ | Available disk space: 2256396.6 GB
[2025-12-21 06:42:30] ğŸ–¥ï¸ CPUæ ¸å¿ƒæ•° | CPU cores: 88
[2025-12-21 06:42:33] âœ… é¢„æ£€æŸ¥é€šè¿‡ | Pre-flight checks passed
[2025-12-21 06:42:33] ğŸ” æ£€æŸ¥å·²å­˜åœ¨çš„æ¯”å¯¹ç»“æœ | Checking for existing alignment results
[2025-12-21 06:42:33] ğŸ“‚ è¾“å‡ºç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary
[2025-12-21 06:42:33] ğŸ“‚ æ¯”å¯¹ç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/00.mapping
[2025-12-21 06:42:33] ğŸ“„ æ½œåœ¨BAMæ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/00.mapping/HiC.bam
[2025-12-21 06:42:33] ğŸ“„ æ½œåœ¨è¿‡æ»¤BAMæ–‡ä»¶: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/00.mapping/HiC.filtered.bam
[2025-12-21 06:42:33] âœ… æ¯”å¯¹ç›®å½•å­˜åœ¨ | Alignment directory exists
[2025-12-21 06:42:33] ğŸ“‹ æ¯”å¯¹ç›®å½•å†…å®¹: ['assembly.fa.amb', 'assembly.fa.bwt', 'assembly.fa.ann', 'assembly.fa', 'HiC.filtered.bam', 'assembly.fa.pac', 'read1_1.fastq.gz', 'HiC.bam', 'assembly.fa.sa', 'read2_1.fastq.gz']
[2025-12-21 06:42:33] âœ… å‘ç°å·²å­˜åœ¨çš„è¿‡æ»¤BAMæ–‡ä»¶ï¼Œè·³è¿‡BWAæ¯”å¯¹æ­¥éª¤ | Found existing filtered BAM file, skipping BWA alignment: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/00.mapping/HiC.filtered.bam (67,442,747,903 bytes)
[2025-12-21 06:42:33] âœ… ä½¿ç”¨æŒ‰read nameæ’åºçš„è¿‡æ»¤BAMæ–‡ä»¶ä»¥æ»¡è¶³HapHiCè¦æ±‚ | Using read name-sorted filtered BAM file to meet HapHiC requirements
[2025-12-21 06:42:33] ğŸš€ å¼€å§‹HapHiC Pipelineæµç¨‹ | Starting HapHiC Pipeline
[2025-12-21 06:42:33] ğŸ“ è®¾ç½®ç›®å½•ç»“æ„ | Setting up directory structure
[2025-12-21 06:42:33] âœ… ç›®å½•ç»“æ„è®¾ç½®å®Œæˆ | Directory structure setup complete
[2025-12-21 06:42:33] ğŸ” æ£€æŸ¥HapHiC Pipelineå®ŒæˆçŠ¶æ€ | Checking HapHiC Pipeline completion status
[2025-12-21 06:42:33] âœ… Clusteræ­¥éª¤å·²å®Œæˆ | Cluster step completed
[2025-12-21 06:42:33] âœ… Reassignæ­¥éª¤å·²å®Œæˆ | Reassign step completed
[2025-12-21 06:42:33] âœ… Sortæ­¥éª¤å·²å®Œæˆ | Sort step completed
[2025-12-21 06:42:33] âœ… Buildæ­¥éª¤å·²å®Œæˆ | Build step completed
[2025-12-21 06:42:33] âœ… HapHiC Pipelineå·²å®Œæˆï¼Œè·³è¿‡æ‰§è¡Œ | HapHiC Pipeline already completed, skipping execution
[2025-12-21 06:42:33] ğŸ“Š ç”ŸæˆHi-Cæ¥è§¦å›¾å¯è§†åŒ– | Generating Hi-C contact map visualization
[2025-12-21 06:42:33] ğŸ“Š ä½¿ç”¨Raw AGPæ–‡ä»¶ï¼ˆæ ¼å¼æ›´æ ‡å‡†ï¼‰: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/04.build/OV53_1.primary.raw.agp
[2025-12-21 06:42:33] ğŸ“Š AGPæ–‡ä»¶é¢„å¤„ç†å®Œæˆ: å…± 2106 è¡Œï¼Œè·³è¿‡ 0 è¡Œï¼Œè¾“å‡ºåˆ° /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/04.build/OV53_1.primary.raw.processed.agp
[2025-12-21 06:42:33] ğŸš€ ç”Ÿæˆå¯è§†åŒ–
[2025-12-21 06:42:34] âŒ å‘½ä»¤æ‰§è¡Œå¤±è´¥ | Command failed (è¿”å›ç : 1)
[2025-12-21 06:42:34] å‘½ä»¤è¾“å‡º | Command Output:
Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py", line 16, in <module>
    import pysam
ModuleNotFoundError: No module named 'pysam'
Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/haphic", line 117, in <module>
    subprocess.run(commands, check=True)
  File "/share/org/YZWL/yzwl_lixg/miniforge3/lib/python3.12/subprocess.py", line 571, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/share/org/YZWL/yzwl_lixg/miniforge3/envs/haphic/bin/scripts/HapHiC_plot.py', '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/02.assembly/OV53_1/02.fasta/OV53_1.primary.fa', '/share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/04.build/OV53_1.primary.raw.processed.agp', '--bin_size', '500', '--min_len', '1']' returned non-zero exit status 1.
[2025-12-21 06:42:34] âš ï¸ å¯è§†åŒ–ç”Ÿæˆå¤±è´¥ï¼Œä½†ç»§ç»­æ‰§è¡Œå…¶ä»–æ­¥éª¤ | Visualization failed, but continuing with other steps
[2025-12-21 06:42:34] ğŸ¥¤ ç”ŸæˆJuiceboxæ–‡ä»¶ | Generating Juicebox files
[2025-12-21 06:42:34] ğŸ“‚ Juiceboxç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/06.juicebox
[2025-12-21 06:42:34] ğŸ¥¤ ä½¿ç”¨Raw AGPæ–‡ä»¶ï¼ˆæ ¼å¼æ›´æ ‡å‡†ï¼‰: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/primary/04.build/OV53_1.primary.raw.agp
[2025-12-21 06:42:34] ğŸ”§ æ­¥éª¤1: ä½¿ç”¨matlockç”Ÿæˆ.mndæ–‡ä»¶ | Step 1: Generate .mnd file with matlock
[2025-12-21 06:42:34] ğŸš€ ç”Ÿæˆ.mndæ–‡ä»¶
[2025-12-21 06:58:39] âœ… å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully (è€—æ—¶: 965.24ç§’)
[2025-12-21 06:58:39] ğŸ”§ æ­¥éª¤2: æ’åº.mndæ–‡ä»¶ | Step 2: Sorting .mnd file
[2025-12-21 07:18:04] ğŸ”§ æ­¥éª¤3: ç”Ÿæˆ.assemblyæ–‡ä»¶ | Step 3: Generate .assembly file
[2025-12-21 07:18:04] ğŸš€ ç”Ÿæˆassemblyæ–‡ä»¶
[2025-12-21 07:18:04] âœ… å‘½ä»¤æ‰§è¡ŒæˆåŠŸ | Command executed successfully (è€—æ—¶: 0.13ç§’)
[2025-12-21 07:18:04] ğŸ”§ æ­¥éª¤4: ç”Ÿæˆ.hicæ–‡ä»¶ | Step 4: Generate .hic file
[2025-12-21 07:18:04] ğŸš€ ç”Ÿæˆ.hicæ–‡ä»¶
[2025-12-21 07:18:04] âŒ å‘½ä»¤æ‰§è¡Œå¤±è´¥ | Command failed (è¿”å›ç : 1)
[2025-12-21 07:18:04] å‘½ä»¤è¾“å‡º | Command Output:
:) -p flag was triggered. Running with GNU Parallel support parameter set to false.
:( Not sure how to parse your input or input files not found at intended locations. Exiting!

*****************************************************
Visualizing draft genomes in juicebox: 18 July 2016

USAGE: ./run-asm-visualizer.sh [options] <path_to_cprops> <path_to_asm> <path_to_contig_mnd> 

DESCRIPTION:
This is a script to visualize draft assemblies (represented in input by their cprops and asm files) from pairwise contact data represented by Juicer merged_nodups.txt file. The script will produce hic files for viewing in Juicebox as well as scaffold annotation files. Metadata can be attached to the map by passing -i and -g flags with paths to stats and graph files.

ARGUMENTS:
path_to_cprops				Specify cprops file path.
path_to_asm					Specify asm file.
path_to_contig_mnd			Specify path to mnd file describing pairwise Hi-C contacts between assembly contigs.

OPTIONS:
-q mapq						Build map for a specific mapq threshold (default is 1). 
-p true/false				Use GNU Parallel to speed up computation (default is true).
-z zoom						Build map with hardcoded zoom level. By default this is calculated based on the cprops file and applied only to genomes >= 2.1 Gb.

**unprompted**
#-l gap_file				Path to gap bed file - necessary to build contig annotation track.
-m path_to_asm_mnd			Path to mnd already lifted from input to assembly chromosome: used to skip the remapping step.
-n							Skip normalization.
-r							Build for specific resolutions (default is -r 2500000,1000000,500000,250000,100000,50000,25000,10000,5000,1000)
-c							Clean up when done (default: no cleanup.)
-i							Ignore mapq suffix.
-h							Shows this help
*****************************************************
[2025-12-21 07:18:04] âš ï¸ Juiceboxæ–‡ä»¶ç”Ÿæˆå¤±è´¥ï¼Œä½†ç»§ç»­æ‰§è¡Œå…¶ä»–æ­¥éª¤ | Juicebox file generation failed, but continuing with other steps
[2025-12-21 07:18:04] âœ… HapHiC Pipelineå®Œæˆ | HapHiC Pipeline completed in 2130.39ç§’
[2025-12-21 07:18:04] ğŸ”„ æ£€æµ‹åˆ°çº é”™åçš„contigï¼Œéœ€è¦é‡æ–°æ¯”å¯¹Hi-Cæ•°æ® | Detected corrected contigs, need to realign Hi-C data
[2025-12-21 07:18:04] ğŸ“ åˆ›å»ºçº é”™æµç¨‹ç›®å½•: /share/org/YZWL/yzwl_lixg/project/06.longliuxing_BSA/68.ä¸‰ä»£æ•°æ®ç»„è£…å’Œæ³¨é‡Š/28.haphic/07.corrected_contig_haphic
[2025-12-21 07:18:04] ğŸ”— å¼€å§‹é‡æ–°æ¯”å¯¹Hi-Cæ•°æ®åˆ°çº é”™åçš„ç»„è£… | Starting Hi-C realignment to corrected assembly
[2025-12-21 07:18:04] ğŸ”— å¼€å§‹BWAæ¯”å¯¹ | Starting BWA alignment (official method)
[2025-12-21 07:18:04] ğŸ“‚ ä½¿ç”¨çº é”™åé‡æ–°æ¯”å¯¹ç›®å½• | Using corrected realignment directory
[2025-12-21 07:18:04] ğŸ“„ ä½¿ç”¨æä¾›çš„FASTQæ–‡ä»¶å¯¹ | Using provided FASTQ pair: OV53_1-hic_R1.fastq.gz
[2025-12-21 07:18:04] ğŸ“„ æ‰¾åˆ° 1 å¯¹FASTQæ–‡ä»¶ | Found 1 FASTQ pairs
[2025-12-21 07:18:04] ğŸ”— åˆ›å»ºåŸºå› ç»„è½¯é“¾æ¥ | Created assembly symlink: assembly.fa
[2025-12-21 07:18:04] ğŸ”— åˆ›å»ºFASTQè½¯é“¾æ¥ | Created FASTQ symlinks: read1_1.fastq.gz, read2_1.fastq.gz
[2025-12-21 07:18:04] âœ… BWAç´¢å¼•å·²å­˜åœ¨ | BWA index already exists: assembly.fa
[2025-12-21 07:18:04] ğŸ”— æ­¥éª¤1: BWAæ¯”å¯¹ + å»é‡ + åˆæ­¥è¿‡æ»¤ (ä½¿ç”¨ 64 çº¿ç¨‹) | Step 1: BWA alignment + deduplication + initial filtering (using 64 threads)
[2025-12-21 07:18:04] ğŸ“ åˆ›å»ºçº é”™åçš„BAMæ–‡ä»¶ | Creating corrected BAM file
[2025-12-21 07:18:04] ğŸ”„ æ‰§è¡ŒBWAæ¯”å¯¹ç®¡é“ | Executing BWA alignment pipeline
