2026-01-08 18:47:02.102 - INFO - ============================================================
2026-01-08 18:47:02.165 - INFO - Program: VCF SNP/INDEL Filtering
2026-01-08 18:47:02.165 - INFO - Version: 1.0.0
2026-01-08 18:47:02.165 - INFO - ============================================================
2026-01-08 18:47:02.165 - INFO - ============================================================
2026-01-08 18:47:02.165 - INFO - 开始VCF SNP/INDEL过滤流程|Starting VCF SNP/INDEL Filtering Pipeline
2026-01-08 18:47:02.165 - INFO - ============================================================
2026-01-08 18:47:02.165 - INFO - 输入VCF文件|Input VCF file: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/05.所有样品/14.实验室的样品/06.第一次根据枝长筛选的样品/04.第一批369个样品的GWAS/filtered_369samples.vcf.gz
2026-01-08 18:47:02.165 - INFO - 输出目录|Output directory: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/05.所有样品/14.实验室的样品/06.第一次根据枝长筛选的样品/04.第一批369个样品的GWAS
2026-01-08 18:47:02.165 - INFO - 线程数|Threads: 64
2026-01-08 18:47:02.165 - INFO - BCFtools路径|BCFtools path: bcftools
2026-01-08 18:47:02.165 - INFO - ============================================================
2026-01-08 18:47:02.165 - INFO - 检查依赖软件|Checking dependencies
2026-01-08 18:47:02.165 - INFO - 检查依赖软件|Checking dependencies
2026-01-08 18:47:02.179 - INFO - BCFtools可用|BCFtools available
2026-01-08 18:47:02.179 - INFO - ============================================================
2026-01-08 18:47:02.179 - INFO - 步骤1: 分离SNP和INDEL|Step 1: Separating SNPs and INDELs
2026-01-08 18:47:02.179 - INFO - ============================================================
2026-01-08 18:47:02.179 - INFO - 执行步骤|Executing step: 提取SNP变异|Extracting SNP variants
2026-01-08 18:47:02.179 - INFO - 命令|Command: bcftools view --types snps --threads 64 -Oz -o variation.raw.snp.vcf.gz /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/05.所有样品/14.实验室的样品/06.第一次根据枝长筛选的样品/04.第一批369个样品的GWAS/filtered_369samples.vcf.gz
2026-01-08 18:52:22.586 - INFO - 命令执行成功|Command executed successfully: 提取SNP变异|Extracting SNP variants
2026-01-08 18:52:22.586 - INFO - 执行步骤|Executing step: 提取INDEL变异|Extracting INDEL variants
2026-01-08 18:52:22.586 - INFO - 命令|Command: bcftools view --types indels --threads 64 -Oz -o variation.raw.indel.vcf.gz /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/05.所有样品/14.实验室的样品/06.第一次根据枝长筛选的样品/04.第一批369个样品的GWAS/filtered_369samples.vcf.gz
2026-01-08 18:55:10.541 - INFO - 命令执行成功|Command executed successfully: 提取INDEL变异|Extracting INDEL variants
2026-01-08 18:55:10.542 - INFO - 创建VCF索引|Creating VCF index
2026-01-08 18:55:10.542 - INFO - 执行步骤|Executing step: 索引文件|Indexing variation.raw.snp.vcf.gz
2026-01-08 18:55:10.542 - INFO - 命令|Command: bcftools index -f variation.raw.snp.vcf.gz
2026-01-08 18:56:38.946 - INFO - 命令执行成功|Command executed successfully: 索引文件|Indexing variation.raw.snp.vcf.gz
2026-01-08 18:56:38.946 - INFO - 执行步骤|Executing step: 索引文件|Indexing variation.raw.indel.vcf.gz
2026-01-08 18:56:38.946 - INFO - 命令|Command: bcftools index -f variation.raw.indel.vcf.gz
2026-01-08 18:56:39.006 - INFO - 命令执行成功|Command executed successfully: 索引文件|Indexing variation.raw.indel.vcf.gz
2026-01-08 18:56:39.006 - INFO - SNP和INDEL分离完成|SNP and INDEL separation completed
2026-01-08 18:56:39.006 - INFO - ============================================================
2026-01-08 18:56:39.006 - INFO - 步骤2a: 过滤SNP|Step 2a: Filtering SNPs
2026-01-08 18:56:39.006 - INFO - ============================================================
2026-01-08 18:56:39.010 - INFO - SNP过滤条件|SNP filter criteria:
2026-01-08 18:56:39.010 - INFO -    • QUAL >= 30.0
2026-01-08 18:56:39.010 - INFO -    • INFO/DP >= 10
2026-01-08 18:56:39.010 - INFO -    • MQ >= 40.0
2026-01-08 18:56:39.010 - INFO -    • QD >= 2.0
2026-01-08 18:56:39.010 - INFO -    • FS <= 60.0
2026-01-08 18:56:39.010 - INFO -    • SOR <= 3.0
2026-01-08 18:56:39.010 - INFO -    • MQRankSum >= -12.5
2026-01-08 18:56:39.010 - INFO -    • ReadPosRankSum >= -8.0
2026-01-08 18:56:39.010 - INFO -    • MAF >= 0.05
2026-01-08 18:56:39.010 - INFO - 执行步骤|Executing step: 应用SNP过滤|Applying SNP filters
2026-01-08 18:56:39.010 - INFO - 命令|Command: bcftools view -i 'QUAL >= 30.0 && INFO/DP >= 10 && MQ >= 40.0 && QD >= 2.0 && FS <= 60.0 && SOR <= 3.0 && MQRankSum >= -12.5 && ReadPosRankSum >= -8.0 && MAF >= 0.05' --threads 64 -Oz -o variation.filtered.snp.vcf.gz variation.raw.snp.vcf.gz
2026-01-08 19:01:51.652 - INFO - 命令执行成功|Command executed successfully: 应用SNP过滤|Applying SNP filters
2026-01-08 19:01:51.652 - INFO - 执行步骤|Executing step: 索引过滤后的SNP文件|Indexing filtered SNP file
2026-01-08 19:01:51.652 - INFO - 命令|Command: bcftools index -f variation.filtered.snp.vcf.gz
2026-01-08 19:03:17.138 - INFO - 命令执行成功|Command executed successfully: 索引过滤后的SNP文件|Indexing filtered SNP file
2026-01-08 19:03:17.138 - INFO - SNP过滤完成|SNP filtering completed
2026-01-08 19:03:17.138 - INFO - ============================================================
2026-01-08 19:03:17.138 - INFO - 步骤2b: 过滤INDEL|Step 2b: Filtering INDELs
2026-01-08 19:03:17.138 - INFO - ============================================================
2026-01-08 19:03:17.138 - INFO - INDEL过滤条件|INDEL filter criteria:
2026-01-08 19:03:17.138 - INFO -    • QUAL >= 30.0
2026-01-08 19:03:17.138 - INFO -    • INFO/DP >= 10
2026-01-08 19:03:17.138 - INFO -    • MQ >= 40.0
2026-01-08 19:03:17.138 - INFO -    • QD >= 2.0
2026-01-08 19:03:17.138 - INFO -    • FS <= 200.0
2026-01-08 19:03:17.138 - INFO -    • SOR <= 10.0
2026-01-08 19:03:17.138 - INFO -    • ReadPosRankSum >= -20.0
2026-01-08 19:03:17.138 - INFO - 执行步骤|Executing step: 应用INDEL过滤|Applying INDEL filters
2026-01-08 19:03:17.138 - INFO - 命令|Command: bcftools view -i 'QUAL >= 30.0 && INFO/DP >= 10 && MQ >= 40.0 && QD >= 2.0 && FS <= 200.0 && SOR <= 10.0 && ReadPosRankSum >= -20.0' --threads 64 -Oz -o variation.filtered.indel.vcf.gz variation.raw.indel.vcf.gz
2026-01-08 19:03:17.206 - INFO - 命令执行成功|Command executed successfully: 应用INDEL过滤|Applying INDEL filters
2026-01-08 19:03:17.206 - INFO - 执行步骤|Executing step: 索引过滤后的INDEL文件|Indexing filtered INDEL file
2026-01-08 19:03:17.206 - INFO - 命令|Command: bcftools index -f variation.filtered.indel.vcf.gz
2026-01-08 19:03:17.236 - INFO - 命令执行成功|Command executed successfully: 索引过滤后的INDEL文件|Indexing filtered INDEL file
2026-01-08 19:03:17.236 - INFO - INDEL过滤完成|INDEL filtering completed
2026-01-08 19:03:17.236 - INFO - ============================================================
2026-01-08 19:03:17.236 - INFO - 步骤2c: 过滤双等位位点SNP|Step 2c: Filtering biallelic SNPs
2026-01-08 19:03:17.236 - INFO - ============================================================
2026-01-08 19:03:17.236 - INFO - 双等位位点过滤条件|Biallelic filter criteria:
2026-01-08 19:03:17.236 - INFO -    • 双等位位点|Biallelic sites only (max 2 alleles)
2026-01-08 19:03:17.236 - INFO -    • MAF > 0.05
2026-01-08 19:03:17.236 - INFO - 执行步骤|Executing step: 应用双等位位点过滤|Applying biallelic filters
2026-01-08 19:03:17.236 - INFO - 命令|Command: bcftools view -m2 -M2 -v snps -i 'MAF > 0.05' --threads 64 -Oz -o variation.filtered.snp.biallelic.vcf.gz variation.filtered.snp.vcf.gz
2026-01-08 19:08:06.734 - INFO - 命令执行成功|Command executed successfully: 应用双等位位点过滤|Applying biallelic filters
2026-01-08 19:08:06.734 - INFO - 执行步骤|Executing step: 索引双等位位点SNP文件|Indexing biallelic SNP file
2026-01-08 19:08:06.734 - INFO - 命令|Command: bcftools index -f variation.filtered.snp.biallelic.vcf.gz
2026-01-08 19:09:31.076 - INFO - 命令执行成功|Command executed successfully: 索引双等位位点SNP文件|Indexing biallelic SNP file
2026-01-08 19:09:31.077 - INFO - 双等位位点SNP过滤完成|Biallelic SNP filtering completed
2026-01-08 19:09:31.077 - INFO - ============================================================
2026-01-08 19:09:31.077 - INFO - 步骤3: 合并过滤后的变异|Step 3: Merging filtered variants
2026-01-08 19:09:31.077 - INFO - ============================================================
2026-01-08 19:09:31.077 - INFO - 使用双等位位点过滤后的SNP|Using biallelic-filtered SNPs
2026-01-08 19:09:31.077 - INFO - 执行步骤|Executing step: 合并SNP和INDEL|Merging SNPs and INDELs
2026-01-08 19:09:31.077 - INFO - 命令|Command: bcftools concat -a -D --threads 64 -Oz -o variation.filtered.merged.unsorted.vcf.gz variation.filtered.snp.biallelic.vcf.gz variation.filtered.indel.vcf.gz
2026-01-08 19:15:02.144 - INFO - 命令执行成功|Command executed successfully: 合并SNP和INDEL|Merging SNPs and INDELs
2026-01-08 19:15:02.146 - INFO - 执行步骤|Executing step: 按位置排序|Sorting by position
2026-01-08 19:15:02.146 - INFO - 命令|Command: bcftools sort -Oz -o variation.filtered.merged.vcf.gz variation.filtered.merged.unsorted.vcf.gz
2026-01-08 19:36:34.128 - INFO - 命令执行成功|Command executed successfully: 按位置排序|Sorting by position
2026-01-08 19:36:34.128 - INFO - 清理临时文件|Cleaning up temporary file: variation.filtered.merged.unsorted.vcf.gz
2026-01-08 19:36:34.131 - INFO - 临时文件已删除|Temporary file deleted.
2026-01-08 19:36:34.131 - INFO - 执行步骤|Executing step: 索引合并文件|Indexing merged file
2026-01-08 19:36:34.131 - INFO - 命令|Command: bcftools index -f variation.filtered.merged.vcf.gz
2026-01-08 19:37:56.978 - INFO - 命令执行成功|Command executed successfully: 索引合并文件|Indexing merged file
2026-01-08 19:37:56.978 - INFO - 变异合并完成|Variant merging completed
2026-01-08 19:37:56.978 - INFO - ============================================================
2026-01-08 19:37:56.979 - INFO - 步骤4: 生成统计报告|Step 4: Generating statistics report
2026-01-08 19:37:56.979 - INFO - ============================================================
2026-01-08 19:58:47.064 - INFO - ============================================================
2026-01-08 19:58:47.064 - INFO - 过滤统计|Filtering Statistics
2026-01-08 19:58:47.064 - INFO - ============================================================
2026-01-08 19:58:47.064 - INFO - 原始SNP|Raw SNPs: 6,899,902
2026-01-08 19:58:47.064 - INFO - 过滤后SNP|Filtered SNPs: 6,276,717
2026-01-08 19:58:47.064 - INFO - 原始INDEL|Raw INDELs: 0
2026-01-08 19:58:47.064 - INFO - 过滤后INDEL|Filtered INDELs: 0
2026-01-08 19:58:47.064 - INFO - 合并后变异|Merged variants: 6,272,575
2026-01-08 19:58:47.064 - INFO - 双等位位点SNP|Biallelic SNPs: 6,272,575
2026-01-08 19:58:47.064 - INFO - SNP保留率|SNP retention rate: 90.97%
2026-01-08 19:58:47.064 - INFO - 双等位位点保留率|Biallelic retention rate: 99.93%
2026-01-08 19:58:47.064 - INFO - INDEL保留率|INDEL retention rate: 0.00%
2026-01-08 19:58:47.064 - INFO - 统计报告已保存|Statistics report saved: filtering_statistics.txt
2026-01-08 19:58:47.064 - INFO - ============================================================
2026-01-08 19:58:47.064 - INFO - VCF过滤流程成功完成|VCF Filtering Pipeline Completed Successfully!
2026-01-08 19:58:47.064 - INFO - ============================================================
2026-01-08 19:58:47.064 - INFO - 结果保存在|Results saved in: /share/org/YZWL/yzwl_lixg/project/21.野生大豆群体/05.所有样品/14.实验室的样品/06.第一次根据枝长筛选的样品/04.第一批369个样品的GWAS
2026-01-08 19:58:47.064 - INFO - ============================================================

2026-01-08 19:58:47.064 - INFO - ============================================================
2026-01-08 19:58:47.064 - INFO - Pipeline Summary
2026-01-08 19:58:47.064 - INFO - ============================================================
2026-01-08 19:58:47.064 - INFO - Total runtime: 4305.07 seconds
2026-01-08 19:58:47.064 - INFO - Output directory: ./
2026-01-08 19:58:47.064 - INFO - Pipeline completed successfully
