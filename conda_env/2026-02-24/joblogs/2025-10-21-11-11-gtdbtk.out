[2025-10-21 11:11:42] INFO: GTDB-Tk v2.4.1
[2025-10-21 11:11:42] INFO: gtdbtk classify_wf --genome_dir /share/org/YZWL/yzwl_lixg/project/95.gdl_metagenome/04.binning_fine/metawrap_50_10_bins --out_dir /share/org/YZWL/yzwl_lixg/project/95.gdl_metagenome/05.bin_anno --extension fa --cpus 88 --prefix gtdbtk_bins --skip_ani_screen
[2025-10-21 11:11:42] INFO: Using GTDB-Tk reference data version r226: /share/org/YZWL/yzwl_lixg/database/gtdbtk/release226
[2025-10-21 11:11:42] INFO: Identifying markers in 212 genomes with 88 threads.
[2025-10-21 11:11:43] TASK: Running Prodigal V2.6.3 to identify genes.
[2025-10-21 11:11:43] INFO: Completed 212 genomes in 0.18 seconds (1,165.98 genomes/second).
[2025-10-21 11:11:43] WARNING: Prodigal skipped 212 genomes due to pre-existing data, see warnings.log
[2025-10-21 11:11:43] TASK: Identifying TIGRFAM protein families.
[2025-10-21 11:11:43] INFO: Completed 212 genomes in 0.13 seconds (1,611.24 genomes/second).
[2025-10-21 11:11:43] WARNING: TIGRFAM skipped 212 genomes due to pre-existing data, see warnings.log
[2025-10-21 11:11:43] TASK: Identifying Pfam protein families.
[2025-10-21 11:11:43] INFO: Completed 212 genomes in 0.12 seconds (1,729.57 genomes/second).
[2025-10-21 11:11:43] WARNING: Pfam skipped 212 genomes due to pre-existing data, see warnings.log
[2025-10-21 11:11:43] INFO: Annotations done using HMMER 3.4 (Aug 2023).
[2025-10-21 11:11:43] TASK: Summarising identified marker genes.
[2025-10-21 11:11:46] INFO: Completed 212 genomes in 2.82 seconds (75.14 genomes/second).
[2025-10-21 11:11:46] INFO: Done.
[2025-10-21 11:11:46] INFO: Aligning markers in 212 genomes with 88 CPUs.
[2025-10-21 11:11:46] INFO: Processing 208 genomes identified as bacterial.
[2025-10-21 11:11:58] INFO: Read concatenated alignment for 136,646 GTDB genomes.
[2025-10-21 11:11:58] TASK: Generating concatenated alignment for each marker.
[2025-10-21 11:12:08] INFO: Completed 208 genomes in 0.06 seconds (3,460.70 genomes/second).
[2025-10-21 11:12:09] TASK: Aligning 120 identified markers using hmmalign 3.4 (Aug 2023).
[2025-10-21 11:12:24] INFO: Completed 120 markers in 4.76 seconds (25.20 markers/second).
[2025-10-21 11:12:24] TASK: Masking columns of bacterial multiple sequence alignment using canonical mask.
[2025-10-21 11:12:24] ERROR: Uncontrolled exit resulting from an unexpected error.

================================================================================
EXCEPTION: AttributeError
  MESSAGE: 'numpy.ndarray' object has no attribute 'tostring'
________________________________________________________________________________

Traceback (most recent call last):
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/GTDB-Tk_v.2.4.1/lib/python3.13/site-packages/gtdbtk/__main__.py", line 102, in main
    gt_parser.parse_options(args)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/GTDB-Tk_v.2.4.1/lib/python3.13/site-packages/gtdbtk/main.py", line 1176, in parse_options
    all_failed_prodigal = self.align(options)
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/GTDB-Tk_v.2.4.1/lib/python3.13/site-packages/gtdbtk/main.py", line 367, in align
    reports,all_failed_prodigal = markers.align(options.identify_dir,
                                  ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
                  options.skip_gtdb_refs,
                  ^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
                  options.outgroup_taxon if hasattr(options, 'outgroup_taxon') else None,
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                  self.genomes_to_process)
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/GTDB-Tk_v.2.4.1/lib/python3.13/site-packages/gtdbtk/markers.py", line 661, in align
    trimmed_seqs, pruned_seqs = self._apply_mask(gtdb_msa,
                                ~~~~~~~~~~~~~~~~^^^^^^^^^^
                                                user_msa,
                                                ^^^^^^^^^
                                               gtdb_msa_mask,
                                               ^^^^^^^^^^^^^^
                                                min_perc_aa / 100.0)
                                                ^^^^^^^^^^^^^^^^^^^^
  File "/share/org/YZWL/yzwl_lixg/miniforge3/envs/GTDB-Tk_v.2.4.1/lib/python3.13/site-packages/gtdbtk/markers.py", line 366, in _apply_mask
    masked_seq = list_masked_seq.tostring().decode('utf-8')
                 ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'numpy.ndarray' object has no attribute 'tostring'
================================================================================
